have step1 : (∀ a b, f (2 * a) + 2 * f b = f (f (a + b))) → ∀ z, f z = 0 ∨ ∃ c, ∀ z, f z = 2 * z + c := by
    intro h
    have h1 := h 0 0
    have h2 := h 0 (f 0)
    have h3 := h (f 0) 0
    have h4 := h (f 0) (f 0)
    have h5 := h 1 0
    have h6 := h 0 1
    have h7 := h 1 1
    have h8 := h (-1) 1
    have h9 := h 1 (-1)
    have h10 := h (-1) (-1)
    have h11 := h 0 (-1)
    have h12 := h (-1) 0
    have h13 := h 2 0
    have h14 := h 0 2
    have h15 := h 2 1
    have h16 := h 1 (-2)
    have h17 := h (-2) 1
    have h18 := h 2 (-1)
    have h19 := h (-1) 2
    have h20 := h 3 0
    have h21 := h 0 3
    have h22 := h 3 1
    have h23 := h 1 3
    have h24 := h (-1) 3
    have h25 := h 3 (-1)
    have h26 := h (-1) (-3)
    have h27 := h (-3) (-1)
    have h28 := h (-2) 0
    have h29 := h 0 (-2)
    have h30 := h (-2) 2
    have h31 := h 2 (-2)
    have h32 := h (-2) (-2)
    norm_num at *
    have h33 : ∀ z, f z = 0 ∨ ∃ c, ∀ z, f z = 2 * z + c := by
      intro z
      by_cases h34 : f z = 0
      · exact Or.inl h34
      · right
        use (f z - 2 * z)
        intro z'
        have h35 := h z' z'
        have h36 := h z' 0
        have h37 := h 0 z'
        have h38 := h z' (-z')
        have h39 := h (-z') z'
        have h40 := h 0 0
        have h41 := h 1 2
        have h42 := h 2 1
        have h43 := h 1 (-1)
        have h44 := h (-1) 1
        have h45 := h 2 (-1)
        have h46 := h (-1) 2
        have h47 := h 3 2
        have h48 := h 2 3
        have h49 := h 3 (-2)
        have h50 := h (-2) 3
        have h51 := h (-1) (-2)
        have h52 := h (-2) (-1)
        ring_nf at *
        omega
    exact h33
  
  have step2 : (∀ z, f z = 0 ∨ ∃ c, ∀ z, f z = 2 * z + c) → (∀ a b, f (2 * a) + 2 * f b = f (f (a + b))) := by
    intro h
    intro a b
    have h1 := h
    have h2 := h
    cases' h1 (a + b) with h3 h3 <;> cases' h2 a with h4 h4 <;> cases' h2 b with h5 h5 <;>
    cases' h2 (2 * a) with h6 h6 <;> cases' h2 (2 * b) with h7 h7 <;>
    simp_all [mul_add, mul_comm, mul_left_comm, mul_assoc]