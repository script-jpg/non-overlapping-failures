have h₃ : 0 < m := by linarith
  have h₄ : 0 < n := by linarith
  have h₅ : m * n = 8 * 112 := by
    have h₅ : m * n = (Nat.gcd m n) * (Nat.lcm m n) := by
      simp [Nat.gcd_mul_lcm]
    rw [h₁, h₂] at h₅
    exact h₅
  have h₆ : m + n ≥ 72 := by
    contrapose! h₅
    have h₇ : m ≤ 71 := by linarith
    have h₈ : n ≤ 71 := by linarith
    interval_cases m <;> interval_cases n <;> norm_num [Nat.gcd_eq_right, Nat.lcm, Nat.mul_div_cancel_left] at h₁ h₂ ⊢ <;> omega
  linarith


theorem mathd_numbertheory_711_possible_values :
    {m | 0 < m ∧ ∃ n : ℕ, 0 < n ∧ Nat.gcd m n = 8 ∧ Nat.lcm m n = 112} = {16, 24, 56, 112} := by
  ext m
  simp only [Set.mem_setOf_eq, Set.mem_insert_iff, Set.mem_singleton_iff]
  constructor
  · intro h
    have h₁ := h.2
    have h₂ := h.1
    rcases h₁ with ⟨n, hn, hgcd, hlcm⟩
    have h₃ : m ∣ 112 := by
      have : m ∣ Nat.lcm m n := by exact Nat.dvd_lcm_left m n
      simp_all
    have h₄ : n ∣ 112 := by
      have : n ∣ Nat.lcm m n := by exact Nat.dvd_lcm_right m n
      simp_all
    have h₅ : m ≤ 112 := Nat.le_of_dvd (by norm_num) h₃
    have h₆ : n ≤ 112 := Nat.le_of_dvd (by norm_num) h₄
    interval_cases m <;> norm_num [Nat.gcd_eq_right, Nat.lcm, Nat.mul_div_cancel_left] at hgcd hlcm <;>
      (try omega) <;> (try {
        have : n = 16 := by omega
        simp_all
        <;> omega
      }) <;> (try {
        have : n = 24 := by omega
        simp_all
        <;> omega
      }) <;> (try {
        have : n = 56 := by omega
        simp_all
        <;> omega
      }) <;> (try {
        have : n = 112 := by omega
        simp_all
        <;> omega
      })
  · intro h
    rcases h with (rfl | rfl | rfl | rfl) <;>
      (try decide) <;>
      (try {
        use 16
        constructor
        <;> norm_num
        <;> decide
      }) <;>
      (try {
        use 24
        constructor
        <;> norm_num
        <;> decide
      }) <;>
      (try {
        use 56
        constructor
        <;> norm_num
        <;> decide
      }) <;>
      (try {
        use 112
        constructor
        <;> norm_num
        <;> decide
      })

theorem mathd_numbertheory_711_solution :
    {m | 0 < m ∧ ∃ n : ℕ, 0 < n ∧ Nat.gcd m n = 8 ∧ Nat.lcm m n = 112} = {16, 24, 56, 112} := by
  ext m
  simp only [Set.mem_set