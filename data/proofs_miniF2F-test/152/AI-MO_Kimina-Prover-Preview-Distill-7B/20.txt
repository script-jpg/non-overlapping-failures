-- -- The greatest common divisor of positive integers $m$ and $n$ is 8.
  -- -- The least common multiple of $m$ and $n$ is 112. What is the least possible value of $m+n$? Show that it is 72.

  have h₃ : 112 = 8 * 14 := by norm_num

  have dvd_m : 8 ∣ m := by exact Nat.gcd_dvd_left m n
  have dvd_n : 8 ∣ n := by exact Nat.gcd_dvd_right m n

  have h₄ : 112 = m.lcm n := by rw [← h₂, h₃]
  have mne : m ≠ n := by
    by_contra contra
    rw [contra] at h₄
    rw [Nat.lcm_self] at h₄
    omega

  -- m and n are not equal.

  rcases m with ⟨m', hm'⟩
  rcases n with ⟨n', hn'⟩

  have hgcd : 8 = m'.gcd n' := by
    rw [hm', hn'] at h₁
    exact h₁

  have hlcm : 14 = m'.lcm n' := by
    rw [hm', hn'] at h₄
    omega

  have abseq : m'.lcm n' = m'.gcd n'.lcm n'.lcm m' := by exact Nat.gcd_lcm_mul m' n'
  rw [hgcd] at abseq
  rw [hlcm] at abseq
  norm_num at abseq

  -- The least possible value of m+n is 72.

  have abseqz := abseq
  rw [hm', hn'] at abseqz
  conv at abseqz =>
    left
    rw [← Nat.mul_left_inj (by norm_num)]

  rw [← abseqz] at h₄
  have h₅ : 8 * 14 = 8 * 14 := by rfl
  rw [h₄] at h₅
  simp only [Nat.reduceMul] at h₅

  -- The least possible value of m+n is 72.

  have abseqz := abseq
  rw [hm', hn'] at abseqz
  conv at abseqz =>
    right
    rw [← Nat.mul_right_inj (by norm_num)]

  rw [← abseqz]

  -- To check that 72 is the least possible value of m+n, we need to show that
  -- m = 8 * x and n = 8 * y, where x * y = 14 and x + y = 9.
  -- The last condition comes from the fact that 14 = m'.lcm n' and 9 = m'+ n'.

  have h₆ : m'.lcm n' = 14 := by omega

  have h₇ : m'.gcd n' = 1 := by omega

  have h₈ : Nat.Coprime m' n' := by exact Nat.coprime_iff_gcd_eq_one.mpr h₇

  -- m' and n' are coprime.

  have h₉ : ∃ x y, m' = x * 8 ∧ n' = y * 8 ∧ x * y = 14 ∧ x + y = 9 := by
    -- The least possible value of m+n is 72.

    have h₆ : m'.lcm n' = 14 := by omega

    have h₇ : m'.gcd n' = 1 := by omega

    have h₈ : Nat.Coprime m' n' := by exact Nat.coprime_iff_gcd_eq_one.mpr h₇

    have h₉ : ∃ x y, m' = x * 8 ∧ n' = y * 8 ∧ x * y = 14 ∧ x + y = 9 := by
      -- The least possible value of m+n is 72.

      use 7, 2
      constructor
      · omega
      constructor
      · omega
      constructor
      · omega
      omega
    exact h₉
  rcases h₉ with ⟨x, y, hm'', hn'', hxy, hxy'⟩

  -- The least possible value of m+n is 72.

  rw [hm''] at h₈
  rw [hn''] at h₈
  have hgcd : 1 = Nat.gcd x y := by
    rw [hm'', hn''] at h₇
    exact h₇

  have hxy'' : x * y = 14 := by omega

  have hxy''' : x + y = 9 := by omega

  have xgt : 0 < x := by
    by_contra hx
    rw [not_lt] at hx
    have hy : 0 = y := by omega
    omega

  have ygt : 0 < y := by
    by_contra hy
    rw [not_lt] at hy
    have hx : 0 = x := by omega
    omega

  -- The least possible value of m+n is 72.

  have Nat_x_ge_1 : 1 ≤ x := by exact Nat.one_le_iff_ne_zero.mpr xgt
  have Nat_y_ge_1 : 1 ≤ y := by exact Nat.one_le_iff_ne_zero.mpr ygt

  have xle : x ≤ 7 := by
    by_contra hx
    rw [not_le] at hx
    have hxy'''' : 8 * 2 < x * y := by omega
    omega

  have yle : y ≤ 7 := by
    by_contra hy
    rw [not_le] at hy
    have hxy'''' : 8 * 2 < x * y := by omega
    omega

  have hx : 0 < x := by
    by_contra hx
    rw [not_lt] at hx
    have hy : 0 = y := by omega
    omega

  have hy : 0 < y := by
    by_contra hy
    rw [not_lt] at hy
    have hx : 0 = x := by omega
    omega

  -- The least possible value of m+n is 72.

  have Nat_x_ge_1 : 1 ≤ x := by exact Nat.one_le_iff_ne_zero.mpr hx
  have Nat_y_ge_1 : 1 ≤ y := by exact Nat.one_le_iff_ne_zero.mpr hy

  have xle : x ≤ 7 := by
    by_contra hx
    rw [not_le] at hx
    have hxy'''' : 8 * 2 < x * y := by omega
    omega

  have yle : y ≤ 7 := by
    by_contra hy
    rw [not_le] at hy
    have hxy'''' : 8 * 2 < x * y := by omega
    omega

  have Nat_x_ge_3 : 3 ≤ x := by
    by_contra hx
    rw [not_le] at hx
    have hxy'''' : x * y < 4 * 6 := by omega
    omega

  have Nat_y_ge_3 : 3 ≤ y := by
    by_contra hy
    rw [not_le] at hy
    have hxy'''' : x * y < 6 * 4 := by omega
    omega

  -- The least possible value of m+n is 72.

  have xin : x ∈ ({3, 4, 6, 7} : Finset ℕ) := by
    simp
    exact ⟨⟨h₈, Nat.mul_le_mul_left ygt⟩, Nat.le_of_lt_succ xle, Nat.mul_le_mul_right ygt⟩

  have yin : y ∈ ({3, 4, 6, 7} : Finset ℕ) := by
    simp
    exact ⟨⟨h₈, Nat.mul_le_mul_left xgt⟩, Nat.le_of_lt_succ yle, Nat.mul_le_mul_right xgt⟩

  have xval : x = 3 ∨ x = 4 ∨ x = 6 ∨ x = 7 := by exact Finset.mem_insert' xin

  have yval : y = 3 ∨ y = 4 ∨ y = 6 ∨ y = 7 := by exact Finset.mem_insert' yin

  rcases xval with xeq | xeq | xeq | xeq
  · -- x = 3

    have yeq : y = 4 := by omega
    rw [xeq, yeq]

  · -- x = 4

    have yeq : y = 3 := by omega
    rw [xeq, yeq]

  · -- x = 6

    have yeq : y = 2 := by omega
    exfalso
    rw [xeq, yeq] at hxy''
    omega

  · -- x = 7

    have yeq : y = 2 := by omega
    exfalso
    rw [xeq, yeq] at hxy''
    omega

  -- The least possible value of m+n is 72.

  have yin : y ∈ ({3, 4, 6, 7} : Finset ℕ) := by
    simp
    exact ⟨⟨h₈, Nat.mul_le_mul_left xgt⟩, Nat.le_of_lt_succ yle, Nat.mul_le_mul_right xgt⟩

  have yval : y = 3 ∨ y = 4 ∨ y = 6 ∨ y = 7 := by exact Finset.mem_insert' yin

  rcases yval with yeq | yeq | yeq | yeq
  · -- y = 3

    have xeq : x = 4 := by omega
    rw [xeq, yeq]

  · -- y = 4

    have xeq : x = 3 := by omega
    rw [xeq, yeq]

  · -- y = 6

    have xeq : x = 2 := by omega
    exfalso
    rw [xeq, yeq] at hxy'''
    omega

  · -- y = 7

    have xeq : x = 2 := by omega
    exfalso
    rw [xeq, yeq] at hxy'''
    omega

  -- The least possible value of m+n is 72.

  have xin : x ∈ ({3, 4, 6, 7} : Finset ℕ) := by
    simp
    exact ⟨⟨h₈, Nat.mul_le_mul_left ygt⟩, Nat.le_of_lt_succ xle, Nat.mul_le_mul_right ygt⟩

  have xval : x = 3 ∨ x = 4 ∨ x = 6 ∨ x = 7 := by exact Finset.mem_insert' xin

  rcases xval with xeq | xeq | xeq | xeq
  · -- x = 3

    have yeq : y = 14 := by omega
    rw [xeq, yeq]

  · -- x = 4

    have yeq : y = 14 := by omega
    rw [xeq, yeq]

  · -- x = 6

    have yeq : y = 14 := by omega
    rw [xeq, yeq]

  · -- x = 7

    have yeq : y = 14 := by omega
    rw [xeq, yeq]
```