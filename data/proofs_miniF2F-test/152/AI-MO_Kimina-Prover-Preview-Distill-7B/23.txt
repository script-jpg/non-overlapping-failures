-- The greatest common divisor of $m$ and $n$ is 8.
  have h₃ : m.gcd n = 8 := by decide

  -- The least common multiple of $m$ and $n$ is 112.
  have h₄ : m.lcm n = 112 := by decide

  -- $m \leq 112$ and $n \leq 112$.
  have hm : m ≤ 112 := by calc
    _ = m.lcm n := by rw [h₄]
    _ ≤ _ := by apply Nat.le_lcm; linarith
  have hn : n ≤ 112 := by calc
    _ = m.lcm n := by rw [h₄]
    _ ≤ _ := by apply Nat.le_lcm; linarith

  -- $m \cdot n = 8 \cdot 112$.
  have h₅ : m * n = 8 * 112 := by
    rw [←h₃, ←h₄, Nat.gcd_mul_lcm]

  have hp₁ : 16 ≤ m := by
    by_contra!; interval_cases m <;> revert h₅ <;> decide
  have hp₂ : 16 ≤ n := by
    by_contra!; interval_cases n <;> revert h₅ <;> decide

  -- We argue by cases based on the possible values of $m$ and $n$.
  by_cases  cm : m ≤ 112
  · by_cases  m_eq : m = 16
    · -- If $m = 16$, then $n = 56$ and $m + n = 72$.
      have : n = 56 := by
        rw [m_eq] at h₅
        linarith
      linarith
    · by_cases   : m = 24
      · -- If $m = 24$, then $n = 42$ and $m + n = 66$.
        have : n = 42 := by
          rw [m_eq] at h₅
          linarith
        linarith
      · by_cases   : m = 32
        · -- If $m = 32$, then $n = 28$ and $m + n = 60$.
          have : n = 28 := by
            rw [m_eq] at h₅
            linarith
          linarith
        · by_cases   : m = 56
          · -- If $m = 56$, then $n = 24$ and $m + n = 80$.
            have : n = 24 := by
              rw [m_eq] at h₅
              linarith
            linarith
          · by_cases   : m = 64
            · -- If $m = 64$, then $n = 14$ and $m + n = 78$.
              have : n = 14 := by
                rw [m_eq] at h₅
                linarith
              linarith
            · by_cases   : m = 80
              · -- If $m = 80$, then $n = 112$ and $m + n = 192$.
                have : n = 112 := by
                  rw [m_eq] at h₅
                  linarith
                linarith
              · by_cases   : m = 112
                · -- If $m = 112$, then $n = 8$ and $m + n = 120$.
                  have : n = 8 := by
                    rw [m_eq] at h₅
                    linarith
                  linarith
                · linarith
              · linarith
            · linarith
          · linarith
        · linarith
      · linarith
    · by_cases   : m = 160
      · -- If $m = 160$, then $n = 7$ and $m + n = 167$.
        have : n = 7 := by
          rw [m_eq] at h₅
          linarith
        linarith
      · linarith
    · linarith
  · linarith

```