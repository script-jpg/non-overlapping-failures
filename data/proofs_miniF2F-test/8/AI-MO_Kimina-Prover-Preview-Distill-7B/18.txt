-- The four-digit number $374n$ is divisible by 18. Find the units digit $n$. Show that it is 4.

  -- We prove that the four-digit number $374n$ is divisible by 18 if and only if $n=4$.

  -- We have a four-digit number $374n$, which means $3740 + n$.

  -- Change $3740 + n$ to $374 * 10 + n$ to make it easier to work with.

  have : 3740 + n = 374 * 10 + n := by omega

  rw [this] at h₁

  change 18 ∣ 374 * 10 + n at h₁

  -- We want to show that $18 \mid 3740 + n$ if and only if $n = 4$.

  -- We need to show that $n = 4$ is the only solution to $18 \mid 3740 + n$ where $0 \leq n \leq 9$.

  have : 374 * 10 + n = 374 * 10 + n := rfl

  rw [this]

  clear this

  -- Now we need to figure out which value of $n$ will make $3740 + n$ divisible by $18$.

  -- We know that $3740 + n \equiv 0 \pmod{18}$, so $3740 \equiv -n \pmod{18}$.

  -- Let's find the residue of $3740$ when divided by $18$.

  have : 3740 % 18 = 2 := by norm_num

  -- Now we find the residue of $3740 + n$ when divided by $18$.

  have : (3740 + n) % 18 = 0 := by omega

  -- We can rewrite the congruence as $2 + n \equiv 0 \pmod{18}$, and thus $n \equiv -2 \pmod{18}$.

  have : (3740 + n) % 18 = (3740 % 18 + n % 18) % 18 := Nat.add_mod 3740 n 18

  have : (3740 % 18 + n % 18) % 18 = 0 := by rw [←this, this]

  have : (2 + n % 18) % 18 = 0 := by rw [←this]; omega

  -- The solutions to this are $n \equiv 16 \pmod{18}$, $n \equiv 2 \pmod{18}$, and $n \equiv 20 \pmod{18}$.

  -- However, since $0 \leq n \leq 9$, the only possible value for $n$ is $2$.

  have : n % 18 = 16 ∨ n % 18 = 2 ∨ n % 18 = 20 := by omega

  have : n % 18 = 2 := by omega

  -- The only possible value for $n$ is $2$.

  omega
```