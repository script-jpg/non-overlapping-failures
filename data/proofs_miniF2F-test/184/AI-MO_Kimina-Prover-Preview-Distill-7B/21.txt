have h₁ : 2 ^ (n + 3) = 8 * 2 ^ n := by
    ring

  have h₂ : 2 ^ (n + 2) = 4 * 2 ^ n := by
    ring

  rw [h₁]

  have h₃ : 3 ^ 2 ^ n - 1 = (3 ^ 2 ^ n - 1) % (8 * 2 ^ n) + 8 * (3 ^ 2 ^ n - 1) / (8 * 2 ^ n) := by
    omega

  rw [h₃]

  have h₄ : 8 * ((3 : ℕ) ^ 2 ^ n - 1) / (8 * 2 ^ n) = 4 * (3 ^ 2 ^ n - 1) / 2 ^ n := by
    field_simp
    ring

  rw [h₄]

  have h₅ : 4 * (3 ^ 2 ^ n - 1) / 2 ^ n = 4 * ((3 : ℕ) ^ 2 ^ n - 1) % 2 ^ n := by
    refine Nat.div_eq_of_eq_mul_right?_?_
    · omega
    · apply Nat.gcd_mul_right_dvd
      · apply Nat.gcd_dvd_right
      · apply Nat.gcd_dvd_left
  rw [h₅]

  have h₆ : 2 ^ n ∣ 3 ^ 2 ^ n - 1 := by
    refine Nat.pow_dvd_pow_self?_
    exact not_eq_zero_of_lt h₀

  rw [Nat.mod_add_div (3 ^ 2 ^ n - 1) (2 ^ n)]

  have h₇ : (3 : ℕ) ^ 2 ^ n - 1 = 2 ^ n * ((3 : ℕ) ^ 2 ^ n - 1) / 2 ^ n := by
    field_simp

  rw [h₇]

  have h₈ : ((3 : ℕ) ^ 2 ^ n - 1) % 2 ^ n = 2 ^ n - 1 := by
    refine Nat.mod_eq_of_modEq?_
    rw [Nat.modEq_nsmul_left_iff_dvd]
    rw [Nat.sub_dvd_pow_self_iff]
    · exact not_eq_zero_of_lt h₀
    · exact h₆
    · exact pow_le_pow_right₀ (by omega) h₀
  rw [h₈]

  have h₉ : 2 ^ n * (2 ^ n - 1) + 8 * 2 ^ n = 2 ^ (n + 2) + 2 ^ (n + 3) := by
    ring

  rw [h₉]

  have h₁₀ : 2 ^ (n + 2) ≤ 2 ^ (n + 3) := by
    exact Nat.pow_le_pow_right₀ (by omega) h₀

  have h₁₁ : 2 ^ (n + 2) + 2 ^ (n + 3) = 2 ^ (n + 2) + 2 ^ (n + 2) := by
    rw [add_tsub_cancel_right h₁₀]

  rw [h₁₁]
  simp
```