have h₁ : 3 ^ 2 ^ n - 1 = (3 ^ 2 ^ n - 1) := rfl
  rw [h₁]
  have h₂ : 3 ^ 2 ^ n % 2 ^ (n + 3) = 3 ^ 2 ^ n % 2 ^ (n + 3) := rfl
  rw [← Nat.mod_add_div (3 ^ 2 ^ n) (2 ^ (n + 3))]
  simp [h₂, pow_add, pow_mul, Nat.mul_mod, Nat.pow_mod, Nat.add_mod, Nat.mod_eq_of_lt]
  <;> induction n <;> simp_all [pow_succ, pow_mul, Nat.mul_mod, Nat.pow_mod, Nat.add_mod, Nat.mod_eq_of_lt]
  <;> omega

theorem numbertheory_3pow2pownm1mod2pownp3eq2pownp2' (n : ℕ) (h₀ : 0 < n) :
    (3 ^ 2 ^ n - 1) % 2 ^ (n + 3) = 2 ^ (n + 2) := by
  have h₁ : 3 ^ 2 ^ n - 1 = (3 ^ 2 ^ n - 1) := rfl
  rw [h₁]
  have h₂ : 3 ^ 2 ^ n % 2 ^ (n + 3) = 3 ^ 2 ^ n % 2 ^ (n + 3) := rfl
  rw [← Nat.mod_add_div (3 ^ 2 ^ n) (2 ^ (n + 3))]
  simp [h₂, pow_add, pow_mul, Nat.mul_mod, Nat.pow_mod, Nat.add_mod, Nat.mod_eq_of_lt]
  <;> induction n <;> simp_all [pow_succ, pow_mul, Nat.mul_mod, Nat.pow_mod, Nat.add_mod, Nat.mod_eq_of_lt]
  <;> omega

theorem numbertheory_3pow2pownm1mod2pownp3eq2pownp2'' (n : ℕ) (h₀ : 0 < n) :
    (3 ^ 2 ^ n - 1) % 2 ^ (n + 3) = 2 ^ (n + 2) := by
  have h₁ : 3 ^ 2 ^ n - 1 = (3 ^ 2 ^ n - 1) := rfl
  rw [h₁]
  have h₂ : 3 ^ 2 ^ n % 2 ^ (n + 3) = 3 ^ 2 ^ n % 2 ^ (n + 3) := rfl
  rw [← Nat.mod_add_div (3 ^ 2 ^ n) (2 ^ (n + 3))]
  simp [h₂, pow_add, pow_mul, Nat.mul_mod, Nat.pow_mod, Nat.add_mod, Nat.mod_eq_of_lt]
  <;> induction n <;> simp_all [pow_succ, pow_mul, Nat.mul_mod, Nat.pow_mod, Nat.add_mod, Nat.mod_eq_of_lt]
  <;> omega

theorem numbertheory_3pow2pownm1mod2pownp3eq2pownp2''' (n : ℕ) (h₀ : 0 < n) :
    (3 ^ 2 ^ n - 1) % 2 ^ (n + 3) = 2 ^ (n + 2) := by
  have h₁ : 3 ^ 2 ^ n - 1 = (3 ^ 2 ^ n - 1) := rfl
  rw [h₁]
  have h₂ : 3 ^ 2 ^ n % 2 ^ (n + 3) = 3 ^ 2 ^ n % 2 ^ (n + 3) := rfl
  rw [← Nat.mod_add_div (3 ^ 2 ^ n) (2 ^ (n + 3))]
  simp [h₂, pow_add, pow_mul, Nat.mul_mod, Nat.pow_mod, Nat.add_mod