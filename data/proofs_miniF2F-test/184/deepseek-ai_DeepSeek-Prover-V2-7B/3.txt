have h₁ : 3 ^ 2 ^ n % 2 ^ (n + 3) = 3 ^ 2 ^ n % 2 ^ (n + 3) := rfl
  have h₂ : (3 ^ 2 ^ n - 1) % 2 ^ (n + 3) = 2 ^ (n + 2) := by
    have h₃ : 3 ^ 2 ^ n % 2 ^ (n + 3) = 3 ^ 2 ^ n % 2 ^ (n + 3) := rfl
    have h₄ : 2 ^ (n + 3) > 0 := by positivity
    have h₅ : 3 ^ 2 ^ n % 2 ^ (n + 3) = 1 + 2 ^ (n + 2) := by
      have h₆ : 3 ^ 2 ^ n = 3 ^ 2 ^ n := rfl
      rw [h₆]
      have h₇ : 3 ^ 2 ^ n % 2 ^ (n + 3) = 1 + 2 ^ (n + 2) := by
        -- Use the fact that 3 and 2^(n+3) are coprime to simplify the modulus operation
        have h₈ : Nat.Coprime 3 (2 ^ (n + 3)) := by
          rw [Nat.coprime_comm]
          apply Nat.Coprime.pow_left
          norm_num
        -- Use the fact that 3 and 2^(n+3) are coprime to simplify the modulus operation
        rw [← Nat.mod_add_div (3 ^ 2 ^ n) (2 ^ (n + 3))]
        simp [h₈, pow_add, pow_mul, Nat.mul_mod, Nat.pow_mod, Nat.add_mod]
        <;> induction n <;> simp_all [pow_succ, pow_mul, Nat.mul_mod, Nat.pow_mod, Nat.add_mod]
        <;> omega
      exact h₇
    omega
  exact h₂
```