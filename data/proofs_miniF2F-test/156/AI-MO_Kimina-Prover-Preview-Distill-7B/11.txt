/- In the year $2001$, the United States will host the [[International Mathematical Olympiad]].  Let $I,M,$ and $O$ be distinct [[positive integer]]s such that the product $I \cdot M \cdot O = 2001 $.  What is the largest possible value of the sum $I + M + O$?

$\textbf{(A)}\ 23 \qquad \textbf{(B)}\ 55 \qquad \textbf{(C)}\ 99 \qquad \textbf{(D)}\ 111 \qquad \textbf{(E)}\ 671$ Show that it is \text{(E)}. -/
  /- Factorize 2001 first. -/
  have hFactor : 2001 = 3 * 23 * 29 := by norm_num
  rw [hFactor] at h₁

  /- If $i$, $m$ and $o$ are all greater than 1, then WLOG - we can set $i$ to be the minimum of the three and consider the three cases $i=3$, $i=23$ and $i=29$. -/
  have h₂ : i ≤ 2001 := by nlinarith
  have h₃ : m ≤ 2001 := by nlinarith
  have h₄ : o ≤ 2001 := by nlinarith
  by_cases h₅ : i = 1
  · rw [h₅] at h₁
    have h₆ : m = 1 := by nlinarith
    have h₇ : o = 2001 := by nlinarith
    have h₈ : m = i := by rw [h₆, h₅]
    have h₉ : i + m + o ≤ 671 := by nlinarith
    exact h₉
  by_cases h₆ : i = 3
  · have h₇ : m * o = 667 := by nlinarith
    by_cases h₈ : m = 1
    · have h₉ : o = 667 := by nlinarith
      have h₁₀ : o = i := by rw [h₉, h₆]
      have h₁₁ : i + m + o ≤ 671 := by nlinarith
      exact h₁₁
    by_cases h₉ : m = 23
    · have h₁₀ : o = 29 := by nlinarith
      have h₁₁ : i + m + o ≤ 671 := by nlinarith
      exact h₁₁
    have h₁₂ : m ≤ 667 := by nlinarith
    have h₁₃ : o ≤ 667 := by nlinarith
    have h₁₄ : m + o ≤ 667 + 667 := by nlinarith
    have h₁₅ : i + m + o ≤ 3 + 667 + 667 := by nlinarith
    linarith
  by_cases h₇ : i = 23
  · have h₈ : m * o = 87 := by nlinarith
    by_cases h₉ : m = 1
    · have h₁₀ : o = 87 := by nlinarith
      have h₁₁ : o = i := by rw [h₁₀, h₇]
      have h₁₂ : i + m + o ≤ 671 := by nlinarith
      exact h₁₂
    by_cases h₁₀ : m = 3
    · have h₁₁ : o = 29 := by nlinarith
      have h₁₂ : i + m + o ≤ 671 := by nlinarith
      exact h₁₂
    have h₁₃ : m ≤ 87 := by nlinarith
    have h₁₄ : o ≤ 87 := by nlinarith
    have h₁₅ : m + o ≤ 87 + 87 := by nlinarith
    have h₁₆ : i + m + o ≤ 23 + 87 + 87 := by nlinarith
    linarith
  by_cases h₈ : i = 29
  · have h₉ : m * o = 69 := by nlinarith
    by_cases h₁₀ : m = 1
    · have h₁₁ : o = 69 := by nlinarith
      have h₁₂ : o = i := by rw [h₁₁, h₈]
      have h₁₃ : i + m + o ≤ 671 := by nlinarith
      exact h₁₃
    by_cases h₁₁ : m = 3
    · have h₁₂ : o = 23 := by nlinarith
      have h₁₃ : i + m + o ≤ 671 := by nlinarith
      exact h₁₃
    have h₁₄ : m ≤ 69 := by nlinarith
    have h₁₅ : o ≤ 69 := by nlinarith
    have h₁₆ : m + o ≤ 69 + 69 := by nlinarith
    have h₁₇ : i + m + o ≤ 29 + 69 + 69 := by nlinarith
    linarith
  have h₉ : i ≥ 3 := by nlinarith
  have h₁₀ : m ≥ 3 := by
    by_contra!
    have h₁₁ : m * o ≤ 1 * o := by nlinarith
    have h₁₂ : i * m * o ≤ i * 1 * o := by nlinarith
    have h₁₃ : 2001 ≤ i * o := by nlinarith
    have h₁₄ : i * o < 2001 := by nlinarith
    linarith
  have h₁₁ : o ≥ 3 := by
    by_contra!
    have h₁₂ : m * o ≤ m * 1 := by nlinarith
    have h₁₃ : i * m * o ≤ i * m * 1 := by nlinarith
    have h₁₄ : 2001 ≤ i * m := by nlinarith
    have h₁₅ : i * m < 2001 := by nlinarith
    linarith
  have h₁₂ : m + o ≤ 667 + 667 := by nlinarith
  have h₁₃ : i + m + o ≤ 3 + 667 + 667 := by nlinarith
  linarith

```