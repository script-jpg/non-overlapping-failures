-- a has a factor of 3
  have h₃ : 3 ∣ a := by
    rw [Nat.gcd_dvd_right]
    rw [h₃]
    norm_num
  -- b has a factor of 3
  have h₄ : 3 ∣ b := by
    rw [Nat.gcd_dvd_left]
    rw [h₃]
    norm_num
  -- a has a factor of 2
  have h₅ : 2 ∣ a := by
    rw [Nat.gcd_dvd_right]
    rw [h₃]
    norm_num
  -- b has a factor of 2
  have h₆ : 2 ∣ b := by
    rw [Nat.gcd_dvd_left]
    rw [h₃]
    norm_num

  -- the factor 2x3x3=18 of 6 is important.
  have h₇ : 18 ∣ a.gcd b := by
    rw [h₃]
    norm_num

  rw [Nat.dvd_gcd_iff] at h₇
  obtain ⟨u,hu⟩ := h₇

  -- if a has a factor of 9 or b has a factor of 9, then 18 has a factor of 9, which is a contradiction.
  have h₈ : ¬(9 ∣ a ∨ 9 ∣ b) := by
    contrapose! h₇
    have : 27 ∣ a.gcd b := by
      have : 9 ∣ a.gcd b := by
        exact h₇
        norm_num
      rw [Nat.dvd_gcd_iff] at this
      obtain ⟨w, hw⟩ := this
      use 3*w
      rw [hw]
      ring
    rw [Nat.dvd_gcd_iff] at this
    have this' : 27 ∣ a ∧ 27 ∣ b := by
      constructor
      assumption
      apply this
    have this' : 27 ∣ a.gcd b := by
      rw [Nat.dvd_gcd_iff]
      constructor
      assumption
      assumption
    have this' : 27 ∣ 6 := by
      rw [h₃] at this'
      exact this'
    omega

  -- 2 * 3 * 3 * 2 * 2 = 72 is important.
  have h₉ : 72 ∣ a * b := by
    have : 18 * 4 ∣ a * b := by
      rw [← Nat.Coprime.mul_dvd_of_dvd_of_dvd (by norm_num)]
      · rw [← hu] at h₁
        have : 9 ∣ a := by
          have : 3 ∣ a := by
            exact h₃
            norm_num
          rw [Nat.dvd_prime_pow (by norm_num)] at this
          obtain ⟨k,hk⟩ := this
          use k
          rw [hk]
          ring
        contradiction
      · have : 2 ∣ b := by
          exact h₆
          norm_num
        rw [← hk] at h₂
        have : 4 ∣ b := by
          have : 4 ∣ b := by
            rw [Nat.dvd_prime_pow (by norm_num)]
            obtain ⟨k,hk⟩ := this
            use k
            rw [hk]
            ring
          contradiction
        assumption
    contrapose! this
    have : 72 ∣ a.gcd b := by
      have : 36 ∣ a.gcd b := by
        have : 4 ∣ a.gcd b := by
          rw [Nat.dvd_gcd_iff]
          constructor
          assumption
          assumption
        have : 9 ∣ a.gcd b := by
          have : 3 ∣ a.gcd b := by
            exact h₃
            norm_num
          rw [Nat.dvd_gcd_iff] at this
          obtain ⟨k,hk⟩ := this
          use 3*k
          rw [hk]
          ring
        have : 36 ∣ a.gcd b := by
          rw [Nat.dvd_gcd_iff]
          constructor
          assumption
          assumption
        assumption
      have : 36 ∣ a * b := by
        rw [← Nat.Coprime.mul_dvd_of_dvd_of_dvd (by norm_num)]
        constructor
        assumption
        assumption
      omega
    have : 36 ∣ a * b := by
      rw [← Nat.Coprime.mul_dvd_of_dvd_of_dvd (by norm_num)]
      constructor
      assumption
      assumption
    omega

  -- if a has a factor of 9 or b has a factor of 9, then 18 has a factor of 9, which is a contradiction.
  have h₁₀ : ¬(9 ∣ a ∨ 9 ∣ b) := by
    contrapose! h₉
    have this' : 27 ∣ a * b := by
      have this' : 27 ∣ a.gcd b := by
        have : 9 ∣ a.gcd b := by
          exact h₉
          norm_num
        rw [Nat.dvd_gcd_iff] at this
        obtain ⟨k,hk⟩ := this
        use 3*k
        rw [hk]
        ring
      rw [Nat.dvd_gcd_iff] at this'
      obtain ⟨k1,h1⟩ := this'
      obtain ⟨k2,h2⟩ := hk
      use k1 * 3
      rw [h1, h2]
      ring
    have this' : 27 ∣ a := by
      have : 27 ∣ a.gcd b := by
        exact h₉
        norm_num
      rw [Nat.dvd_gcd_iff] at this
      obtain ⟨k,hk⟩ := this
      use 9*k
      rw [hk]
      ring
    have this' : 27 ∣ 6 := by
      rw [h₃] at this'
      exact this'
    omega

  have h₁₁ : a % 2 = 0 := by
    rw [Nat.dvd_iff_mod_eq_zero] at h₅
    exact h₅.symm
  have h₁₂ : b % 2 = 0 := by
    rw [Nat.dvd_iff_mod_eq_zero] at h₆
    exact h₆.symm
  have h₁₃ : a % 3 = 0 := by
    rw [Nat.dvd_iff_mod_eq_zero] at h₃
    exact h₃.symm
  have h₁₄ : b % 3 = 0 := by
    rw [Nat.dvd_iff_mod_eq_zero] at h₄
    exact h₄.symm

  -- a has a factor of 2x3 and b has a factor of 2x3.
  have h₁₅ : 6 ∣ a := by
    rw [← Nat.dvd_gcd_iff]
    constructor
    assumption
    assumption
  have h₁₆ : 6 ∣ b := by
    rw [← Nat.dvd_gcd_iff]
    constructor
    assumption
    assumption

  -- 6x6 = 36 has a factor of 2x3, which is important.
  have h₁₇ : 36 ∣ a * b := by
    rw [← Nat.Coprime.mul_dvd_of_dvd_of_dvd (by norm_num)]
    constructor
    assumption
    assumption

  -- if a has a factor of 18 or b has a factor of 18, then 36 has a factor of 18, which is a contradiction.
  have h₁₈ : ¬(18 ∣ a ∨ 18 ∣ b) := by
    contrapose! h₁₇
    have this' : 324 ∣ a * b := by
      have this' : 18 ∣ a.gcd b := by
        exact h₁₇
        norm_num
      rw [Nat.dvd_gcd_iff] at this'
      obtain ⟨k,hk⟩ := this'
      use 18*k
      rw [hk]
      ring
    have : 324 ∣ a := by
      have : 324 ∣ a.gcd b := by
        exact h₁₇
        norm_num
      rw [Nat.dvd_gcd_iff] at this
      obtain ⟨k,hk⟩ := this
      use 18*k
      rw [hk]
      ring
    have : 324 ∣ 6 := by
      rw [h₁₃] at this
      exact this
    omega

  have h₁₉ : 2 ∣ a / 3 := by
    rw [Nat.dvd_iff_mod_eq_zero] at h₁₅
    have : 0 ≡ a / 3 * 3 [MOD 2] := by
      simp [h₁₅]
    rw [Nat.ModEq.eq_1] at this
    have : 0 % 2 = 0 := by
      norm_num
    have : (a / 3 * 3) % 2 = 0 := by
      exact this
    rw [Nat.mul_mod] at this
    have : a / 3 % 2 = 0 ∨ 1 = a / 3 % 2 := by
      apply Nat.mod_two_eq_zero_or_one
    rcases this with (h | h)
    exact h
    rw [Nat.ModEq.eq_1] at h
    have : 1 % 2 = 1 := by
      norm_num
    have : (a / 3 * 3) % 2 = 1 := by
      exact h
    rw [Nat.mul_mod] at this
    have : a / 3 % 2 = 0 ∨ 1 = a / 3 % 2 := by
      apply Nat.mod_two_eq_zero_or_one
    rcases this with (h' | h')
    exact h'
    rw [Nat.ModEq.eq_1] at h'
    have : 1 % 2 = 1 := by
      norm_num
    have : a / 3 % 2 = 1 := by
      exact h'
    have : a % 2 = 1 := by
      rw [Nat.mul_mod, h'] at this
      exact this
    have : a % 2 = 0 := by
      rw [h₁₁]
    omega

  -- 2x3x3 = 18 has a factor of 2x3, which is important.
  have h₂₀ : 18 ∣ a := by
    rw [← Nat.dvd_gcd_iff]
    constructor
    assumption
    assumption
  have h₂₁ : 18 ∣ b := by
    rw [← Nat.dvd_gcd_iff]
    constructor
    assumption
    assumption

  have h₂₂ : 36 ∣ a / 3 := by
    rw [Nat.dvd_iff_mod_eq_zero] at h₁₉
    exact h₁₉.symm

  -- if a has a factor of 36 or b has a factor of 36, then 36 has a factor of 36, which is a contradiction.
  have h₂₃ : ¬(36 ∣ a ∨ 36 ∣ b) := by
    contrapose! h₂₂
    have h₂₃ : 36 ∣ a.gcd b := by
      have : 36 ∣ a := by
        exact h₂₂
        norm_num
      rw [Nat.dvd_gcd_iff] at this
      obtain ⟨k,hk⟩ := this
      use 36 * k
      rw [hk]
      ring
    have this' : 36 ∣ a := by
      have : 36 ∣ a.gcd b := by
        exact h₂₂
        norm_num
      rw [Nat.dvd_gcd_iff] at this
      obtain ⟨k,hk⟩ := this
      use 36 * k
      rw [hk]
      ring
    assumption

  -- 6x6 = 36 has a factor of 6, which is important.
  have h₂₄ : 36 ∣ a * b / 6 := by
    rw [Nat.div_mul_comm, Nat.mul_div_assoc, Nat.dvd_iff_mod_eq_zero]
    simp
    have : 0 ≡ a * b / 6 * 6 [MOD 36] := by
      simp
      rw [← Nat.modEq_zero_iff_dvd]
      rw [Nat.mul_mod]
      have : a % 36 = 0 ∨ 1 = a % 36 ∨ 2 = a % 36 ∨ 3 = a % 36 ∨ 4 = a % 36 ∨ 5 = a % 36 ∨ 6 = a % 36 ∨ 7 = a % 36 ∨ 8 = a % 36 ∨ 9 = a % 36 ∨ 10 = a % 36 ∨ 11 = a % 36 ∨ 12 = a % 36 ∨ 13 = a % 36 ∨ 14 = a % 36 ∨ 15 = a % 36 ∨ 16 = a % 36 ∨ 17 = a % 36 ∨ 18 = a % 36 ∨ 19 = a % 36 ∨ 20 = a % 36 ∨ 21 = a % 36 ∨ 22 = a % 36 ∨ 23 = a % 36 ∨ 24 = a % 36 ∨ 25 = a % 36 ∨ 26 = a % 36 ∨ 27 = a % 36 ∨ 28 = a % 36 ∨ 29 = a % 36 ∨ 30 = a % 36 ∨ 31 = a % 36 ∨ 32 = a % 36 ∨ 33 = a % 36 ∨ 34 = a % 36 ∨ 35 = a % 36
      rcases this with (h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | h | _)
      all_goals
        rw [h]
        simp
      all_goals
        apply Nat.ModEq.eq_1
        rw [Nat.modEq_iff_dvd' (by omega)]
        have : 36 ∣ 36 := by
          exact Nat.dvd_refl 36
        assumption
    have this' : 0 ≡ a * b / 6 * 6 [MOD 36] := by
      simp
      rw [← Nat.modEq_zero_iff_dvd]
      have : 36 ∣ a * b / 6 * 6 := by
        calc
          36 = 6 * 6 := by norm_num
          _ ∣ 6 * b := by
            apply Nat.mul_dvd_mul_left
            apply Nat.dvd_trans (by omega) h₂₁
          _ = a * b / 6 * 6 := by
            rw [Nat.mul_div_assoc, Nat.mul_comm]
            ring
      assumption
    rw [← Nat.modEq_zero_iff_dvd] at this'
    rw [Nat.mul_mod] at this'
    have this' : 36 ∣ a * b / 6 * 6 := by
      calc
        36 ∣ 36 := by
          exact Nat.dvd_refl 36
        _ ∣ a * b / 6 * 6 := by
          apply Nat.dvd_trans (by omega) this'
    exact this'
    calc
      36 = 6 * 6 := by norm_num
      _ ∣ 6 * b := by
        apply Nat.mul_dvd_mul_left
        apply Nat.dvd_trans (by omega) h₂₁
      _ = a * b / 6 * 6 := by
        rw [Nat.mul_div_assoc, Nat.mul_comm]
        ring

  -- 36x6 = 216 has a factor of 36, which is important.
  have h₂₅ : 216 ∣ a * b := by
    rw [← Nat.Coprime.mul_dvd_of_dvd_of_dvd (by norm_num)]
    constructor
    assumption
    assumption

  -- if a has a factor of 72 or b has a factor of 72, then 72 has a factor of 72, which is a contradiction.
  have h₂₆ : ¬(72 ∣ a ∨ 72 ∣ b) := by
    contrapose! h₂₅
    have h₂₆ : 72 ∣ a.gcd b := by
      have : 36 ∣ a.gcd b := by
        exact h₂₅
        norm_num
      rw [Nat.dvd_gcd_iff] at this
      obtain ⟨k,hk⟩ := this
      use 72 * k
      rw [hk]
      ring
    have : 72 ∣ a := by
      have : 72 ∣ a.gcd b := by
        exact h₂₅
        norm_num
      rw [Nat.dvd_gcd_iff] at this
      obtain ⟨k,hk⟩ := this
      use 72 * k
      rw [hk]
      ring
    assumption

  -- 6x6x