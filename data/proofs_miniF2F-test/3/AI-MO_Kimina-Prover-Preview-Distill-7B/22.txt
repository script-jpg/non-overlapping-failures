-- Expand the definition of `prod`, then we get a large fraction. Simplify it.
  simp [Finset.prod, Finset.card_filter]
  rw [Nat.factorial_eq_mul_comm.2, Nat.div_div_eq_div_mul, Nat.mul_div_left_comm, Nat.mul_div_right_comm]
  simp [Nat.div_eq_mul_div, Nat.mul_div_cancel_left]

  -- Simplify the Planteday formula.
  rw [show 10000 = 2 * 5000 by norm_num]
  rw [‚Üê Nat.choose_mul_fact_eq_fact_mul_fact]
  rw [Nat.choose_mul_fact_eq_fact_mul_fact]

  -- Clear all hypotheses, and then simplify the expression step by step.
  clear * -?_
  have : 2 ^ 5000 * 5000! * (2 ^ 5000 * (Nat.choose 5000 2500) * 2 ^ 5000 * (Nat.choose 2500 1250) * 2 ^ 5000 * (Nat.choose 1250 625) * 2 ^ 5000 * (Nat.choose 625 312) * 2 ^ 5000 * (Nat.choose 312 156) * 2 ^ 5000 * (Nat.choose 156 78) * 2 ^ 5000 * (Nat.choose 78 39) * 2 ^ 5000 * (Nat.choose 39 19) * 2 ^ 5000 * (Nat.choose 19 9) * 2 ^ 5000 * (Nat.choose 9 4) * 2 ^ 5000 * (Nat.choose 4 2) * 2 ^ 5000 * (Nat.choose 2 1) * 2 ^ 5000 * (Nat.choose 1 0) = 10000! / (5000! * 2 ^ 5000) := by
    calc
      2 ^ 5000 * 5000! * (2 ^ 5000 * (Nat.choose 5000 2500) * 2 ^ 5000 * (Nat.choose 2500 1250) * 2 ^ 5000 * (Nat.choose 1250 625) * 2 ^ 5000 * (Nat.choose 625 312) * 2 ^ 5000 * (Nat.choose 312 156) * 2 ^ 5000 * (Nat.choose 156 78) * 2 ^ 5000 * (Nat.choose 78 39) * 2 ^ 5000 * (Nat.choose 39 19) * 2 ^ 5000 * (Nat.choose 19 9) * 2 ^ 5000 * (Nat.choose 9 4) * 2 ^ 5000 * (Nat.choose 4 2) * 2 ^ 5000 * (Nat.choose 2 1) * 2 ^ 5000 * (Nat.choose 1 0) = 2 ^ 5000 * 5000! * (2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (39! / (19! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (625! / (312! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (2500! / (1250! * 2 ^ 5000)) * 2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) := by
        rw [Nat.choose_eq_factorial_div_factorial]
        simp only [Nat.reduceSub, Nat.reduceMul]
        tauto
      _ = 2 ^ 5000 * 5000! * (2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (39! / (19! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (625! / (312! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (2500! / (1250! * 2 ^ 5000)) * 2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) := by
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        simp only [Nat.reduceSub, Nat.reduceMul]
        ring_nf
        tauto
      _ = 2 ^ 5000 * 5000! * (2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (39! / (19! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (625! / (312! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (2500! / (1250! * 2 ^ 5000)) * 2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) := by
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        simp only [Nat.reduceSub, Nat.reduceMul]
        ring_nf
        tauto
      _ = 2 ^ 5000 * 5000! * (2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (39! / (19! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (625! / (312! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (2500! / (1250! * 2 ^ 5000)) * 2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) := by
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        simp only [Nat.reduceSub, Nat.reduceMul]
        ring_nf
        tauto
      _ = 2 ^ 5000 * 5000! * (2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (39! / (19! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (625! / (312! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (2500! / (1250! * 2 ^ 5000)) * 2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) := by
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        simp only [Nat.reduceSub, Nat.reduceMul]
        ring_nf
        tauto
      _ = 2 ^ 5000 * 5000! * (2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (39! / (19! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (625! / (312! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (2500! / (1250! * 2 ^ 5000)) * 2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) := by
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        rw [Nat.choose_eq_factorial_div_factorial]
        simp only [Nat.reduceSub, Nat.reduceMul]
        ring_nf
        tauto
      _ = 2 ^ 5000 * 5000! * (2 ^ 5000 * (5000! / (2500! * 2 ^ 5000)) * 2 ^ 5000 * (1250! / (625! * 2 ^ 5000)) * 2 ^ 5000 * (312! / (156! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78! * 2 ^ 5000)) * 2 ^ 5000 * (39! / (19! * 2 ^ 5000)) * 2 ^ 5000 * (78! / (39! * 2 ^ 5000)) * 2 ^ 5000 * (156! / (78