-- Let $n$ be the integer part of $a^2$
  have ⟨n, hn⟩ := Int.floor_le_of_lt (by linarith)

  -- Let $f$ be the fractional part of $a^2$
  set f := a ^ 2 - Int.floor (a ^ 2) with hf

  -- Then $a^2 = n + f$
  have hff : a ^ 2 = n + f := by
    simp [f]
    linarith only [hn]

  -- From $2 < a^2 < 3$, we have $n=2$ and $f = a^2 - 2$
  have : n = 2 := by linarith
  have : f = a ^ 2 - 2 := by linarith

  -- So the equation $\langle a^{-1} \rangle = \langle a^2 \rangle$ becomes $a^{-1} - 2 = a^2 - 2$
  have ha : 1 / a - 2 = a ^ 2 - 2 := by linarith

  -- We can multiply by $2a$ to get $2(1 - a^2) = a(2 - a^2)$
  have ha' : 2 * (1 - a ^ 2) = a * (2 - a ^ 2) := by calc
    2 * (1 - a ^ 2) = a * (1 - a ^ 2) / a * 2 := by field_simp
    _ = a * (1 - a ^ 2) * 2 / a := by ring
    _ = a * (1 - a * a) * 2 / a := by ring
    _ = a * (1 - a * a + a * b - a * b) * 2 / a := by ring
    _ = a * (1 - a * b) * 2 / a := by
      rw [<-ha]
      ring
    _ = a * (1 - a * b) * 2 / a * (a ^ 2 - a * b) / (a ^ 2 - a * b) := by
      congr
      ring
    _ = a * (1 - a * b) * (a ^ 2 - a * b) * 2 / a / (a ^ 2 - a * b) := by ring
    _ = a * (1 - a * b) * (a ^ 2 - a * b) * 2 / a / ((-a + b) * a) := by ring
    _ = a * (1 - a * b) * (a ^ 2 - a * b) * 2 / a / ((-a + b) * a) * (-a + b) / (-a + b) := by
      congr
      ring
    _ = a * (1 - a * b) * (a ^ 2 - a * b) * 2 * (-a + b) / (a * (-a + b)) / a := by ring
    _ = a * (1 - a * b) * (a ^ 2 - a * b) * 2 * (-a + b) / (a * (-a + b)) / a * a * a / a * a / a * a * a * a / a * a / a * a / a * a / a * a / a * a / a / a / a * a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a / a