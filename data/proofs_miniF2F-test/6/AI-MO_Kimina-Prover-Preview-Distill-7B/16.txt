-- some auxilary facts
  have cos_sub : ∀ (a b : ℝ), Real.cos (a - b) = Real.cos a * Real.cos b + Real.sin a * Real.sin b := by
    intro a b
    exact Real.cos_sub a b
  have two_mul_cos : ∀ (a : ℝ), 2 * Real.cos a * Real.cos b = Real.cos (a + b) + Real.cos (a - b) := by
    intro a b
    rw [Real.cos_add, Real.cos_sub]
    ring
  have two_mul_sin : ∀ (a : ℝ), 2 * Real.sin a * Real.sin b = Real.cos (a - b) - Real.cos (a + b) := by
    intro a b
    rw [Real.cos_sub, Real.cos_add]
    ring

  -- rewrite hypothesis h1 by summing from 0 to k-1
  apply Finset.sum_range_succ at h₁
  rw [Finset.sum_range_succ] at h₁

  -- show that y m = 0 implies that ∑ i < k, Real.cos (a i + m) / 2 ^ i = 0
  have h4 : ∑ i in Finset.range k, Real.cos (a i + m) / 2 ^ i = 0 := by
    rw [h₁] at h₂
    simp at h₂
    exact h₂

  -- show that y n = 0 implies that ∑ i < k, Real.cos (a i + n) / 2 ^ i = 0
  have h5 : ∑ i in Finset.range k, Real.cos (a i + n) / 2 ^ i = 0 := by
    rw [h₁] at h₃
    simp at h₃
    exact h₃

  -- subtract h5 from h4
  have h6 : ∑ i in Finset.range k, (Real.cos (a i + m) / 2 ^ i - Real.cos (a i + n) / 2 ^ i) = 0 := by
    linarith only [h4, h5]

  -- factor out the common term
  have h7 : ∑ i in Finset.range k, (Real.cos (a i + m) - Real.cos (a i + n)) / 2 ^ i = 0 := by
    conv at h6 =>
      arg 1
      arg 1
      ext i
      rw [← h6 i]
      rw [div_sub_div]
    norm_num
    positivity

  clear h4 h5 h6

  -- consider the i = 0 term
  have h8 : (Real.cos (a 0 + m) - Real.cos (a 0 + n)) / 2 ^ 0 = Real.cos (a 0 + m) - Real.cos (a 0 + n) := by
    simp

  -- show that m = 2 * ∑ i < k, (Real.cos (a i + m) - Real.cos (a i + n)) / 2 ^ (i + 1)
  have h9 : m - n = 2 * ∑ i in Finset.range k, (Real.cos (a i + m) - Real.cos (a i + n)) / 2 ^ (i + 1) := by
    rw [Finset.sum_range_succ] at h7
    simp at h7
    rw [h8] at h7
    linarith only [h7]

  -- we have Real.cos (a 0 + m) - Real.cos (a 0 + n) = 2 * Real.sin (a 0 + (m + n) / 2) * Real.sin ((m - n) / 2)
  have h10 : Real.cos (a 0 + m) - Real.cos (a 0 + n) = 2 * Real.sin (a 0 + (m + n) / 2) * Real.sin ((m - n) / 2) := by
    rw [two_mul_cos, cos_sub]
    ring_nf

  -- we have Real.cos (a 1 + m) - Real.cos (a 1 + n) = 2 * Real.sin (a 1 + (m + n) / 2) * Real.sin ((m - n) / 2)
  have h11 : Real.cos (a 1 + m) - Real.cos (a 1 + n) = 2 * Real.sin (a 1 + (m + n) / 2) * Real.sin ((m - n) / 2) := by
    rw [two_mul_cos, cos_sub]
    ring_nf

  -- we have Real.cos (a 2 + m) - Real.cos (a 2 + n) = 2 * Real.sin (a 2 + (m + n) / 2) * Real.sin ((m - n) / 2)
  have h12 : Real.cos (a 2 + m) - Real.cos (a 2 + n) = 2 * Real.sin (a 2 + (m + n) / 2) * Real.sin ((m - n) / 2) := by
    rw [two_mul_cos, cos_sub]
    ring_nf

  -- combine h9, h10, h11, h12...
  conv at h9 =>
    arg 1
    arg 1
    ext i
    rw [← h7 i]
    rw [h10, h11, h12]
  have h13 : ∑ i in Finset.range k, (Real.cos (a i + m) - Real.cos (a i + n)) / 2 ^ (i + 1) = 2 * Real.sin ((m - n) / 2) * ∑ i in Finset.range k, Real.sin (a i + (m + n) / 2) / 2 ^ (i + 1) := by
    rw [Finset.sum_congr rfl]
    intro i hi
    rw [← mul_div_mul_left _ _ (show (2 : ℝ) ≠ 0 by norm_num)]
    rw [mul_div_assoc]
    simp at hi
    conv =>
      arg 1
      arg 1
      arg 1
      ext i
      rw [div_mul_div_comm]
    rw [div_self (by norm_num)]
    ring_nf
  rw [h13] at h9

  -- factors are non-zero
  -- have hm : 2 * Real.sin ((m - n) / 2) ≠ 0 := by
  --   by_contra h
  --   rw [mul_eq_zero] at h
  --   cases h with
  --   | inl h1 => norm_num at h1
  --   | inr h2 =>
  --     rw [Real.sin_eq_zero_iff] at h2
  --     obtain ⟨m, hm⟩ := h2
  --     linarith only [hm]

  have hk : ∑ i in Finset.range k, Real.sin (a i + (m + n) / 2) / 2 ^ (i + 1) ≠ 0 := by
    by_contra h
    rw [Finset.sum_eq_zero] at h
    apply_fun fun x => x * 2 ^ k at h
    simp at h
    linarith only [h]

  -- obtain that Real.sin ((m - n) / 2) = 0
  have h14 : Real.sin ((m - n) / 2) = 0 := by
    by_contra h
    have h15 : (Real.sin ((m - n) / 2) ≠ 0) ∧ (∑ i ∈ Finset.range k, Real.sin (a i + (m + n) / 2) / 2 ^ (i + 1) ≠ 0) := by
      constructor
      · exact h
      · exact hk
    have h16 : ∑ i ∈ Finset.range k, (Real.sin (a i + (m + n) / 2) / 2 ^ (i + 1)) * 2 ^ k = 0 := by
      rw [h9]
      ring
    rw [Finset.mul_sum] at h16
    apply_fun fun x => x / 2 ^ k at h16
    simp at h16
    rw [div_self (by norm_num)] at h16
    linarith only [h16, h15]

  -- conclude that (m - n) / 2 = m * Real.pi
  have h15 : (m - n) / 2 = (Real.sin_eq_zero_iff).mp h14 := by
    rw [Real.sin_eq_zero_iff] at h14
    obtain ⟨m, hm⟩ := h14
    linarith only [hm]
  rw [h15]
  obtain ⟨m, hm⟩ := Real.sin_eq_zero_iff.mpr h14
  use m
  linarith only [hm]
```