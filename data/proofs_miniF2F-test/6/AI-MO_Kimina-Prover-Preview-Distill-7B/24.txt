-- prove that cos(a_i + m) = -cos(a_i + n) for all i < k
  have h4 : ∀ i < k, Real.cos (a i + m) = - Real.cos (a i + n) := by
    intro i hi
    (have h₄ := h₁ m).symm
    (have h₅ := h₁ n).symm
    rw [h₄, h₅, Real.cos_add] at h₂ h₃
    have : Real.cos m * Real.cos (a i) + Real.sin m * Real.sin (a i) = - (Real.cos n * Real.cos (a i) + Real.sin n * Real.sin (a i)) := by
      apply congr_arg (fun x => x * Real.cos (a i) - Real.sin (a i) * x) at h₂
      rw [← sub_mul, mul_assoc, ← Real.cos_add] at h₂
      apply congr_arg (fun x => x + Real.sin n * Real.sin (a i) - Real.sin m * Real.sin (a i)) at h₂
      rw [← add_sub, sub_self, ← Real.cos_add, add_comm] at h₂
      ring_nf at h₂ ⊢
      exact h₂
    have h2 : Real.cos m * Real.cos (a i) + Real.sin m * Real.sin (a i) + (Real.cos n * Real.cos (a i) + Real.sin n * Real.sin (a i)) = 0 := by
      exact this.symm
    have h3 : (Real.cos m + Real.cos n) * Real.cos (a i) + (Real.sin m + Real.sin n) * Real.sin (a i) = 0 := by
      linarith
    have h4 : Real.cos (a i) * (Real.cos m + Real.cos n) + Real.sin (a i) * (Real.sin m + Real.sin n) = 0 := by
      linarith
    have h5 : Real.cos (a i) * Real.cos (m + n) + Real.sin (a i) * Real.sin (m + n) = 0 := by
      rw [Real.cos_add, Real.cos_add]
      apply congr_arg (fun x => x * Real.sin (a i) - Real.cos (a i) * x) at h3
      rw [← sub_mul, mul_assoc, ← Real.sin_add] at h3
      apply congr_arg (fun x => x + Real.cos (a i) * Real.cos (m + n) - Real.sin (a i) * Real.sin (m + n)) at h3
      rw [← add_sub, add_comm, ← Real.sin_add, sub_self] at h3
      ring_nf at h3 ⊢
      exact h3
    have h6 : Real.sin (m + n + a i) = 0 := by
      rw [← Real.sin_add, Real.cos_add]
      ring_nf
      exact h5
    have h7 : m + n + a i = ↑(n + m + a i) := by
      simp
      rw [Int.cast_add, add_assoc]
      simp
    have h8 : (n + m + a i) - (m + n + a i) = 0 := by
      simp [h7]
    rw [← add_assoc, add_comm, ← h8] at h6
    rw [show m + n + a i + (-m - n - a i) = 0 by ring] at h6
    rw [← h6]
    simp
  -- prove that sin(a_i + m) = -sin(a_i + n) for all i < k
  have h5 : ∀ i < k, Real.sin (a i + m) = - Real.sin (a i + n) := by
    intro i hi
    (have h₄ := h₁ m).symm
    (have h₅ := h₁ n).symm
    rw [h₄, h₅, Real.cos_add] at h₂ h₃
    have : -Real.cos (a i + m) + Real.cos (a i + n) = 0 := by
      apply congr_arg (fun x => x * Real.cos (a i) + Real.sin (a i) * x) at h₂
      rw [← mul_add, mul_comm, ← Real.cos_add] at h₂
      apply congr_arg (fun x => x - Real.sin n * Real.sin (a i) + Real.sin m * Real.sin (a i)) at h₂
      rw [← sub_add, sub_self, ← Real.cos_add, sub_self] at h₂
      ring_nf at h₂ ⊢
      exact h₂
    have h2 : Real.cos (a i + n) - Real.cos (a i + m) = 0 := by
      linarith
    have h3 : Real.cos (a i + n) = Real.cos (a i + m) := by
      linarith
    have h6 : Real.cos (a i + m) = - Real.cos (a i + n) := by
      linarith
    exact h6.symm
  -- prove that cos (a_i + j * pi / 2) = 0 or sin (a_i + j * pi / 2) = 0 for all i < k, j = 0, 1, 2, 3
  have h6 : ∀ i < k, ∀ j < 4, (Real.cos (a i + j * Real.pi / 2) = 0 ∨ Real.sin (a i + j * Real.pi / 2) = 0) := by
    intro i hi j hj
    have h2 : 0 ≤ j := by exact Nat.zero_le j
    have h3 : 1 ≤ j ∨ j = 0 := by exact Nat.one_le_iff_ne_zero.mp h2
    rcases h3 with h3 | h3
    · have h4 : j * Real.pi / 2 = 0 + (j * Real.pi / 2) := by ring
      rw [h4]
      by_cases h5 : 2 ∣ j
      · obtain ⟨r, hr⟩ := h5
        have hr2 : r * Real.pi = 0 := by
          calc
            r * Real.pi = (r * 2) * Real.pi / 2 := by ring
            _ = j * Real.pi / 2 := by rw [hr]
            _ = 0 := by exact div_eq_of_eq_mul (by apply mul_comm) h5
        have : r = 0 := by
          by_contra! h5
          replace h5 : 0 < r := by exact Nat.zero_lt_of_ne_zero h5
          have h2 : 0 < r * Real.pi := by
            apply mul_pos h5
            exact Real.pi_pos
          linarith
        rw [this] at hr
        rw [hr]
        simp
      · have h5 : (∃ r, r * Real.pi = j * Real.pi / 2) ∧ 2 ∣ j + 1 := by
          apply And.intro
          · use (j * Real.pi / 4)
            ring_nf
            rw [show (4 : ℝ) = 2 ^ 2 by norm_num]
            exact (mul_div_assoc (j * Real.pi) (2 : ℝ) 2).symm
          · apply Nat.two_dvd_ne_zero
            exact Nat.ne_of_lt (Nat.succ_pos _)
    · simp at h3
      have h4 : j * Real.pi / 2 = 0 + (j * Real.pi / 2) := by ring
      rw [h4]
      by_cases h5 : 2 ∣ j
      · obtain ⟨r, hr⟩ := h5
        have hr2 : r * Real.pi = 0 := by
          calc
            r * Real.pi = (r * 2) * Real.pi / 2 := by ring
            _ = j * Real.pi / 2 := by rw [hr]
            _ = 0 := by exact div_eq_of_eq_mul (by apply mul_comm) h5
        have : r = 0 := by
          by_contra! h5
          replace h5 : 0 < r := by exact Nat.zero_lt_of_ne_zero h5
          have h2 : 0 < r * Real.pi := by
            apply mul_pos h5
            exact Real.pi_pos
          linarith
        rw [this] at hr
        rw [hr]
        simp
      · have h5 : (∃ r, r * Real.pi = j * Real.pi / 2) ∧ 2 ∣ j + 1 := by
          apply And.intro
          · use (j * Real.pi / 4)
            ring_nf
            rw [show (4 : ℝ) = 2 ^ 2 by norm_num]
            exact (mul_div_assoc (j * Real.pi) (2 : ℝ) 2).symm
          · apply Nat.two_dvd_ne_zero
            exact Nat.ne_of_lt (Nat.succ_pos _)

  -- prove that cos (a_i + m) = 0 or sin (a_i + m) = 0 for all i < k
  have h7 : ∀ i < k, (Real.cos (a i + m) = 0 ∨ Real.sin (a i + m) = 0) := by
    intro i hi
    have h3 : 3 < 4 := by norm_num
    have h4 := h6 i hi 3 h3
    exact h4

  -- prove that cos (a_i + n) = 0 or sin (a_i + n) = 0 for all i < k
  have h8 : ∀ i < k, (Real.cos (a i + n) = 0 ∨ Real.sin (a i + n) = 0) := by
    intro i hi
    have h3 : 3 < 4 := by norm_num
    have h4 := h6 i hi 3 h3
    exact h4

  -- prove that cos (a_i + m) = 0 or sin (a_i + n) = 0 for all i < k
  have h9 : ∀ i < k, (Real.cos (a i + m) = 0 ∨ Real.sin (a i + n) = 0) := by
    intro i hi
    have h3 : 3 < 4 := by norm_num
    have hdvd : 2 ∣ 3 := by decide
    have h4 := h6 i hi 3 h3
    exact h4

  -- replace the goal to (cos (a_i + m) = 0 ∨ sin (a_i + n) = 0) 
  have h10 : ∀ i < k, (Real.cos (a i + m) = 0 ∨ Real.sin (a i + n) = 0) := by
    intro i hi
    have h3 : 3 < 4 := by norm_num
    have h4 := h6 i hi 3 h3
    exact h4

  -- use the lemma (if a + b = 0 then cos a = - cos b or sin a = - sin b) 
  -- to get cos (a_i + m) = - cos (a_i + n) or sin (a_i + m) = - sin (a_i + n)
  have h11 : ∀ i < k, (Real.cos (a i + m) = - Real.cos (a i + n) ∨ Real.sin (a i + m) = - Real.sin (a i + n)) := by
    intro i hi
    have h3 : 3 < 4 := by norm_num
    have h4 := h6 i hi 3 h3
    exact h4

  -- replace the goal to (cos (a_i + m) = - cos (a_i + n) ∨ sin (a_i + m) = - sin (a_i + n))
  have h12 : ∀ i < k, (Real.cos (a i + m) = - Real.cos (a i + n) ∨ Real.sin (a i + m) = - Real.sin (a i + n)) := by
    intro i hi
    have h3 : 3 < 4 := by norm_num
    have h4 := h6 i hi 3 h3
    exact h4

  -- correct the goal to suitable form for induction
  replace h11 : ∃ t : ℤ, ∀ i < k, Real.cos (a i + m) = (-1) ^ t * Real.cos (a i + n) ∧ Real.sin (a i + m) = (-1) ^ t * Real.sin (a i + n) := by
    -- revert the goal to have (cos (a_i + m) = - cos (a_i + n) ∨ sin (a_i + m) = - sin (a_i + n)) for all i < k
    exists 1
    intro i hi
    -- case analysis to get the form of cos (a_i + m) and sin (a_i + m)
    rcases h11 i hi with (h11 | h11)
    · use Even.one
      simp [Even.neg_one_pow]
      exact ⟨h11, by apply h5 i hi⟩
    · use Odd.one
      simp [Odd.neg_one_pow]
      exact ⟨h11, by apply h5 i hi⟩

  -- replace the goal to exist t satisfy the condition
  replace h12 : ∃ t : ℤ, ∀ i < k, Real.cos (a i + m) = (-1) ^ t * Real.cos (a i + n) ∧ Real.sin (a i + m) = (-1) ^ t * Real.sin (a i + n) := by
    -- revert the goal to have (cos (a_i + m) = - cos (a_i + n) ∨ sin (a_i + m) = - sin (a_i + n)) for all i < k
    exists 1
    intro i hi
    -- case analysis to get the form of cos (a_i + m) and sin (a_i + m)
    rcases h11 i hi with (h11 | h11)
    · use Even.one
      simp [Even.neg_one_pow]
      exact ⟨h11, by apply h5 i hi⟩
    · use Odd.one
      simp [Odd.neg_one_pow]
      exact ⟨h11, by apply h5 i hi⟩

  -- find out the contradiction when t is odd
  rcases h12 with ⟨t, h12⟩
  have h13 : t = 1 ∨ t = -1 := by
    by_contra! h13
    -- show that t = 0, otherwise the goal is trivial
    replace h13 : 0 < t ∧ t ≠ 1 := by constructor <;> exact Nat.zero_lt_of_ne_zero h13
    replace h13 : 2 ∣ t := by exact Nat.even_iff.mp (Nat.two_dvd_ne_zero h13)
    have h14 : ∃ r : ℤ, t = 2 * r := by exact even_iff_two_dvd.mp h13
    rcases h14 with ⟨r, hr⟩
    rw [hr] at h12
    -- consider the case of t = -1
    by_cases h15 : r = 0
    · rw [h15] at hr
      simp [hr] at h12
      replace h12 := h12 0
      -- consider the relation of cos (a_0 + m) and cos (a_0 + n)
      rcases h12 with (h12 | h12)
      · have h16 : Real.cos (a 0 + m) = - Real.cos (a 0 + n) := by linarith only [h12]
        replace h16 : Real.cos (a 0 + m) + Real.cos (a 0 + n) = 0 := by linarith only [h16]
        -- show the relation of sin (a_0 + m) and sin (a_0 + n)
        rcases h12 with (h12 | h12)
        · have h17 : Real.sin (a 0 + m) = - Real.sin (a 0 + n) := by linarith only [h12]
          replace h17 : Real.sin (a 0 + m) + Real.sin (a 0 + n) = 0 := by linarith only [h17]
          -- show that cos (a_0 + m) + cos (a_0 + n) 
          -- and sin (a_0 + m) + sin (a_0 + n) can't be zero
          have h18 : Real.cos (a 0 + m) + Real.cos (a 0 + n) = 0 ∧ Real.sin (a 0 + m) + Real.sin (a 0 + n) = 0 := by
            exact ⟨h16, h17⟩
          have h19 : (Real.cos (a 0 + m) + Real.cos (a 0 + n)) ^ 2 + (Real.sin (a 0 + m) + Real.sin (a 0 + n)) ^ 2 = 0 := by
            rw [h18.1, h18.2]
            norm_num
          have h20 : (Real.cos (a 0 + m) + Real.cos (a 0 + n)) ^ 2 + (Real.sin (a 0 + m) + Real.sin (a 0 + n)) ^ 2 = 
            2 + 2 * Real.cos (a 0 + m) * Real.cos (a 0 + n) + 2 * Real.sin (a 0 + m) * Real.sin (a 0 + n) := by
            ring_nf
            rw [Real.cos_sq_add_sin_sq (a 0 + m), Real.cos_sq_add_sin_sq (a 0 + n)]
            ring_nf
          rw [h20] at h19
          -- show that cos (a_0 + m) * cos (a_0 + n) + sin (a_0 + m) * sin (a_0 + n) = 1