-- We prove that the congruence $x^5 \equiv y^2 + 4 \pmod 5$ has no solution.

  have h1 (x y : ℤ) : x ^ 5 ≠ y ^ 2 + 4 := by
    -- Consider the congruence $x^5 \equiv y^2 + 4 \pmod 5$.

    -- We have $x^5 \equiv x \pmod 5$ because $x^5 - x = x(x-1)(x+1)(x^2 + 1)$ is always divisible by $5$.
    have h1 (x : ℤ) : x ^ 5 % 5 = x % 5 := by
      have : x % 5 = 0 ∨ x % 5 = 1 ∨ x % 5 = 2 ∨ x % 5 = 3 ∨ x % 5 = 4 := by omega
      rcases this with (h | h | h | h | h) <;> simp [h, pow_succ, Int.add_emod, Int.mul_emod]

    -- We have $y^2 \equiv 0$, $1$ or $4 \pmod 5$.
    have h2 (y : ℤ) : y ^ 2 % 5 = 0 ∨ y ^ 2 % 5 = 1 ∨ y ^ 2 % 5 = 4 := by
      have : y % 5 = 0 ∨ y % 5 = 1 ∨ y % 5 = 2 ∨ y % 5 = 3 ∨ y % 5 = 4 := by omega
      rcases this with (h | h | h | h | h) <;> simp [h, pow_succ, Int.add_emod, Int.mul_emod]

    -- So $y^2 + 4 \equiv 4$, $5$ or $8 \equiv 3 \pmod 5$.
    have h3 (y : ℤ) : (y ^ 2 + 4) % 5 = 4 ∨ (y ^ 2 + 4) % 5 = 0 ∨ (y ^ 2 + 4) % 5 = 3 := by
      have : y ^ 2 % 5 = 0 ∨ y ^ 2 % 5 = 1 ∨ y ^ 2 % 5 = 4 := h2 y
      rcases this with (h | h | h) <;> simp [h, Int.add_emod, Int.mul_emod]

    -- But $x^5 \equiv x \pmod 5$ and $x \not\equiv 4, 0, 3 \pmod 5$.
    have h4 (x : ℤ) : x ^ 5 % 5 ≠ 4 ∨ x ^ 5 % 5 ≠ 0 ∨ x ^ 5 % 5 ≠ 3 := by
      have : x ^ 5 % 5 = x % 5 := h1 x
      rw [this]
      have : x % 5 = 0 ∨ x % 5 = 1 ∨ x % 5 = 2 ∨ x % 5 = 3 ∨ x % 5 = 4 := by omega
      rcases this with (h | h | h | h | h) <;> simp <;> omega

    -- The congruence has no solution.
    omega

  -- Now consider the original equation $x^5 = y^2 + 4$.
  -- Rewrite it as $x^5 - y^2 = 4$.
  -- Note that $x^5 - y^2 \equiv 4 \pmod 5$.
  have h2 (x y : ℤ) : x ^ 5 - y ^ 2 ≠ 4 := by
    -- Assume on the contrary that $x^5 - y^2 = 4$.
    intro h
    -- Then $x^5 - y^2 \equiv 4 \pmod 5$.
    have : x ^ 5 - y ^ 2 ≡ 4 [ZMOD 5] := by
      rw [h]
      exact rfl
    -- But we have $x^5 \equiv x \pmod 5$ and $y^2 \equiv 0$, $1$ or $4 \pmod 5$.
    -- So $x^5 - y^2 \equiv x - y^2 \equiv 4 \pmod 5$.
    -- This means $x \equiv y^2 + 4 \pmod 5$ which is impossible by the previous lemma.
    have h3 : x ^ 5 ≡ y ^ 2 + 4 [ZMOD 5] := by
      have : x ^ 5 - y ^ 2 ≡ 4 [ZMOD 5] := this
      exact Int.ModEq.add_right_cancel' (-y ^ 2) this
    have h4 : x ^ 5 ≡ y ^ 2 + 4 [ZMOD 5] := h3
    have h5 : x ≡ y ^ 2 + 4 [ZMOD 5] := by
      have : x ^ 5 ≡ x [ZMOD 5] := Int.ModEq.pow_card x 5
      have h6 : x ^ 5 ≡ y ^ 2 + 4 [ZMOD 5] := h4
      have : x ≡ y ^ 2 + 4 [ZMOD 5] := by
        apply Int.ModEq.trans (id (Int.ModEq.symm this)) h6
      assumption
    have h6 : x ^ 5 ≡ y ^ 2 + 4 [ZMOD 5] := h4
    have : x ^ 5 ≡ x [ZMOD 5] := Int.ModEq.pow_card x 5
    have h7 : x ≡ y ^ 2 + 4 [ZMOD 5] := by
      apply Int.ModEq.trans (id (Int.ModEq.symm this)) h6
    have h8 : x ≡ y ^ 2 + 4 [ZMOD 5] := h7
    have h9 : x % 5 = y ^ 2 + 4 % 5 := Int.ModEq.emod x 5 (y ^ 2 + 4) 5
    have h10 : x ^ 5 % 5 = y ^ 2 % 5 + 4 % 5 := by omega
    have h11 : x ^ 5 % 5 = x % 5 := h1 x
    have h12 : x % 5 = y ^ 2 % 5 + 4 % 5 := by omega
    have h13 : y ^ 2 % 5 = 0 ∨ y ^ 2 % 5 = 1 ∨ y ^ 2 % 5 = 4 := h2 y
    have h14 : x % 5 ≠ y ^ 2 % 5 + 4 % 5 := by
      have : x % 5 = 0 ∨ x % 5 = 1 ∨ x % 5 = 2 ∨ x % 5 = 3 ∨ x % 5 = 4 := by omega
      rcases this with (h | h | h | h | h) <;> simp [h, Int.add_emod, Int.mul_emod] at h12 <;> omega
    contradiction

  -- The original equation has no solution.
  intro h
  have h1 : x ^ 5 - y ^ 2 = 4 := by omega
  have h2 := h2 x y
  omega
```