-- We prove that for any two integers $x$ and $y$, $x^5 \ne y^2 + 4$.
  -- First, we consider the case when $x$ is even.
  by_cases hx : Even x
  · -- If $x$ is even, then $5x^4$ is divisible by $16$.
    have h5x4 : 16 ∣ 5 * x ^ 4 := by
      rw [Nat.dvd_iff_mod_eq_zero]
      have h1 : x ^ 2 % 16 = 0 := by
        have h1 : x % 16 = 0 := by
          decide
        rw [Int.emod_pow] at h1
        simp [h1]
      have h2 : x ^ 4 % 16 = 0 := by
        calc
          _ = (x ^ 2) ^ 2 % 16 := by ring_nf
          _ = 0 ^ 2 % 16 := by rw [h1]
          _ = 0 := by simp
      calc
        _ = 5 * (x ^ 4 % 16) % 16 := by ring_nf
        _ = 5 * 0 % 16 := by rw [h2]
        _ = 0 := by simp
  -- If $x$ is even, then $x^5$ is divisible by $16$.
  have h1 : 16 ∣ x ^ 5 := by
    rw [Nat.dvd_iff_mod_eq_zero]
    have h1 : x % 16 = 0 := by
      decide
    rw [Int.emod_pow]
    simp [h1]
  -- If $x$ is even, then $x^5 \ne y^2 + 4$.
  suffices h2 : x ^ 5 ≠ y ^ 2 + 4 by
    exact h2
  -- If $x$ is even, then $y^2 + 4$ is divisible by $16$.
  have h3 : 16 ∣ y ^ 2 + 4 := by
    apply dvd_add
    · -- $16$ divides $y^2$ if $y$ is even.
      rwa [<-even_iff_two_dvd] at hx
    · -- $16$ divides $4$ if $4$ is even.
      rw [Int.even_iff]
      omega
  -- If $x$ is even, then $x^5$ and $y^2 + 4$ are both divisible by $16$.
  apply_fun (Int.emod 16) at h1 h3
  simp at h1 h3
  omega

  -- We consider the case when $x$ is odd.
  · -- If $x$ is odd, then $5x^4$ is congruent to $5$ modulo $16$.
    have h5x4 : x ^ 5 % 16 = 5 * x ^ 4 % 16 := by
      rw [Int.mul_emod, Int.pow_emod]
      decide
    have h5x4' : 5 * x ^ 4 % 16 = 5 := by
      rw [Int.mul_emod, Int.pow_emod]
      decide
    have h1 : x ^ 5 % 16 = 5 := by
      rw [h5x4, h5x4']
    -- If $x$ is odd, then $x^5$ is congruent to $5$ modulo $16$.
    -- If $x$ is odd, then $x^5 \ne y^2 + 4$.
    suffices h2 : x ^ 5 ≠ y ^ 2 + 4 by
      exact h2
    -- We prove that if $x$ is odd, then $y^2 + 4$ is congrent to $5$ modulo $16$.
    have h3 : y ^ 2 + 4 % 16 = 5 := by
      -- If $y$ is congrent to $0$ modulo $16$,
      -- then   $y^2 + 4 \equiv 0^2 + 4 \equiv 4 \equiv 4 \pmod{16}$.
      -- If $y$ is congrent to $1$ modulo $16$,
      -- then   $y^2 + 4 \equiv 1^2 + 4 \equiv 5 \pmod{16}$.
      -- If $y$ is congrent to $2$ modulo $16$,
      -- then   $y^2 + 4 \equiv 2^2 + 4 \equiv 8 \pmod{16}$.
      -- If $y$ is congrent to $3$ modulo $16$,
      -- then   $y^2 + 4 \equiv 3^2 + 4 \equiv 13 \pmod{16}$.
      -- If $y$ is congrent to $4$ modulo $16$,
      -- then   $y^2 + 4 \equiv 4^2 + 4 \equiv 20 \equiv 4 \pmod{16}$.
      -- If $y$ is congrent to $5$ modulo $16$,
      -- then   $y^2 + 4 \equiv 5^2 + 4 \equiv 29 \equiv 13 \pmod{16}$.
      -- If $y$ is congrent to $6$ modulo $16$,
      -- then   $y^2 + 4 \equiv 6^2 + 4 \equiv 40 \equiv 8 \pmod{16}$.
      -- If $y$ is congrent to $7$ modulo $16$,
      -- then   $y^2 + 4 \equiv 7^2 + 4 \equiv 53 \equiv 5 \pmod{16}$.
      -- If $y$ is congrent to $8$ modulo $16$,
      -- then   $y^2 + 4 \equiv 8^2 + 4 \equiv 68 \equiv 4 \pmod{16}$.
      -- If $y$ is congrent to $9$ modulo $16$,
      -- then   $y^2 + 4 \equiv 9^2 + 4 \equiv 85 \equiv 13 \pmod{16}$.
      -- If $y$ is congrent to $10$ modulo $16$,
      -- then   $y^2 + 4 \equiv 10^2 + 4 \equiv 104 \equiv 8 \pmod{16}$.
      -- If $y$ is congrent to $11$ modulo $16$,
      -- then   $y^2 + 4 \equiv 11^2 + 4 \equiv 125 \equiv 5 \pmod{16}$.
      -- If $y$ is congrent to $12$ modulo $16$,
      -- then   $y^2 + 4 \equiv 12^2 + 4 \equiv 148 \equiv 4 \pmod{16}$.
      -- If $y$ is congrent to $13$ modulo $16$,
      -- then   $y^2 + 4 \equiv 13^2 + 4 \equiv 173 \equiv 13 \pmod{16}$.
      -- If $y$ is congrent to $14$ modulo $16$,
      -- then   $y^2 + 4 \equiv 14^2 + 4 \equiv 200 \equiv 8 \pmod{16}$.
      -- If $y$ is congrent to $15$ modulo $16$,
      -- then   $y^2 + 4 \equiv 15^2 + 4 \equiv 229 \equiv 5 \pmod{16}$.
      have h3 : y % 16 = 0 ∨ y % 16 = 1 ∨ y % 16 = 2 ∨ y % 16 = 3 ∨ y % 16 = 4 ∨ y % 16 = 5 ∨ y % 16 = 6 ∨ y % 16 = 7 ∨ y % 16 = 8 ∨ y % 16 = 9 ∨ y % 16 = 10 ∨ y % 16 = 11 ∨ y % 16 = 12 ∨ y % 16 = 13 ∨ y % 16 = 14 ∨ y % 16 = 15 := by
        omega
      rcases h3 with (h3 | h3 | h3 | h3 | h3 | h3 | h3 | h3 | h3 | h3 | h3 | h3 | h3 | h3 | h3 | h3) <;> simp [h3, pow_two, Int.add_emod, Int.mul_emod]
    -- $x^5$ is congruent to $5$ modulo $16$ and $y^2 + 4$ is congrent to $5$ modulo $16$.
    -- $x^5$ is congruent to $5$ modulo $16$.
    -- $x^5 \ne y^2 + 4$.
    apply_fun (Int.emod 16) at h1 h3
    simp [h1] at h3
    omega
```