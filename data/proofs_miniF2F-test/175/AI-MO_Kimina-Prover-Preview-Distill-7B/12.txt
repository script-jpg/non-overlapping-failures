-- prove some auxiliary lemma to solve the problem
  have l₁ : ∀ x y, 0 < x → 0 < y → y < x → (x + y) * f x y = x * f y (x + y) := by
    intro x y hx hy hxy
    rw [h₁ x y hx hy]
    have : x + y = y + x := by ring
    rw [this]
    exact h₂ y x hy hx

  have l₂ : ∀ x y, 0 < x → 0 < y → y < x → f x y = (x * f y (x + y)) / (x + y) := by
    intro x y hx hy hxy
    have : x + y ≠ 0 := by
      rw [add_ne_zero]
      right
      calc
        0 < x := hx
        _ ≤ x + y := by linarith
    have h' := h₂ y x hy hx
    rw [mul_comm] at h'
    have : f x y = f y (x + y) * (x / (x + y)) := by
      field_simp
      rw [mul_comm]
      field_simp
      linarith
    rw [this]
    apply (mul_div_cancel_of_invertible _).symm
    use (f y (x + y))
    have : (x + y) * (1 / (x + y)) = 1 := by
      exact mul_inv_cancel₀ this
    rw [mul_div_assoc]
    rw [this]
    ring

  -- repeat using these lemmas, we can get $f(14, 52) = 364$
  have : f 14 52 = (52 * f 36 14) / 14 := by
    have h' := l₂ 14 36 (by norm_num) (by norm_num) (by norm_num)
    rw [add_comm]
    have h'' := l₂ 36 14 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 36 14 = (14 * f 50 36) / 36 := by
    have h' := l₂ 36 14 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 14 50 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 50 36 = (36 * f 86 50) / 50 := by
    have h' := l₂ 50 36 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 36 86 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 86 50 = (50 * f 136 86) / 86 := by
    have h' := l₂ 86 50 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 50 136 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 136 86 = (86 * f 222 136) / 136 := by
    have h' := l₂ 136 86 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 86 222 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 222 136 = (136 * f 358 222) / 222 := by
    have h' := l₂ 222 136 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 136 358 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 358 222 = (222 * f 580 358) / 358 := by
    have h' := l₂ 358 222 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 222 580 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 580 358 = (358 * f 938 580) / 580 := by
    have h' := l₂ 580 358 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 358 938 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 938 580 = (580 * f 1518 938) / 938 := by
    have h' := l₂ 938 580 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 580 1518 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 1518 938 = (938 * f 2456 1518) / 1518 := by
    have h' := l₂ 1518 938 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 938 2456 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 2456 1518 = (1518 * f 3974 2456) / 2456 := by
    have h' := l₂ 2456 1518 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 1518 3974 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 3974 2456 = (2456 * f 6430 3974) / 3974 := by
    have h' := l₂ 3974 2456 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 2456 6430 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 6430 3974 = (3974 * f 10404 6430) / 6430 := by
    have h' := l₂ 6430 3974 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 3974 10404 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 10404 6430 = (6430 * f 16834 10404) / 10404 := by
    have h' := l₂ 10404 6430 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 6430 16834 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 16834 10404 = (10404 * f 27238 16834) / 16834 := by
    have h' := l₂ 16834 10404 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 10404 27238 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 27238 16834 = (16834 * f 44072 27238) / 27238 := by
    have h' := l₂ 27238 16834 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 16834 44072 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 44072 27238 = (27238 * f 71310 44072) / 44072 := by
    have h' := l₂ 44072 27238 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 27238 71310 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 71310 44072 = (44072 * f 115382 71310) / 71310 := by
    have h' := l₂ 71310 44072 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 44072 115382 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 115382 71310 = (71310 * f 186694 115382) / 115382 := by
    have h' := l₂ 115382 71310 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 71310 186694 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 186694 115382 = (115382 * f 302076 186694) / 186694 := by
    have h' := l₂ 186694 115382 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 115382 302076 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 302076 186694 = (186694 * f 488770 302076) / 302076 := by
    have h' := l₂ 302076 186694 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 186694 488770 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 488770 302076 = (302076 * f 790846 488770) / 488770 := by
    have h' := l₂ 488770 302076 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 302076 790846 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 790846 488770 = (488770 * f 1279616 790846) / 790846 := by
    have h' := l₂ 790846 488770 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 488770 1279616 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 1279616 790846 = (790846 * f 2069462 1279616) / 1279616 := by
    have h' := l₂ 1279616 790846 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 790846 2069462 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 2069462 1279616 = (1279616 * f 3349078 2069462) / 2069462 := by
    have h' := l₂ 2069462 1279616 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 1279616 3349078 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 3349078 2069462 = (2069462 * f 5418540 3349078) / 3349078 := by
    have h' := l₂ 3349078 2069462 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 2069462 5418540 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 5418540 3349078 = (3349078 * f 8767618 5418540) / 5418540 := by
    have h' := l₂ 5418540 3349078 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 3349078 8767618 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 8767618 5418540 = (5418540 * f 14186158 8767618) / 8767618 := by
    have h' := l₂ 8767618 5418540 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 5418540 14186158 (by norm_num) (by norm_num) (by norm_num)
    rw [h', h'']
    norm_num
  rw [this]
  have : f 14186158 8767618 = (8767618 * f 13644776 14186158) / 14186158 := by
    have h' := l₂ 14186158 8767618 (by norm_num) (by norm_num) (by norm_num)
    have h'' := l₂ 8