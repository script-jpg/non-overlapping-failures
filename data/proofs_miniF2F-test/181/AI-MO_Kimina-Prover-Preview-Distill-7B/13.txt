have h₂ : ∀ n, 997 ≤ n → f n = n - 3 := by
    intro n hn
    apply h₀
    norm_num
    exact hn
  --we prove that for all $n\ge 997$, $f(n)=n-3$.
  --the proof uses the strong induction on $n$.
  have h₃ : ∀ n, n ≥ 997 → f n = n - 3 := by
    intro n hn
    cases' (by omega : n = 997 ∨ n > 997).or with hn hn
    --if $n=997$, we have $f(n)=f(f(1002))=f(999)=996$
    · rw [hn, h₁, h₀, h₀]; norm_num
    --if $n>997$, by the induction hypothesis, we have $f(n)=f(f(n+5))=f(n+5)-3=(n+5)-3=n+2$. However, $f(n+5)=f(f(n+8))=f(n+5+3)=f(n+8)$, so $n+2=f(n+8)$. Letting $n$ stand for $n-1$ gives $n+1=f(n+7)$. Continuing this process, we finally get $n+2=f(n+5)=f(f(n+8))=f(n+8)=n+5$, a contradiction unless $n=997$.
    · let m := n - 997
      have : n = m + 997 := by omega
      rw [this]
      have : f (m + 997) = f (f (m + 997 + 5)) := by
        apply h₁
        omega
      rw [this]
      have : m + 997 + 5 = m + 1002 := by omega
      rw [this]
      have : f (m + 1002) = (m + 1002) - 3 := by
        apply h₀
        omega
      rw [this]
      have : f (m + 997 + 3) = (m + 997 + 3) - 3 := by
        apply h₀
        omega
      rw [this]
      ring_nf
    --for all $n\ge 997$, we have $f(n)=n-3$.
  --now, we have $f(1000)=997$
  have h₄ : f 1000 = 997 := by
    have : f 1000 = 1000 - 3 := h₀ 1000 (by norm_num)
    rw [this]
    norm_num
  --we show that $f(997)=997$.
  have h₅ : f 997 = 997 := by
    have : f 997 = f (f 1002) := h₁ 997 (by norm_num)
    rw [this]
    have : f 1002 = 1002 - 3 := h₀ 1002 (by norm_num)
    rw [this]
    norm_num
  --for all $n\ge 997$, $f(n)=n-3$.
  --we prove that $f(996)=999$.
  have h₆ : f 996 = 999 := by
    have : f 996 = f (f 1001) := h₁ 996 (by norm_num)
    rw [this]
    have : f 1001 = 1001 - 3 := h₀ 1001 (by norm_num)
    rw [this]
    norm_num
  --we prove that $f(995)=1001$.
  have h₇ : f 995 = 1001 := by
    have : f 995 = f (f 1000) := h₁ 995 (by norm_num)
    rw [this]
    have : f 1000 = 997 := h₄
    rw [this]
    norm_num
  --we prove that $f(994)=997$.
  have h₈ : f 994 = 997 := by
    have : f 994 = f (f 999) := h₁ 994 (by norm_num)
    rw [this]
    have : f 999 = f (f 1004) := h₁ 999 (by norm_num)
    rw [this]
    have : f 1004 = 1004 - 3 := h₀ 1004 (by norm_num)
    rw [this]
    norm_num
  --we prove that $f(993)=996$.
  have h₉ : f 993 = 996 := by
    have : f 993 = f (f 998) := h₁ 993 (by norm_num)
    rw [this]
    have : f 998 = f (f 1003) := h₁ 998 (by norm_num)
    rw [this]
    have : f 1003 = 1003 - 3 := h₀ 1003 (by norm_num)
    rw [this]
    norm_num
  --we prove that $f(992)=995$.
  have h₁₀ : f 992 = 995 := by
    have : f 992 = f (f 997) := h₁ 992 (by norm_num)
    rw [this]
    have : f 997 = 997 := h₅
    rw [this]
    norm_num
  --we prove that $f(991)=994$.
  have h₁₁ : f 991 = 994 := by
    have : f 991 = f (f 996) := h₁ 991 (by norm_num)
    rw [this]
    have : f 996 = 999 := h₆
    rw [this]
    norm_num
  --we prove that $f(990)=993$.
  have h₁₂ : f 990 = 993 := by
    have : f 990 = f (f 995) := h₁ 990 (by norm_num)
    rw [this]
    have : f 995 = 1001 := h₇
    rw [this]
    norm_num
  --we prove that $f(989)=997$.
  have h₁₃ : f 989 = 997 := by
    have : f 989 = f (f 994) := h₁ 989 (by norm_num)
    rw [this]
    have : f 994 = 997 := h₈
    rw [this]
    norm_num
  --we prove that $f(988)=998$.
  have h₁₄ : f 988 = 998 := by
    have : f 988 = f (f 993) := h₁ 988 (by norm_num)
    rw [this]
    have : f 993 = 996 := h₉
    rw [this]
    norm_num
  --we prove that $f(987)=995$.
  have h₁₅ : f 987 = 995 := by
    have : f 987 = f (f 992) := h₁ 987 (by norm_num)
    rw [this]
    have : f 992 = 995 := h₁₀
    rw [this]
    norm_num
  --we prove that $f(986)=997$.
  have h₁₆ : f 986 = 997 := by
    have : f 986 = f (f 991) := h₁ 986 (by norm_num)
    rw [this]
    have : f 991 = 994 := h₁₁
    rw [this]
    norm_num
  --we prove that $f(985)=996$.
  have h₁₇ : f 985 = 996 := by
    have : f 985 = f (f 990) := h₁ 985 (by norm_num)
    rw [this]
    have : f 990 = 993 := h₁₂
    rw [this]
    norm_num
  --we prove that $f(984)=999$.
  have h₁₈ : f 984 = 999 := by
    have : f 984 = f (f 989) := h₁ 984 (by norm_num)
    rw [this]
    have : f 989 = 997 := h₁₃
    rw [this]
    norm_num
  --$f(84)=f(f(994))=f(997)=996$
  rw [h₁₄, h₁₀, h₅]
```