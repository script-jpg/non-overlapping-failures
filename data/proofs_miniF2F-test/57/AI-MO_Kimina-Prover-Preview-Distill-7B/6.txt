have hp : 1 < p := h₀.1
  have hq : 1 < q := by linarith
  have hr : 1 < r := by linarith

  have hpqr : 1 < p * q * r := by
    apply one_lt_mul
    apply one_lt_mul
    assumption
    assumption
    assumption

  have : 0 < p * q * r - 1 := by linarith
  have : 0 < (p - 1) * (q - 1) * (r - 1) := by
    have : 0 < p - 1 := by linarith
    have : 0 < q - 1 := by linarith
    have : 0 < r - 1 := by linarith
    apply one_lt_mul
    apply one_lt_mul
    assumption
    assumption
    assumption

  have h₂ : (p - 1) * (q - 1) * (r - 1) ≠ 0 := by linarith

  have : (p - 1) * (q - 1) * (r - 1) ∣ p * q * r - 1 :=
    this.trans h₁

  have : p * q * r - 1 ≠ 0 := by linarith

  -- We have $(p - 1) \mid (pqr - 1)$, so $(p - 1) \mid pqr - p$, so $(p - 1) \mid (pr - 1)$
  have h₃ : p - 1 ∣ p * r - 1 := by
    apply Int.dvd_sub
    apply Int.dvd_trans h₁
    apply Int.dvd_mul_left
    -- We have $pqr - 1 = p \cdot (qr) - 1$, so $(p - 1) \mid p \cdot (qr) - p$
    have : p ∣ p * q * r - p := by
      apply Int.dvd_sub
      apply Int.dvd_mul_left
      tauto
    -- So $(p - 1) \mid p \cdot (qr) - 1 - (p \cdot (qr) - p) = p - 1$
    trans p * q * r - p
    · convert h₁ using 1; ring
    · rw [show p * q * r - p - (p * r - 1) = p * r - 1 by ring]

  -- We have $(p - 1) \mid (pr - 1)$ and so $(p - 1) \mid (pr - p + p - 1) = (p - 1) r$
  have h₄ : p - 1 ∣ (p - 1) * r := by
    apply Int.dvd_mul_right

  -- So $(p - 1) \mid r - 1$ (we already had $(p - 1) \mid (pr - 1)$ and we have $p - 1 \mid p \cdot r - 1$)
  have h₅ : p - 1 ∣ r - 1 := by
    -- We have $(p - 1) \mid (pr - 1)$ (h₃) and $(p - 1) \mid (pr - p)$ (h₄)
    -- So $(p - 1) \mid (pr - 1) - (pr - p) = p - 1$
    apply Int.dvd_sub h₃ h₄

  -- So $(p - 1) \mid (r - 1)$
  have h₆ : p - 1 ∣ r - 1 := h₅

  -- So $(p - 1) \mid (qr - 1)$, and and $(p - 1) \mid q \cdot (r - 1)$
  have h₇ : p - 1 ∣ q * (r - 1) := by
    rw [show q * (r - 1) = q * r - q by ring]
    trans (p * r - 1) - q + q
    · have : q ≤ p * r - 1 := by
        -- We have $1 \leq p$, $1 \leq q$, $1 \leq r$
        -- So $p \cdot q \leq p \cdot r$
        -- So $p \cdot q \cdot r \leq p \cdot r \cdot r$
        -- So $p \cdot q \cdot r - 1 \leq p \cdot r \cdot r - 1$
        -- But $p \cdot r \cdot r - 1 = (p \cdot r - 1) \cdot r + (1 - r)$
        -- So $p \cdot q \cdot r - 1 \leq (p \cdot r - 1) \cdot r + (1 - r)$
        -- So $p \cdot q \leq (p \cdot r - 1) \cdot r + (1 - r)$
        -- So $p \cdot q - (p \cdot r - 1) \cdot r \leq 1 - r$
        -- But $p \cdot q - (p \cdot r - 1) \cdot r = q \cdot (p - (r - 1)) = q \cdot (p - r + 1)$
        -- So $q \cdot (p - r + 1) \leq 1 - r$
        -- So if $r > 1$, we have $p - r + 1 < 0$
        -- So $p < r$
        apply Int.le_of_sub_nonneg
        have : 0 ≤ (p * r - 1) * (r - 1) := by
          apply Int.mul_nonneg
          apply Int.le_of_dvd
          exact id (Int.le_of_pred_lt hr)
          · apply Int.le_of_dvd
            · apply Int.le_of_mul_le_mul_left
              · tauto
              · tauto
            · tauto
          · apply Int.le_of_pred_lt
            linarith
        linarith
      trans (p * r - 1) - q + q
      · ring
      · apply Int.le_of_sub_nonneg
        apply Int.le_of_dvd
        · apply Int.le_of_mul_le_mul_left
          · linarith
          · linarith
        · linarith
    · apply Int.le_of_sub_nonneg
      apply Int.le_of_dvd
      · apply Int.le_of_mul_le_mul_left
        · linarith
        · linarith
      · linarith
    · rfl

  -- So $(p - 1) \mid (p \cdot (qr) - 1) - p \cdot (r - 1) = p - 1$
  have h₈ : p - 1 ∣ (p - 1) * q := by
    apply Int.dvd_mul_right

  -- So $(p - 1) \mid q - 1$ (we already had $(p - 1) \mid (qr - 1)$ and we have $(p - 1) \mid (pr - 1)$)
  have h₉ : p - 1 ∣ q - 1 := by
    apply Int.dvd_sub h₇ h₈

  -- So $(p - 1) \mid (q - 1)$
  have h₁₀ : p - 1 ∣ q - 1 := h₉

  -- We can now write $q = p + d$ with $d \mid r - 1$
  obtain ⟨d, h₁₀⟩ := h₁₀
  have h₁₁ : d > 0 := by linarith

  -- We have $(d + p - 1) \mid (p - 1) r$
  have h₁₂ : (d + p - 1) ∣ (p - 1) * r := by
    rw [show d + p - 1 = p - 1 + d by ring]
    -- We have $(p - 1) \mid (pr - 1)$ (h₃) and $(d + (p - 1)) \mid (p - 1) r$ (h₁₂)
    -- So $(p - 1) \mid (dr)$
    apply Int.dvd_add h₃
    -- We have $(p - 1) \mid (pr - 1)$ (h₃) and $(d + (p - 1)) \mid (pr - 1)$ (h₆)
    -- So $(p - 1) \mid (pr - 1) - (dr) = p - 1$
    · apply Int.dvd_sub h₃ h₆
      -- We have $d \mid r - 1$ (h₉) So $(d + (p - 1)) \mid (r - 1)$
      rw [h₁₀] at h₉
      have h₁₃ : d ∣ r - 1 := h₉
      rw [show r - 1 = (d * (r / d) - 1) * d + (r % d) - (r % d) by omega]
      apply Int.dvd_add
      · apply Int.dvd_mul_right
      · apply Int.dvd_sub
        · apply Int.dvd_mul_right
        · apply Int.dvd_mod
          exact Int.dvd_of_mod_eq_zero rfl

  -- We can now write $r = dx + 1$ with $x \geq 0$
  obtain ⟨x, h₁₃⟩ := h₁₂
  have h₁₄: x > 0 := by
    by_contra h
    push_neg at h
    have : x = 0 := by linarith
    rw [this, mul_zero, add_zero, zero_add] at h₁₃
    rw [h₁₃] at h₆
    simp at h₆
    linarith

  -- We have $(p - 1) \mid (q - 1)$ (h₉) and $(p - 1) \mid (r - 1)$ (h₆), so $(p - 1) \mid (qr - 1)$
  have h₁₄ : (p - 1) ∣ (q * r - 1) :=
    Int.dvd_trans h₆
    · apply Int.dvd_mul_right
    · rw [show q * r - 1 = q * (r - 1) + (q - 1) by ring]
      apply Int.dvd_add
      · exact h₇
      · exact h₉

  -- We can now write $q r = p y + 1$ with $y \geq 0$
  obtain ⟨y, h₁₄⟩ := h₁₄
  have h₁₅ : y > 0 := by
    by_contra h
    push_neg at h
    have : y = 0 := by linarith
    rw [this, mul_zero, zero_add] at h₁₄
    rw [h₁₄] at h₁₀
    simp at h₁₀
    linarith

  -- We have $p \equiv 1 \pmod{y}$
  have h₁₅ : p ≡ 1 [MOD y] := by
    -- We have $p \equiv 1 \pmod{p - 1}$
    have h₁₆ : p ≡ 1 [MOD p - 1] := by
      apply Int.modEq_iff_dvd.mpr
      apply Int.dvd_sub
      · exact Int.dvd_refl (p - 1)
      · exact h₃
    -- We have $(p - 1) \mid (y - 1)$ (h₆)
    -- So $p \equiv 1 \pmod{y - 1}$
    have h₁₇ : p - 1 ∣ y - 1 := h₆
    have h₁₈ : y - 1 > -(p - 1) := by linarith
    have h₁₉ : y - 1 > -(p - 1) := by linarith
    have := Int.modEq_of_dvd h₁₇
    have : y - 1 + 1 > 0 := by linarith
    apply Int.ModEq.trans h₁₆
    apply Int.ModEq.trans (Int.modEq_iff_dvd.mpr h₁₇)
    rfl

  -- We have $q \equiv 1 \pmod{y}$
  have h₁₆ : q ≡ 1 [MOD y] := by
    -- We have $q \equiv 1 \pmod{q - 1}$
    have h₁₇ : q ≡ 1 [MOD q - 1] := by
      apply Int.modEq_iff_dvd.mpr
      apply Int.dvd_sub
      · exact Int.dvd_refl (q - 1)
      · exact h₇
    -- We have $(q - 1) \mid (y - 1)$ (h₅)
    -- So $q \equiv 1 \pmod{y - 1}$
    have h₁₈ : q - 1 ∣ y - 1 := h₅
    have h₁₉ : y - 1 > -(q - 1) := by linarith
    have h₁₂₀ : y - 1 > -(q - 1) := by linarith
    have := Int.modEq_of_dvd h₁₈
    apply Int.ModEq.trans h₁₇
    apply Int.ModEq.trans (Int.modEq_iff_dvd.mpr h₁₈)
    rfl

  -- So $p \equiv q \pmod{y}$
  have h₁₇ : p ≡ q [MOD y] := by
    apply Int.ModEq.trans h₁₅.symm
    apply Int.ModEq.trans (id (Int.ModEq.symm h₁₆))
    rfl

  -- So $y \mid q - p$
  have h₁₈ : y ∣ q - p := by
    -- We have $q - p \equiv 0 \pmod{y}$
    have h₁₉ : q - p ≡ 0 [MOD y] := by
      apply Int.modEq_iff_dvd.mpr
      apply Int.dvd_sub
      · exact h₁₄
      · exact h₁₀
    rw [show q - p = q - p - 0 by ring]
    apply Int.ModEq.trans h₁₉.symm
    apply Int.ModEq.trans (id (Int.ModEq.symm h₁₇))
    rfl

  -- So $y \mid (q - 1) - (p - 1)$
  have h₁₈' : y ∣ (q - 1) - (p - 1) := by
    apply Int.dvd_sub h₇ h₃

  -- So $y \mid d$
  have h₁₉ : y ∣ d := by
    rw [h₁₀]
    apply Int.dvd_add
    · exact h₁₈'
    · exact h₁₈

  -- So $d = k y$ for some $k \geq 1$
  obtain ⟨k, h₁₉⟩ := h₁₉
  have h₂₀ : k > 0 := by
    by_contra h
    push_neg at h
    have : k = 0 := by linarith
    rw [this, mul_zero, add_zero, zero_add] at h₁₉
    rw [h₁₉] at h₁₁
    simp at h₁₁
    linarith

  -- We have $(p - 1) \mid (p k + p - 1)$
  have h₂₀ : (p - 1) ∣ (p * k + p - 1) := by
    rw [h₁₉, mul_add, ←add_assoc, mul_one, ←add_sub_assoc, sub_add_cancel,
      ←Int.add_sub_assoc, show p - 1 + 1 = p by linarith, add_zero, ←Int.add_sub_assoc, sub_self, zero_add, mul_zero, sub_zero, mul_one] at h₁₈
    apply Int.dvd_add h₁₈
    apply Int.dvd_mul_right

  -- So $(p - 1) \mid (p k + p - 1) - (p - 1) = p k - 1$
  have h₂₁ : (p - 1) ∣ p * k - 1 := by
    apply Int.dvd_sub h₂₀
    apply Int.dvd_mul_right

  -- So $p - 1 \leq p k - 1$
  have h₂₂ : p - 1 ≤ p * k - 1 := by
    apply Int.le_of_dvd
    · linarith
    · exact h₂₁

  -- So $p \leq p k$
  have h₂₃ : p ≤ p * k := by linarith

  -- So $1 \leq k$
  have h₂₄ : 1 ≤ k := by
    by_contra h
    push_neg at h
    have : k = 0 := by linarith
    rw [this, mul_zero, add_zero, zero_add] at h₁₉
    rw [h₁₉] at h₂₃
    simp at h₂₃
    linarith

  -- We have $p k - 1 \mid p r - 1$ (h₃)
  -- So $p k - 1 \mid p r - p k + (p k - 1)$
  -- So $p k - 1 \mid d r$
  have h₂₅ : p * k - 1 ∣ d * r := by
    rw [h₁₃, mul_comm, ←mul_assoc, h₁₉, mul_comm, ←mul_assoc, add_sub_cancel_left,
      ←Int.mul_sub, show d * r = d * (r - 1) + d by ring] at h₃
    apply Int.dvd_add h₃
    apply Int.dvd_mul_right

  -- So $(p k - 1) \mid (d k + d - 1)$
  have h