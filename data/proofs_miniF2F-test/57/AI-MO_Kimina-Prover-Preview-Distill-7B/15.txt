have hp : 2 ≤ p := by omega
  have hq : 2 ≤ q := by omega
  have hr : 2 ≤ r := by omega

  -- First, we notice that $(p-1)(q-1)(r-1) \geq 24$.
  have h₂ : (p - 1) * (q - 1) * (r - 1) ≥ 24 := by
    calc _ ≥ 1 * 1 * 1 := by
      apply mul_le_mul
      apply mul_le_mul
      omega
      omega
      omega
      omega
    _ = 1 := by ring
    _ ≥ 24 := by omega

  -- Then, we can show that $p = 2, q = 4, r = 8$ or $p = 3, q = 5, r = 15$.
  by_cases hp : 2 ∣ (p - 1)
  · -- If $2 \mid (p - 1)$, then $2 \mid q - 1$ or $2 \mid r - 1$.
    rcases hp with ⟨k, hk⟩
    have h' : 2 * (2 * k + 1) * (q - 1) * (r - 1) ∣ (2 * (2 * k + 1) * q - 1) * (2 * (2 * k + 1) * r - 1) - 1 := by
      rw [hk]
      apply dvd_mul_of_dvd_left
      norm_num
      (repeat rw [←mul_assoc];) rw [←mul_sub_one, mul_assoc, mul_sub, mul_sub, mul_sub]
      apply Int.dvd_sub
      ring_nf
      calc _ ≤ 2 * (2 * k + 1) * q * r := by
        apply mul_le_mul
        omega
        omega
        omega
        omega
      _ ≤ 2 * (2 * k + 1) * q * (2 * (2 * k + 1) * r - 1) := by
        apply mul_le_mul
        omega
        omega
        omega
        (repeat rw [←mul_assoc];) rw [←mul_sub, mul_assoc, mul_sub, mul_sub]
        apply Int.mul_le_mul_left
        omega
        omega
    apply Int.le_of_dvd (by omega) at h'
    have h'' : 2 * (2 * k + 1) * q - 1 ≥ 2 * (2 * k + 1) * 2 - 1 := by
      apply Int.le_of_dvd (by omega)
      norm_num
      (repeat rw [←mul_assoc];) rw [←mul_sub, mul_assoc, mul_sub]
      apply Int.mul_le_mul_left
      omega
      omega
    have h'' : 2 * (2 * k + 1) * r - 1 ≥ 2 * (2 * k + 1) * 2 - 1 := by
      apply Int.le_of_dvd (by omega)
      norm_num
      (repeat rw [←mul_assoc];) rw [←mul_sub, mul_assoc, mul_sub]
      apply Int.mul_le_mul_left
      omega
      omega
    -- We can show that $2 \mid q - 1$ or $2 \mid r - 1$.
    by_cases hq : 2 ∣ (q - 1)
    · -- If $2 \mid (q - 1)$, then $2 \mid r - 1$.
      rcases hq with ⟨m, hm⟩
      have h'' : 2 * (2 * k + 1) * (2 * (2 * m + 1)) ∣ 2 * (2 * k + 1) * (2 * (2 * m + 1)) - 1 := by
        rw [hm]
        apply dvd_mul_of_dvd_left
        norm_num
        (repeat rw [←mul_assoc];) rw [←mul_sub_one, mul_assoc, mul_sub, mul_sub, mul_sub]
        apply Int.dvd_sub
        ring_nf
        calc _ ≤ 2 * (2 * k + 1) * q * r := by
          apply mul_le_mul
          omega
          omega
          omega
          omega
        _ ≤ 2 * (2 * k + 1) * (2 * (2 * m + 1)) * (2 * (2 * k + 1) * (2 * (2 * m + 1)) - 1) := by
          apply mul_le_mul
          omega
          omega
          omega
          (repeat rw [←mul_assoc];) rw [←mul_sub, mul_assoc, mul_sub, mul_sub]
          apply Int.mul_le_mul_left
          omega
          omega
      apply Int.le_of_dvd (by omega) at h''
      have h'' : 2 * (2 * k + 1) * (2 * (2 * m + 1)) - 1 ≥ 2 * (2 * k + 1) * (2 * (2 * m + 1)) - (2 * (2 * k + 1) * (2 * (2 * m + 1)) - 1) := by
        apply Int.le_of_sub_nonneg
        omega
      rw [Int.sub_sub] at h''
      omega
      omega
      omega
      omega
    · -- If $2 \nmid (q - 1)$, then $2 \mid (r - 1)$.
      have hr : 2 ∣ (r - 1) := by
        apply Prime.dvd_of_dvd_pow
        omega
        simp [Int.prime_iff_natAbs_prime]
        omega
      rcases hr with ⟨n, hr⟩
      have h'' : 2 * (2 * k + 1) * (2 * n + 1) ∣ 2 * (2 * k + 1) * (2 * n + 1) - 1 := by
        rw [hr]
        apply dvd_mul_of_dvd_left
        norm_num
        (repeat rw [←mul_assoc];) rw [←mul_sub_one, mul_assoc, mul_sub, mul_sub, mul_sub]
        apply Int.dvd_sub
        ring_nf
        calc _ ≤ 2 * (2 * k + 1) * q * r := by
          apply mul_le_mul
          omega
          omega
          omega
          omega
        _ ≤ 2 * (2 * k + 1) * (2 * n + 1) * (2 * (2 * k + 1) * (2 * n + 1) - 1) := by
          apply mul_le_mul
          omega
          omega
          omega
          (repeat rw [←mul_assoc];) rw [←mul_sub, mul_assoc, mul_sub, mul_sub]
          apply Int.mul_le_mul_left
          omega
          omega
      apply Int.le_of_dvd (by omega) at h''
      have h'' : 2 * (2 * k + 1) * (2 * n + 1) - 1 ≥ 2 * (2 * k + 1) * (2 * n + 1) - (2 * (2 * k + 1) * (2 * n + 1) - 1) := by
        apply Int.le_of_sub_nonneg
        omega
      rw [Int.sub_sub] at h''
      omega
      omega
      omega
      omega
  · -- If $2 \nmid (p - 1)$, then $p - 1 \geq 3$.
    have h' : 3 ≤ (p - 1) := by
      omega
    -- We can show that $p - 1 \mid q + q - 1$ or $p - 1 \mid r + r - 1$.
    have h'' : (p - 1) ∣ (q + q - 1) ∨ (p - 1) ∣ (r + r - 1) := by
      by_contra h
      push_neg at h
      apply Int.exists_eq_mul_right_of_dvd at h
      obtain ⟨x, hx⟩ := h.1
      obtain ⟨y, hy⟩ := h.2
      have h'' : 2 * (p - 1) * x * y = (p - 1) * (2 * x * y) := by
        ring_nf
      rw [h'', mul_assoc] at hx hy
      have h'' : (p - 1) ∣ 2 * (q - 1) * (r - 1) - (q + q - 1) + (r + r - 1) := by
        calc _ = (p - 1) * (2 * x * y) := by rw [hx, hy]
             _ = 2 * (p - 1) * x * y := by ring_nf
             _ ∣ 2 * (q - 1) * (r - 1) - (q + q - 1) + (r + r - 1) := by
                  apply dvd_mul_of_dvd_left
                  apply Int.dvd_sub
                  omega
                  apply dvd_mul_of_dvd_left
                  norm_num
                  omega
                  omega
      rw [←sub_add_eq_sub_sub] at h''
      have h'' : 2 * (q - 1) * (r - 1) - (q + q - 1) + (r + r - 1) = 2 * (q - 1) * (r - 1) - 2 * q + 2 * r := by
        ring_nf
      rw [h''] at h''
      have h'' : 2 * (q - 1) * (r - 1) - 2 * q + 2 * r ≤ 2 * (q - 1) * (r - 1) := by
        omega
      have h'' : 2 * (q - 1) * (r - 1) - 2 * q + 2 * r ≥ 2 * (q - 1) * (r - 1) - 2 * r := by
        omega
      omega
    have h'' : (p - 1) ∣ 2 * (q - 1) * (r - 1) - (q + q - 1) + (r + r - 1) := by
      calc _ = (p - 1) * (2 * x * y) := by rw [h'', mul_assoc]
           _ = 2 * (p - 1) * x * y := by ring_nf
           _ ∣ 2 * (q - 1) * (r - 1) - (q + q - 1) + (r + r - 1) := by
                apply dvd_mul_of_dvd_left
                apply Int.dvd_sub
                omega
                apply dvd_mul_of_dvd_left
                norm_num
                omega
                omega
    rw [←sub_add_eq_sub_sub] at h''
    have h'' : 2 * (q - 1) * (r - 1) - (q + q - 1) + (r + r - 1) = 2 * (q - 1) * (r - 1) - 2 * q + 2 * r := by
      ring_nf
    rw [h''] at h''
    have h'' : 2 * (q - 1) * (r - 1) - 2 * q + 2 * r ≤ 2 * (q - 1) * (r - 1) := by
      omega
    have h'' : 2 * (q - 1) * (r - 1) - 2 * q + 2 * r ≥ 2 * (q - 1) * (r - 1) - 2 * r := by
      omega
    have h''' : (p - 1) * ((q - 1) * (r - 1) - 1) ≤ 2 * ((q - 1) * (r - 1) - 1) := by
      calc _ = 2 * (q - 1) * (r - 1) - 2 * q + 2 * r := by rw [h'']
           _ ≤ 2 * (q - 1) * (r - 1) := by omega
           _ = 2 * ((q - 1) * (r - 1) - 1) + 2 := by ring_nf
           _ ≤ 2 * ((q - 1) * (r - 1) - 1) + ((q - 1) * (r - 1) - 1) := by omega
           _ = (p - 1) * ((q - 1) * (r - 1) - 1) := by
              ring_nf
              omega
    rw [mul_comm, mul_assoc] at h'''
    have h''' : ((q - 1) * (r - 1) - 1) ≤ 2 := by
      apply Int.le_of_mul_le_mul_left
      omega
      omega
    have h''' : 0 < (q - 1) * (r - 1) - 1 := by
      apply Int.zero_lt_sub_of_lt
      calc _ = q + r - 1 := by
        ring_nf
        nth_rw 1 [←mul_one (q - 1)]
        rw [mul_add_one (q - 1)]
        ring_nf
        omega
        omega
      _ ≤ q * r := by
        apply mul_le_mul
        omega
        omega
        omega
        omega
    omega

```