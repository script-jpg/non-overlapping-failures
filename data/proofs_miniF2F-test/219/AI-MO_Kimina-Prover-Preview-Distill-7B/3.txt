-- Compute the generating function of the sum.
  have hf := Finset.sum_range_succ' (fun k => Nat.choose (2 * n + 1) (2 * k + 1) * 2 ^ (3 * k))
  rw [show n + 1 = (n + 1) by rfl, show 2 * n + 1 = (2 * n + 1) by rfl] at hf
  simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
    Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul] at hf
  -- Change the summation index from $k$ to $2k$ to get a sum of binomial coefficients.
  have h : ∑ k in Finset.range (n + 1), Nat.choose (2 * n + 1) (2 * k + 1) * 2 ^ (3 * k) = ∑ k in Finset.range (2 * (n + 1)), (-1) ^ k * Nat.choose (2 * (n + 1)) k := by
    rw [Finset.sum_eq_sum_range_succ']
    rw [Finset.sum_eq_sum_range_succ']
    rw [Finset.sum_eq_sum_range_succ']
    rw [Finset.sum_eq_sum_range_succ']
    rw [show 2 * (n + 1) = (2 * n + 1) + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [← Nat.choose_two_right]
    rw [show 2 * (2 * n + 1) = 2 * n + 1 + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    nth_rw 2 [add_comm]
    rw [Finset.sum_add_distrib]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    simp only [Nat.reduceSub, Nat.reduceAdd, Nat.reduceMul, Nat.reducePow]
    rw [Finset.sum_add_distrib]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    simp only [Nat.reduceSub, Nat.reduceAdd, Nat.reduceMul, Nat.reducePow]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    simp only [Nat.reduceSub, Nat.reduceAdd, Nat.reduceMul, Nat.reducePow]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    simp only [Nat.reduceSub, Nat.reduceAdd, Nat.reduceMul, Nat.reducePow]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    simp only [Nat.reduceSub, Nat.reduceAdd, Nat.reduceMul, Nat.reducePow]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    simp only [Nat.reduceSub, Nat.reduceAdd, Nat.reduceMul, Nat.reducePow]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    simp only [Nat.reduceSub, Nat.reduceAdd, Nat.reduceMul, Nat.reducePow]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    simp only [Nat.reduceSub, Nat.reduceAdd, Nat.reduceMul, Nat.reducePow]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    simp only [Nat.reduceSub, Nat.reduceAdd, Nat.reduceMul, Nat.reducePow]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    simp only [Nat.reduceSub, Nat.reduceAdd, Nat.reduceMul, Nat.reducePow]
    congr 1
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [Finset.sum_range_succ']
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 1 = 2 * n + 1 + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 2 = 2 * n + 1 + 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose_succ_left, Nat.choose_succ_right, zero_mul,
      Nat.reducePow, mul_one, Nat.choose_one_right, Nat.reduceMul]
    rw [show 2 * (n + 1) - 3 = 2 * n + 1 + 1 - 1 by omega]
    simp only [Nat.choose_zero_right, Nat.choose