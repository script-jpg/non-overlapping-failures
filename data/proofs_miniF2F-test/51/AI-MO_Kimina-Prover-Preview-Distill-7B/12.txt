-- The function $f$ is a bijection.
  obtain ⟨σ, hσ⟩ : ∃ σ : ℝ → ℝ, σ = f := by simp

  -- Since $f$ is invertible, $f(f^{-1}(x)) = x$ for all $x$.
  have h1 (x : ℝ) : σ.1 (σ.2 x) = x := by
    rw [hσ]
    exact (σ.left_inv _).1

  -- Since $f$ is invertible, $f^{-1}(f(x)) = x$ for all $x$.
  have h2 (x : ℝ) : σ.2 (σ.1 x) = x := by
    rw [hσ]
    exact (σ.right_inv _).1

  -- By assumption, $f(2) = 4$.
  have h3 : σ.1 2 = 4 := by
    rw [hσ] at h
    exact h

  -- By assumption, $f^{-1}(2) = 4$.
  have h4 : σ.2 2 = 4 := by
    rw [← h]
    exact id.symm (Equiv.right_inv σ 2)

  -- One has $f(f^{-1}(2)) = 2$, so $f(4) = 2$.
  have h5 : σ.1 4 = 2 := by
    rw [← h4, ← h1]

  -- Then, one has $f(4) = f(f^{-1}(2)) = 2$.
  rw [h3, h5]
```