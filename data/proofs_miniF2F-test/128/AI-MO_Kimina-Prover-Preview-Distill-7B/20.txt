-- We have $\sqrt{4+\sqrt{16+16a}} = 2\sqrt{1+\sqrt{1+a}}.$
  have : Real.sqrt (4 + Real.sqrt (16 + 16 * a)) = 2 * Real.sqrt (1 + Real.sqrt (1 + a)) := by
    calc Real.sqrt (4 + Real.sqrt (16 + 16 * a))
      _ = Real.sqrt (4 + Real.sqrt (16 * (1 + a))) := by congr; ring
      _ = Real.sqrt (4 + 4 * Real.sqrt (1 + a)) := by
        congr
        rw [show √(16 * (1 + a)) = √16 * √(1 + a) by refine Real.sqrt_mul' 16 (by linarith only)]
        rw [show √16 = 4 by refine (Real.sqrt_eq_iff_mul_self_eq_of_pos?_).mpr (by linarith only)]
      _ = Real.sqrt (4 * (1 + Real.sqrt (1 + a))) := by ring_nf
      _ = Real.sqrt (2^2 * (1 + Real.sqrt (1 + a))) := by ring_nf
      _ = 2 * Real.sqrt (1 + Real.sqrt (1 + a)) := by
        rw [Real.sqrt_mul (by linarith only)]
        rw [show √(2^2) = 2 by refine (Real.sqrt_eq_iff_mul_self_eq_of_pos?_).mpr (by linarith only)]
        -- Show that $1 + \sqrt{1 + a} \geq 0$.
        positivity

  -- Substitute it into the original equation, then we get $$2\sqrt{1+\sqrt{1+a}}+ \sqrt{1+\sqrt{1+a}} = 6.$$
  rw [this] at h₀
  have : 3 * Real.sqrt (1 + Real.sqrt (1 + a)) = 6 := by linarith only [h₀]
  have : Real.sqrt (1 + Real.sqrt (1 + a)) = 2 := by linarith only

  -- Square both sides to get $$1+\sqrt{1+a} = 4.$$
  apply congr_arg (fun x ↦ x ^ 2) at this
  rw [show (2 : ℝ) ^ 2 = 4 by norm_num] at this

  -- Show that $\sqrt{1+a} = 1$.
  replace this : Real.sqrt (1 + a) = 1 := by linarith only [this]

  -- Square both sides to get $$1+a = 1.$$
  apply congr_arg (fun x ↦ x ^ 2) at this
  rw [show (1 : ℝ) ^ 2 = 1 by norm_num] at this

  -- Show that $a = 8$.
  linarith only [this]

```