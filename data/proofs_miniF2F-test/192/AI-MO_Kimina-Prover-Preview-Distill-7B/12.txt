-- The first three terms of an arithmetic sequence are $2x - 3$, $5x - 11$, and $3x + 1$ respectively.
  -- The $n$th term of the sequence is $2009$. What is $n$?

  -- Since it is an arithmetic sequence, the difference is constant. So,
  -- $a_2 - a_1 = a_3 - a_2$
  have h₆ : a 2 - a 1 = a 3 - a 2 := by
    exact h₁ 1

  -- Replace $a_1$, $a_2$, $a_3$ with the given terms respectively.
  rw [h₂, h₃, h₄] at h₆
  -- Now h₆ is $5x - 11 - (2x - 3) = 3x + 1 - (5x - 11)$
  -- Simplify it to get $3x - 8 = -2x + 12$.
  simp at h₆
  ring_nf at h₆

  -- Solve for $x$, so $5x = 20$, so $x = 4$.
  have hx : x = 4 := by linarith

  -- Substitute $x = 4$ into $a_1$, $a_2$, $a_3$ respectively.
  rw [hx] at h₂ h₃ h₄
  -- Now $a_1 = 2(4) - 3 = 5$, $a_2 = 5(4) - 11 = 9$, $a_3 = 3(4) + 1 = 13$.
  simp at h₂ h₃ h₄

  -- The pattern is $a_m = 4m + 1$.
  have h₇ (m : ℕ) : a (m + 1) = 4 * (m + 1) + 1 := by
    -- Use induction on $m$.
    induction m with
    | zero =>
      -- When $m = 0$, $a_1 = 5 = 4 \cdot 1 + 1$.
      rw [h₂]
      norm_num
    | succ m ih =>
      -- Suppose $a_{m+1} = 4(m+1) + 1$, and prove $a_{m+2} = 4(m+2) + 1$.
      have h₈ : a (m + 2) = a (m + 1) + (a 2 - a 1) := by
        rw [h₁ (m + 1)]
        ring_nf
      rw [h₈, ih]
      -- The difference between consecutive terms is $4$.
      simp [h₂, h₃]
      ring_nf

  -- Since $a_n = 2009$, and $a_n = 4n + 1$, we have $4n + 1 = 2009$.
  have h₉ : a n = 4 * n + 1 := by
    apply h₇
    omega

  rw [h₉] at h₅
  -- Solve for $n$, so $4n = 2008$, so $n = 502$.
  omega
```