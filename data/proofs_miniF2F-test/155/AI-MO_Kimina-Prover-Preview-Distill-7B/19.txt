-- We will prove that the solution set is exactly $\{\pi/2, 3\pi/2, 5\pi/2, 7\pi/2, 9\pi/2\}$.
  suffices S = {Real.pi / 2, 3 * Real.pi / 2, 5 * Real.pi / 2, 7 * Real.pi / 2, 9 * Real.pi / 2} by
    simp [this]

  -- First, we show that the set of solutions is a subset of $\{\pi/2, 3\pi/2, 5\pi/2, 7\pi/2, 9\pi/2\}$.
  have h₁ : S ⊆ {Real.pi / 2, 3 * Real.pi / 2, 5 * Real.pi / 2, 7 * Real.pi / 2, 9 * Real.pi / 2} := by
    -- Take $x$ in $S$.
    intro x hx
    rw [h₀] at hx
    rcases hx with ⟨hx, hx₁, hx₂⟩

    -- Since $\tan(2x)$ is undefined at $x = \pi/4$, $3\pi/4$, $5\pi/4$, $7\pi/4$, $9\pi/4$, we have $x \neq (\pi/4) + k\pi$ for any $k \in \mathbb{Z}$.
    have h₁ : x ≠ (Real.pi / 4) + (Real.pi / 2) * (↑n : ℝ) := by
      -- Prove by contradiction.
      by_contra!
      -- We have $x = (\pi/4) + (\pi/2) \cdot n$ for some $n \in \mathbb{Z}$.
      rw [this] at hx₂
      have : Real.tan (2 * ((Real.pi / 4) + (Real.pi / 2) * (↑n : ℝ))) = 0 := by
        simp [Real.tan_eq_sin_div_cos, Real.sin_pi_div_two, Real.cos_pi_div_two, mul_comm]
      rw [this] at hx₂
      have : ¬Real.cos ((↑n : ℝ) * Real.pi / 2) = 0 := by
        -- We have $\cos(\tfrac{x}{2}) = \cos((\pi/8) + (\pi/4) \cdot n)$, which is not zero.
        have : (↑n : ℝ) * Real.pi / 2 = (Real.pi / 8) + (Real.pi / 4) * (↑n : ℝ) := by ring
        rw [this]
        have h₁ : Real.cos ((Real.pi / 8) + (Real.pi / 4) * (↑n : ℝ)) ≠ 0 := by
          apply Real.cos_ne_zero_iff.mpr
          apply ne_of_gt
          apply add_pos
          · rw [Real.pi_pos]
          · have : (Real.pi / 4) * (↑n : ℝ) > 0 := by
              apply mul_pos
              · rw [div_pos_iff]
                exact Real.pi_pos
              · rw [show (4 : ℝ) = 2 ^ 2 by norm_num]
                simp
                exact_mod_cast abs_nonneg n
            linarith
        exact h₁
      contradiction

    -- Since $\tan(2x)$ is defined at $x = 3\pi/4$, $5\pi/4$, $7\pi/4$, $9\pi/4$, we have $x \neq (\pi/4) + k\pi$ for any $k \in \mathbb{Z}$.
    have h₂ : x ≠ (Real.pi / 4) + (Real.pi / 2) * (↑n : ℝ) := by
      -- Prove by contradiction.
      by_contra!
      -- We have $x = (\pi/4) + (\pi/2) \cdot n$ for some $n \in \mathbb{Z}$.
      rw [this] at hx₂
      have : Real.tan (2 * ((Real.pi / 4) + (Real.pi / 2) * (↑n : ℝ))) = 0 := by
        simp [Real.tan_eq_sin_div_cos, Real.sin_pi_div_two, Real.cos_pi_div_two, mul_comm]
      rw [this] at hx₂
      have : ¬Real.cos ((↑n : ℝ) * Real.pi / 2) = 0 := by
        -- We have $\cos(\tfrac{x}{2}) = \cos((3\pi/8) + (\pi/4) \cdot n)$, which is not zero.
        have : (↑n : ℝ) * Real.pi / 2 = (3 * Real.pi / 8) + (Real.pi / 4) * (↑n : ℝ) := by ring
        rw [this]
        have h₁ : Real.cos ((3 * Real.pi / 8) + (Real.pi / 4) * (↑n : ℝ)) ≠ 0 := by
          apply Real.cos_ne_zero_iff.mpr
          apply ne_of_gt
          apply add_pos
          · have : 3 * Real.pi / 8 > 0 := by
              rw [div_pos_iff]
              · rw [show (8 : ℝ) = 2 ^ 3 by norm_num]
              · exact Real.pi_pos
            linarith
          · have : (Real.pi / 4) * (↑n : ℝ) > 0 := by
              apply mul_pos
              · rw [div_pos_iff]
                exact Real.pi_pos
              · rw [show (4 : ℝ) = 2 ^ 2 by norm_num]
                simp
                exact_mod_cast abs_nonneg n
            linarith
        exact h₁
      contradiction

    -- Since $\tan(2x)$ is undefined at $x = \pi/2$, $3\pi/2$, $5\pi/2$, $7\pi/2$, $9\pi/2$, we have $x \neq \pi/2 + k\pi$ for any $k \in \mathbb{Z}$.
    have h₃ : x ≠ (Real.pi / 2) + (Real.pi) * (↑n : ℝ) := by
      -- Prove by contradiction.
      by_contra!
      -- We have $x = (\pi/2) + \pi \cdot n$ for some $n \in \mathbb{Z}$.
      rw [this] at hx₂
      simp [Real.tan_eq_sin_div_cos, Real.sin_pi_div_two, Real.cos_pi_div_two, mul_comm] at hx₂
      have : (↑n : ℝ) ≠ 0 := by
        by_contra!
        rw [this] at hx
        linarith [Real.pi_pos]
      have : ¬Real.cos ((↑n : ℝ) * Real.pi) = 0 := by
        -- If $\cos(\tfrac{x}{2}) = \cos(\tfrac{\pi}{4} + \tfrac{\pi}{2} \cdot n) = 0$, then $n = 2k + 1$ for some $k \in \mathbb{Z}$, and $\cos(\tfrac{x}{2}) = \cos((2k + 1) \cdot \dfrac{\pi}{2}) = 0$.
        by_contra!
        have : Real.cos ((↑n : ℝ) * Real.pi) = 0 := by
          rw [this]
          simp
        obtain ⟨k, hk⟩ := Real.cos_eq_zero_iff.1 this
        replace hk : (↑n : ℝ) = (2 * k : ℝ) + 1 := by
          linarith
        have : (↑n : ℝ) ≠ 0 := by
          by_contra!
          rw [this] at hk
          linarith
        absurd this
        simp
        use k
        linarith
      contradiction

    -- Since $\tan(2x)$ is defined at $x = \pi/2$, $3\pi/2$, $5\pi/2$, $7\pi/2$, $9\pi/2$, we have $x \neq \pi/2 + k\pi$ for any $k \in \mathbb{Z}$.
    have h₄ : x ≠ (Real.pi / 2) + (Real.pi) * (↑n : ℝ) := by
      -- Prove by contradiction.
      by_contra!
      -- We have $x = (\pi/2) + \pi \cdot n$ for some $n \in \mathbb{Z}$.
      rw [this] at hx₂
      simp [Real.tan_eq_sin_div_cos, Real.sin_pi_div_two, Real.cos_pi_div_two, mul_comm] at hx₂
      have : (↑n : ℝ) ≠ 0 := by
        by_contra!
        rw [this] at hx
        linarith [Real.pi_pos]
      have : ¬Real.cos ((↑n : ℝ) * Real.pi) = 0 := by
        -- If $\cos(\tfrac{x}{2}) = \cos(\tfrac{3\pi}{4} + \tfrac{\pi}{2} \cdot n) = 0$, then $n = 2k + 1$ for some $k \in \mathbb{Z}$, and $\cos(\tfrac{x}{2}) = \cos((2k + 1) \cdot \dfrac{\pi}{2}) = 0$.
        by_contra!
        have : Real.cos ((↑n : ℝ) * Real.pi) = 0 := by
          rw [this]
          simp
        obtain ⟨k, hk⟩ := Real.cos_eq_zero_iff.1 this
        replace hk : (↑n : ℝ) = (2 * k : ℝ) + 1 := by
          linarith
        have : (↑n : ℝ) ≠ 0 := by
          by_contra!
          rw [this] at hk
          linarith
        absurd this
        simp
        use k
        linarith
      contradiction

    -- We have $x \in [\pi/2, 3\pi/2] \cup [3\pi/2, 5\pi/2] \cup [5\pi/2, 7\pi/2] \cup [7\pi/2, 9\pi/2]$.
    have h₅ : (Real.pi / 2 ≤ x ∧ x ≤ 3 * Real.pi / 2) ∨ (Real.pi / 2 ≤ x ∧ x ≤ 3 * Real.pi / 2) ∨ (Real.pi / 2 ≤ x ∧ x ≤ 3 * Real.pi / 2) ∨ (Real.pi / 2 ≤ x ∧ x ≤ 3 * Real.pi / 2) := by
      by_contra!
      have : x < Real.pi / 2 ∨ 3 * Real.pi / 2 < x ∨ 5 * Real.pi / 2 < x ∨ 7 * Real.pi / 2 < x ∨ 9 * Real.pi / 2 < x := by
        simp at this
        omega
      rcases this with (h | h | h | h | h)
      · constructor
        · linarith [Real.pi_pos]
        · linarith [h]
      · constructor
        · linarith [h]
        · linarith [Real.pi_pos]
      · constructor
        · linarith [h]
        · linarith [Real.pi_pos]
      · constructor
        · linarith [h]
        · linarith [Real.pi_pos]
      · constructor
        · linarith [h]
        · linarith [Real.pi_pos]
    rcases h₅ with ((h₅ | h₅) | h₅) | h₅
    · -- If $x \in [\pi/2, 3\pi/2]$, then $x = \pi/2 + k\pi$ for some $k \in \mathbb{Z}$.
      have h₆ : x = (Real.pi / 2) + (Real.pi) * (↑n : ℝ) := by
        obtain ⟨k, hk⟩ := EuclideanDomain.div_add_mod x (Real.pi / 2)
        have : x = (Real.pi / 2) + (Real.pi / 2 - (Real.pi / 2) % Real.pi) * (↑k : ℝ) + (Real.pi / 2) % Real.pi := by
          simp [← Real.pi_pos]
          rw [← EuclideanDomain.mod_add_div x (Real.pi / 2), ← hk]
          ring
        have h₆ : (Real.pi / 2) % Real.pi = 0 := by
          rw [Real.emultiplicative_pi]
          exact Real.pi_ne_zero
        rw [h₆] at this
        simp at this
        rw [this]
        convert hk using 1
        simp
        rw [show (2 : ℝ) = (2 : ℤ) by norm_num, ← Int.cast_mul, mul_comm, mul_div_assoc]
        simp
        linarith
      -- We have $k = 0$ or $k = 1$.
      have h₇ : (↑n : ℝ) = 0 ∨ (↑n : ℝ) = 1 := by
        by_contra!
        obtain ⟨k, hk⟩ := EuclideanDomain.div_add_mod n 2
        have : (↑n : ℝ) = (2 : ℝ) * (↑k : ℝ) + (n % 2) := by
          simp [← Nat.ofNat_zero_le, Nat.mod_lt, hk]
          ring
        have : (↑n : ℝ) > 1 := by
          rw [this]
          apply lt_of_lt_of_le (by norm_num)
          apply mul_le_mul_of_nonneg_left (by norm_num) (by simp)
        absurd this
        simp [h₅]
        omega
      rcases h₇ with (h₇ | h₇)
      · -- If $k = 0$, then $x = \pi/2$.
        rw [h₇] at h₆
        simp at h₆
        rw [h₆] at hx
        norm_num at hx
        rw [hx] at h₁
        have : (↑0 : ℝ) ≠ 1 := by norm_num
        contradiction
      · -- If $k = 1$, then $x = 3\pi/2$.
        rw [h₇] at h₆
        simp at h₆
        rw [h₆] at hx
        norm_num at hx
        rw [hx] at h₂
        have : (↑1 : ℝ) ≠ 0 := by norm_num
        contradiction
    · -- If $x \in [3\pi/2, 5\pi/2]$, then $x = 3\pi/2 + k\pi$ for some $k \in \mathbb{Z}$.
      have h₆ : x = (3 * Real.pi / 2) + (Real.pi) * (↑n : ℝ) := by
        obtain ⟨k, hk⟩ := EuclideanDomain.div_add_mod x (3 * Real.pi / 2)
        have : x = (3 * Real.pi / 2) + (Real.pi) * (↑k : ℝ) + (Real.pi / 2) % Real.pi := by
          simp [← Real.pi_pos]
          rw [← EuclideanDomain.mod_add_div x (3 * Real.pi / 2), ← hk]
          ring
        have h₆ : (Real.pi / 2) % Real.pi = 0 := by
          rw [Real.emultiplicative_pi]
          exact Real.pi_ne_zero
        rw [h₆] at this
        simp at this
        rw [this]
        convert hk using 1
        simp
        rw [show (2 : ℝ) = (2 : ℤ) by norm_num, ← Int.cast_mul, mul_comm, mul_div_assoc]
        simp
        linarith
      -- We have $k = 0$ or $k = 1$.
      have h₇ : (↑n : ℝ) = 0 ∨ (↑n : ℝ) = 1 := by
        by_contra!
        obtain ⟨k, hk⟩ := EuclideanDomain.div_add_mod n 2
        have : (↑n : ℝ) = (2 : ℝ) * (↑k : ℝ) + (n % 2) := by
          simp [← Nat.ofNat_zero_le, Nat.mod_lt, hk]
          ring
        have : (↑n : ℝ) > 1 := by
          rw [this]
          apply lt_of_lt_of_le (by norm_num)
          apply mul_le_mul_of_nonneg_left (by norm_num) (by simp)
        absurd this
        simp [h₅]
        omega
      rcases h₇ with (h₇ | h₇)
      · -- If $k = 0$, then $x = 3\pi/2$.
        rw [h₇] at h₆
        simp at h₆
        rw [h₆] at hx
        norm_num at hx
        rw [hx] at h₂
        have : (↑1 : ℝ) ≠ 0 := by norm_num
        contradiction
      · -- If $k = 1$, then $x = 5\pi/2$.
        rw [h₇] at h₆
        simp at h₆
        rw [h₆] at hx
        norm_num at hx
        rw [hx] at h₃
        have : (↑2 : ℝ) ≠ 0 := by norm_num
        contradiction
    · -- If $x \in [5\pi/2, 7\pi/2]$, then $x = 5\pi/2 + k\pi$ for some $k \in \mathbb{Z}$.
      have h₆ : x = (5 * Real.pi / 2) + (Real.pi) * (↑n : ℝ) := by
        obtain ⟨k, hk⟩ := EuclideanDomain.div_add_mod x (5 * Real.pi / 2)
        have : x = (5 * Real.pi / 2) + (Real.pi) * (↑k : ℝ) + (Real.pi / 2) % Real.pi := by