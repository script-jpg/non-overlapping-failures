-- We have $3x^2 y^2 + y^2 - 30x^2 = 517$.

  -- We can factor this as $(3x^2 + 1)(y^2 - 10) = 517 - 10$.

  have h₁ : (3 * x ^ 2 + 1) * (y ^ 2 - 10) = 517 - 10 := by
    ring_nf at h₀ ⊢
    linarith only [h₀]

  -- So $(3x^2 + 1)(y^2 - 10) = 507 = 39 \cdot 13$.

  have h₂ : (3 * x ^ 2 + 1) * (y ^ 2 - 10) = 39 * 13 := by
    norm_num [h₁]

  -- So $3x^2 + 1 \leq 39$.

  have h₃ : 3 * x ^ 2 + 1 ≤ 39 := by
    apply Int.le_of_dvd (by norm_num)
    use y ^ 2 - 10
    exact h₂.symm

  -- And $3x^2 + 1$ is a divisor of 39.

  have h₄ : (3 * x ^ 2 + 1) ∣ 39 := by
    use y ^ 2 - 10
    exact h₂.symm

  -- The divisors of 39 are 1, 3, 13, and 39.

  have h₅ : (3 * x ^ 2 + 1) = 1 ∨ (3 * x ^ 2 + 1) = 3 ∨ (3 * x ^ 2 + 1) = 13 ∨ (3 * x ^ 2 + 1) = 39 := by
    apply Int.eq_one_or_neg_one_of_mul_eq_one
    exact h₄.symm
    norm_num

  -- So $3x^2 = 0, 2, 12, or 38$.

  have h₆ : 3 * x ^ 2 = 0 ∨ 3 * x ^ 2 = 2 ∨ 3 * x ^ 2 = 12 ∨ 3 * x ^ 2 = 38 := by
    omega

  have h₇ : (Int.reducePow (x ^ 2) 2) = x ^ 4 := by
    ring

  have h₈ : (Int.reducePow (x ^ 2) 3) = x ^ 6 := by
    ring

  have h₉ : (Int.reducePow (x ^ 2) 4) = x ^ 8 := by
    ring

  -- So $x^4 = 0, 2, 12, or 38$.

  have h₁₀ : x ^ 4 = 0 ∨ x ^ 4 = 2 ∨ x ^ 4 = 12 ∨ x ^ 4 = 38 := by
    omega

  -- A simple lemma.

  have h₁₁ : ∀ k : ℤ, k > 0 → k = 1 ∨ k = 2 ∨ k = 3 ∨ k = 4 := by
    intro k hk
    have h : k = 1 ∨ k = 2 ∨ k = 3 ∨ k = 4 := by
      omega
    exact h

  -- So $x = 0, 1, -1, 2, -2, 3, -3, 4, -4$.

  have h₁₂ : (x = 0 ∨ x = 1 ∨ x = -1 ∨ x = 2 ∨ x = -2 ∨ x = 3 ∨ x = -3 ∨ x = 4 ∨ x = -4) := by
    have hk : x ^ 4 > 0 := by
      apply pow_pos
      omega
    have h : (Int.reducePow x 4) = 1 ∨ (Int.reducePow x 4) = 2 ∨ (Int.reducePow x 4) = 3 ∨ (Int.reducePow x 4) = 4 := by
      change (Int.reducePow x 4) = 1 ∨ (Int.reducePow x 4) = 2 ∨ (Int.reducePow x 4) = 3 ∨ (Int.reducePow x 4) = 4
      apply h₁₁ _ hk
    have h' : (Int.reducePow x 4) = x ^ 4 := by
      rw [h₇]
    rw [h'] at h
    omega

  have h₁₃ : (x = 0 ∨ x = 1 ∨ x = -1 ∨ x = 2 ∨ x = -2 ∨ x = 3 ∨ x = -3 ∨ x = 4 ∨ x = -4) →
      (3 * x ^ 2 = 0 ∨ 3 * x ^ 2 = 2 ∨ 3 * x ^ 2 = 12 ∨ 3 * x ^ 2 = 38) := by
    intro h
    rcases h with (rfl | rfl | rfl | rfl | rfl | rfl | rfl | rfl | rfl)
    any_goals simp [h₇]
    any_goals simp [h₈]
    any_goals simp [h₉]

  -- So $3x^2 = 0, 2, 12, or 38$.

  have h₁₄ : 3 * x ^ 2 = 0 ∨ 3 * x ^ 2 = 2 ∨ 3 * x ^ 2 = 12 ∨ 3 * x ^ 2 = 38 := by
    rcases h₁₂ with h
    exact h₁₃ h

  -- Hence $3x^2 y^2 = 588$.

  have h₁₅ : 3 * x ^ 2 * y ^ 2 = 588 := by
    rcases h₁₄ with (h | h | h | h)
    any_goals simp [h, h₁]
    any_goals simp [h]

  rw [mul_assoc] at h₁₅
  exact h₁₅
```