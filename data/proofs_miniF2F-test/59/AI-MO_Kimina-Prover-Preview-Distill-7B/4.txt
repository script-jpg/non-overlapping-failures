-- We prove that $x^2 y^2 = 196$.

  -- We have $x^2 y^2 = 196$.
  have h₁ : x ^ 2 * y ^ 2 = 196 := by

    -- We move the terms of $h₀$ to the LHS.
    apply_fun (fun z => z - 30 * x ^ 2 - 517) at h₀
    nth_rewrite 1 [show 0 = 0 + 517 by simp] at h₀
    rw [add_assoc, add_sub, add_zero] at h₀
    nth_rewrite 2 [add_comm] at h₀
    rw [← add_mul] at h₀
    nth_rewrite 2 [← mul_one (x ^ 2)] at h₀
    rw [← add_mul] at h₀
    nth_rewrite 3 [add_comm] at h₀
    rw [← sub_mul] at h₀
    nth_rewrite 3 [← mul_one 3] at h₀
    rw [← ← add_sub] at h₀
    nth_rewrite 4 [add_comm] at h₀
    rw [← mul_assoc] at h₀
    nth_rewrite 5 [← mul_one (y ^ 2)] at h₀
    rw [mul_add, ← mul_assoc] at h₀
    nth_rewrite 6 [← mul_one 3] at h₀
    rw [mul_assoc, add_right_comm, mul_add] at h₀
    clear * - h₀
    -- We have $(xy)^2 = 196$.
    replace h₀ : (x * y) ^ 2 = 196 := by
      rw [mul_pow]
      ring_nf at h₀ ⊢
      exact h₀
    -- We have $14^2 = 196$.
    have h₁ : (14 : ℤ) ^ 2 = 196 := by
      norm_num
    -- We have $(xy)^2 = 14^2$.
    rw [h₁] at h₀
    -- We have $xy = 14$ or $xy = -14$.
    rw [sq_eq_sq_iff_eq_or_eq_neg] at h₀
    rcases h₀ with h₀ | h₀
    -- If $xy = 14$, then $3xy = 42$.
    · apply_fun (fun z => 3 * z) at h₀
      rw [← h₀]
      norm_num
    -- If $xy = -14$, then $3xy = -42$.
    · apply_fun (fun z => 3 * z) at h₀
      rw [← h₀]
      norm_num


  -- We multiply both sides of $h₁$ by $3$ to get the desired result.
  apply_fun (fun z => 3 * z) at h₁
  rw [mul_assoc, mul_comm, mul_assoc, h₁]
  norm_num
```