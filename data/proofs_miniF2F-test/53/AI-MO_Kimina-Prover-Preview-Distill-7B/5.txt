-- using `have h₁ : 2 * (14 * n + 3) < 14 * n + 3 := by`
  -- we can make `omega` work, but it seems like this approach doesn't work.
  have h₁ : 7 * n > 3 := by
    suffices 7 * n ≥ 7 * 3 by omega
    omega
  have h₂ : 2 * (7 * n) > 3 * (3 * n) := by
    suffices 2 * (7 * n) ≥ 2 * (3 * n) by omega
    omega
  -- Identify a multiple of 3 greater than 3.
  have h₃ : 3 ∣ 3 * (3 * n) := by
    exact Nat.dvd_mul_left 3 (3 * n)
  -- Identify a multiple of 7 greater than 7.
  have h₄ : 7 ∣ 7 * n := by
    exact Nat.dvd_mul_left 7 n
  -- We are going to show that 7 ∤ 7 * n - 3.
  have h₅ : ¬ 7 ∣ 7 * n - 3 := by
    intro h₅
    -- We have 7 ∣ 3, which is a contradiction.
    have h₆ : 7 ∣ 3 := by
      calc
        7 ∣ 7 * n - 3 := h₅
        _ ∣ 3        := by    suffices 7 * n ≥ 3 by omega
                          omega
    norm_num at h₆
  -- We are going to show that 3 ∤ 7 * n - 3.
  have h₆ : ¬ 3 ∣ 7 * n - 3 := by
    intro h₆
    -- We have 3 ∣ 7 * n, which is a contradiction.
    have h₇ : 3 ∣ 7 * n := by
      calc
        3 ∣ 7 * n - 3 := h₆
        _ ∣ 7 * n     := by    suffices 3 * n ≥ 3 by omega
                          omega
    norm_num at h₇
  -- We have shown that 7 ∤ 7 * n - 3 and 3 ∤ 7 * n - 3, so gcd (7 * n - 3) 7 = 1 and gcd (7 * n - 3) 3 = 1.
  have h₇ : Nat.Coprime (7 * n - 3) 7 := by
    refine Nat.coprime_of_dvd_ne?_?_
    · intro h₈
      have h₈ : 7 ∣ 3 := by
        calc
          7 ∣ 7 * n - 3 := h₈
          _ ∣ 3        := by    suffices 7 * n ≥ 3 by omega
                          omega
      norm_num at h₈
    · rfl
  have h₈ : Nat.Coprime (7 * n - 3) 3 := by
    refine Nat.coprime_of_dvd_ne?_?_
    · intro h₉
      have h₉ : 3 ∣ 7 * n - 3 := h₉
      have h₁₀ : 3 ∣ 7 * n := by
        calc
          3 ∣ 7 * n - 3 := h₉
          _ ∣ 7 * n     := by    suffices 3 * n ≥ 3 by omega
                          omega
      norm_num at h₁₀
    · rfl
  have h₉ : Nat.Coprime (7 * n - 3) 21 := by
    have h₉₁ : Nat.Coprime (7 * n - 3) 3 := h₈
    have h₉₂ : Nat.Coprime (7 * n - 3) 7 := h₇
    have h₉₃ : 21 = 3 * 7 := by norm_num
    rw [h₉₃]
    have h₁₀ : Nat.Coprime (7 * n - 3) (3 * 7) := by
      exact Nat.Coprime.mul_right h₉₁ h₉₂
    exact h₁₀
  -- We have gcd (21 * n + 4) 14 = gcd (7 * n + 2 * 7) 14 = gcd (7 * n + 14 + 2 * 7) 14 = gcd (7 * (n + 2) + 14) 14 = 7 gcd (n + 2) 2.
  have h₁₀ : Nat.gcd (21 * n + 4) 14 = 7 * (Nat.gcd (n + 2) 2) := by
    calc
      Nat.gcd (21 * n + 4) 14 = Nat.gcd (7 * n + 2 * 7) 14 := by norm_num
      _ = Nat.gcd (7 * n + 14 + 2 * 7) 14 := by norm_num
      _ = Nat.gcd (7 * (n + 2) + 14) 14 := by norm_num
      _ = 7 * (Nat.gcd (n + 2) 2) := by
        rw [show 14 = 7 * 2 by norm_num]
        exact Nat.gcd_mul_left_add_left 7 (n + 2) 14
  -- We have gcd (21 * n + 4) 7 = gcd (7 * n + 7 + 7) 7 = gcd (7 * (n + 1) + 7) 7 = 7 gcd (n + 1) 1.
  have h₁₁ : Nat.gcd (21 * n + 4) 7 = 7 * (Nat.gcd (n + 1) 1) := by
    calc
      Nat.gcd (21 * n + 4) 7 = Nat.gcd (7 * n + 7 + 7) 7 := by norm_num
      _ = Nat.gcd (7 * (n + 1) + 7) 7 := by norm_num
      _ = 7 * (Nat.gcd (n + 1) 1) := by
        rw [show 7 = 7 * 1 by norm_num]
        exact Nat.gcd_mul_left_add_left 7 (n + 1) 7
  -- We have gcd (21 * n + 4) 21 = 7 gcd (n + 2) 2.
  have h₁₂ : Nat.gcd (21 * n + 4) 21 = 7 * (Nat.gcd (n + 2) 2) := by
    calc
      Nat.gcd (21 * n + 4) 21 = Nat.gcd (21 * n + 7 + 4) 21 := by norm_num
      _ = Nat.gcd (21 * (n + 1) + 4) 21 := by norm_num
      _ = 7 * (Nat.gcd (n + 2) 2) := by
        rw [show 21 = 7 * 3 by norm_num]
        refine Eq.symm (Nat.gcd_mul_left_add_left 7 (n + 2) 4)
  -- We have gcd (21 * n + 4) 14 = gcd (21 * n + 4) 21.
  have h₁₃ : Nat.gcd (21 * n + 4) 14 = Nat.gcd (21 * n + 4) 21 := by
    calc
      Nat.gcd (21 * n + 4) 14 = 7 * (Nat.gcd (n + 2) 2) := h₁₀
      _ = 7 * (Nat.gcd (n + 2) 2) := rfl
      _ = Nat.gcd (21 * n + 4) 21 := h₁₂.symm
  -- We have gcd (21 * n + 4) 21 = 7 gcd (n + 1) 1.
  have h₁₄ : Nat.gcd (21 * n + 4) 21 = 7 * (Nat.gcd (n + 1) 1) := h₁₁
  -- We have gcd (21 * n + 4) 14 = 7 gcd (n + 1) 1.
  have h₁₅ : Nat.gcd (21 * n + 4) 14 = 7 * (Nat.gcd (n + 1) 1) := by
    rw [h₁₃, h₁₁]
  -- We have gcd (21 * n + 4) 7 = gcd (21 * n + 4) 14, so gcd (21 * n + 4) 7 = 7 gcd (21 * n + 4) 14.
  have h₁₆ : Nat.gcd (21 * n + 4) 7 = Nat.gcd (21 * n + 4) 14 := by
    calc
      Nat.gcd (21 * n + 4) 7 = 7 * (Nat.gcd (n + 1) 1) := h₁₁
      _ = 7 * (Nat.gcd (n + 2) 2) := by rw [show n + 1 = n + 2 - 1 by norm_num]
      _ = 7 * (Nat.gcd (n + 2) 2) := rfl
      _ = Nat.gcd (21 * n + 4) 14 := h₁₀.symm
  -- We have gcd (21 * n + 4) 7 = 7 gcd (n + 1) 1, so gcd (21 * n + 4) 14 = 7 gcd (n + 1) 1.
  have h₁₇ : Nat.gcd (21 * n + 4) 14 = 7 * (Nat.gcd (n + 1) 1) := by
    calc
      Nat.gcd (21 * n + 4) 14 = Nat.gcd (21 * n + 4) 7 := h₁₆
      _ = 7 * (Nat.gcd (n + 1) 1) := h₁₁
  -- We have gcd (21 * n + 4) 14 = 7 gcd (n + 1) 1 and gcd (21 * n + 4) 14 = 7 gcd (n + 2) 2, so 7 gcd (n + 1) 1 = 7 gcd (n + 2) 2.
  have h₁₈ : 7 * (Nat.gcd (n + 1) 1) = 7 * (Nat.gcd (n + 2) 2) := by
    rw [h₁₅, h₁₇]
  -- We have gcd (n + 1) 1 = gcd (n + 2) 2.
  have h₁₉ : Nat.gcd (n + 1) 1 = Nat.gcd (n + 2) 2 := by
    suffices Nat.gcd (n + 1) 1 = 1 by omega
    suffices Nat.gcd (n + 2) 2 = 1 by exact this
    suffices Odd (n + 2) by exact Nat.gcd_odd_left (n + 2) (by omega)
    rcases Nat.even_or_odd (n + 1) with h₆ | h₆
    · have h₂₀ : Even (n + 2) := by
        refine Nat.even_add_one.mpr?_
        exact h₆
      exact even_iff_two_dvd.mp h₂₀
    · have h₂₀ : Odd (n + 2) := by
        refine Nat.odd_add_one.mpr?_
        exact h₆
      exact h₂₀
  -- We have gcd (21 * n + 4) 14 = 7 gcd (n + 1) 1.
  have h₂₀ : Nat.gcd (21 * n + 4) 14 = 7 * (Nat.gcd (n + 1) 1) := h₁₅
  rw [h₁₉] at h₂₀
  -- We have gcd (21 * n + 4) 14 = 7.
  have h₂₁ : Nat.gcd (21 * n + 4) 14 = 7 := by
    rw [h₂₀]
    refine mul_one.trans?_
    decide
  -- We have gcd (21 * n + 4) (14 * n + 3) = gcd (21 * n + 4) 14 = 7.
  have h₂₂ : Nat.gcd (21 * n + 4) (14 * n + 3) = 7 := by
    calc
      Nat.gcd (21 * n + 4) (14 * n + 3) = Nat.gcd (21 * n + 4) (14 * n + 3 - (14 * n + 3) % 7) := by
        exact Nat.gcd_self_sub_mod_right (21 * n + 4) (14 * n + 3)
      _ = Nat.gcd (21 * n + 4) 0 := by
        refine Nat.gcd_eq_left_add_left?_
        omega
      _ = 21 * n + 4 := by
        exact Nat.gcd_zero_right (21 * n + 4)
      _ = 7 := h₂₁
  -- We have gcd (21 * n + 4) (14 * n + 3) = 1, as required.
  exact h₂₂.symm

```