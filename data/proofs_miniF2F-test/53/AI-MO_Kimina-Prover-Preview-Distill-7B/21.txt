-- We can multiply both sides by 2 to get
  -- 2(21n + 4) = 42n + 8 = 3(14n + 3) + 5
  have h₁ : 2 * (14 * n + 3) = 3 * (21 * n + 4) + 5 := by linarith

  -- Thus, 2(21n + 4) ≡ 5 (mod 3)
  -- Which implies 21n + 4 ≡ 2 (mod 3)
  have h₂ : 2 * (21 * n + 4) ≡ 5 [MOD 3] := by
    rw [<-h₁]
    apply Nat.ModEq.mul_left 2
    apply Nat.ModEq.add_right
    apply Nat.modEq_iff_dvd.mpr
    omega

  -- Since 21n + 4 ≡ 2 (mod 3),
  -- 3 ∤ 21n + 4
  have h₃ : ¬ 3 ∣ (21 * n + 4) := by
    by_contra! h₃
    have := Nat.ModEq.dvd h₂ h₃
    omega

  -- We can also multiply both sides by 3 to get
  -- 3(14n + 3) = 42n + 9 = 2(21n + 4) + 1
  have h₄ : 3 * (14 * n + 3) = 2 * (21 * n + 4) + 1 := by linarith

  -- Thus, 3(14n + 3) ≡ 1 (mod 2)
  -- Which implies 14n + 3 ≡ 1 (mod 2)
  have h₅ : 3 * (14 * n + 3) ≡ 1 [MOD 2] := by
    rw [<-h₄]
    apply Nat.ModEq.mul_left 3
    apply Nat.ModEq.add_right
    apply Nat.modEq_iff_dvd.mpr
    omega

  -- Since 14n + 3 ≡ 1 (mod 2),
  -- 2 ∤ 14n + 3
  have h₆ : ¬ 2 ∣ (14 * n + 3) := by
    by_contra! h₆
    have := Nat.ModEq.dvd h₅ h₆
    omega

  -- Therefore, gcd(21n + 4, 14n + 3) = gcd(21n + 4, 3) = gcd(3, 21n + 4 % 3)
  -- Since 21n + 4 ≡ 2 (mod 3), 3 ∤ 21n + 4,
  -- gcd(3, 21n + 4 % 3) = gcd(3, 2) = 1
  have h₇ : Nat.gcd (21 * n + 4) (14 * n + 3) = Nat.gcd (21 * n + 4) 3 := by
    have : 21 * n + 4 = (21 * n + 1) + 3 := by omega
    rw [this, Nat.gcd_add_mul_right_right]
    suffices h₈ : 21 * n + 1 ≡ 0 [MOD 3] by apply Nat.dvd_of_mod_eq_zero at h₈; rw [h₈]
    rw [Nat.modEq_iff_dvd]
    omega
  rw [h₇]
  rw [Nat.gcd_comm, Nat.gcd_div_iff_dvd]
  omega
  apply h₃
  -- Alternatively, we can multiply both sides by 7 to get
  -- 7(14n + 3) = 98n + 21 = 3(21n + 4) + 1
  have h₈ : 7 * (14 * n + 3) = 3 * (21 * n + 4) + 1 := by linarith
  -- Thus, 7(14n + 3) ≡ 1 (mod 3)
  -- Which implies 14n + 3 ≡ 1 (mod 3)
  have h₉ : 7 * (14 * n + 3) ≡ 1 [MOD 3] := by
    rw [<-h₈]
    apply Nat.ModEq.mul_left 7
    apply Nat.ModEq.add_right
    apply Nat.modEq_iff_dvd.mpr
    omega
  -- Since 14n + 3 ≡ 1 (mod 3),
  -- 3 ∤ 14n + 3
  have h₁₀ : ¬ 3 ∣ (14 * n + 3) := by
    by_contra! h₁₀
    have := Nat.ModEq.dvd h₉ h₁₀
    omega
  apply Nat.Coprime.gcd_eq_one
  show Nat.Coprime (21 * n + 4) 3
  apply Nat.coprime_iff_gcd_eq_one.mp
  apply Nat.Coprime.mul_right_right
  apply Nat.coprime_iff_gcd_eq_one.mpr
  -- Therefore, gcd(21n + 4, 3) = gcd(3, 21n + 4 % 3)
  -- Since 21n + 4 ≡ 1 (mod 3), 3 ∤ 21n + 4,
  -- gcd(3, 21n + 4 % 3) = gcd(3, 1) = 1
  have h₁₁ : Nat.gcd (14 * n + 3) 3 = Nat.gcd 3 1 := by
    have : 14 * n + 3 = (14 * n + 1) + 2 := by omega
    rw [this, Nat.gcd_add_mul_left_left]
    suffices h₁₂ : 14 * n + 1 ≡ 0 [MOD 2] by apply Nat.dvd_of_mod_eq_zero at h₁₂; rw [h₁₂]
    rw [Nat.modEq_iff_dvd]
    omega
  rw [h₁₁]
  rw [Nat.gcd_comm, Nat.gcd_div_iff_dvd]
  omega
  apply h₁₀
```