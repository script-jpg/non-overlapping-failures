-- We need to prove that $21n+4$ and $14n+3$ are coprime for every natural number $n$.
  -- We use the Euclidean algorithm.
  have h₁ : n.gcd (14 * n + 3) = n.gcd (21 * n + 4) := by
    -- swap the arguments of gcd
    rw [Nat.gcd_assoc]
    -- linear transformation of arguments of gcd
    rw [Nat.gcd_sub_mod, show 21*n+4 = 21*n+4-3*(14*n+3)+3*(14*n+3) by omega, <-Nat.gcd_add_mul_right_right]
    -- the remainder is 0, so gcd doesn't change.
    rw [Nat.gcd_zero_left]

  -- Now we only need to show that $n$ and $14n+3$ are coprime.
  replace h₀ : 0 < n := by omega
  have h₂ : n.gcd (14 * n + 3) = n.gcd 3 := by
    -- swap the arguments of gcd
    rw [Nat.gcd_assoc]
    -- linear transformation of arguments of gcd
    rw [Nat.gcd_sub_mod, show 14*n+3 = 14*n+3-2*n*7+2*n*7 by omega, <-Nat.gcd_add_mul_right_right]
    -- the remainder is 0, so gcd doesn't change.
    rw [Nat.gcd_zero_left]

  -- $n$ and $3$ are coprime if and only if $n$ is not a multiple of $3$.
  replace h₀ : 0 < n := by omega
  have h₃ : n.gcd 3 = 1 ↔ 3 ∤ n := by
    constructor
    · rw [Nat.coprime_iff_gcd_eq_one, Nat.gcd_eq_iff]
      norm_num
      omega
    · simp [Nat.coprime_iff_gcd_eq_one, Nat.gcd_eq_iff]
      omega

  -- So we only need to show that $3$ does not divide $n$.
  suffices 3 ∤ n by
    rw [h₁, h₂, h₃] at this
    exact this

  -- Assume on the contrary that $3$ divides $n$.
  by_contra h
  -- Then $3$ divides $21n+4$, which is a contradiction.
  replace h : 3 ∣ 21 * n + 4 := by
    rw [<-h₀]
    omega

  omega

```