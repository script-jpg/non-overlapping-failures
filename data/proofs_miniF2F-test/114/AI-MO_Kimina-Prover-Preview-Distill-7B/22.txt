-- We find that $p(1) = 41$, $p(2) = 43$, $p(3) = 47$, $p(4) = 53$, $p(5) = 59$, $\ldots$ are all primes.
  have h2 : ∀ n < 5, p n = Nat.Prime (p n) := by
    intro n hn
    have : n = 1 ∨ n = 2 ∨ n = 3 ∨ n = 4 := by omega
    rcases this with (rfl | rfl | rfl | rfl) <;> simp [h₀]
    · norm_num
    · norm_num
    · norm_num
    · norm_num

  -- Conjecture that $p(n)$ is prime for all $n < 41$.
  have h3 : ∀ n < 41, p n = Nat.Prime (p n) := by
    intro n hn
    have : n < 5 ∨ 5 ≤ n := by omega
    rcases this with (h | h)
    · exact h2 n h
    · -- Assume on the contrary that $p(n) = ab$ with $a, b > 1$.
      exfalso
      have h4 : p n ≠ 1 := by
        rw [h₀]
        omega
      have h5 : p n = (n ^ 2 - n + 41) := by exact h₀ n
      rw [h5] at h4
      have h6 : n ^ 2 - n + 41 = (n - 5) * (n + 6) - 10 := by
        if h7 : 5 ≤ n then
          rw [← Nat.sub_add_comm]
          rw [show 41 = 5 * 8 + 1 by norm_num]
          rw [← Nat.add_sub_assoc]
          omega
        else
          rw [show 41 = 4 * 10 + 1 by norm_num]
          rw [← Nat.add_sub_assoc]
          omega
      rw [h6] at h4
      have h7 : (n - 5) * (n + 6) - 10 = a * b := by
        exact h4
      have h8 : (n - 5) * (n + 6) = a * b + 10 := by omega
      have h9 : n - 5 < a := by
        by_contra! h9
        have h10 : n - 5 ≥ a := by omega
        have h11 : (n - 5) * (n + 6) ≥ a * (n + 6) := by
          apply Nat.mul_le_mul_right
          exact h10
        have h12 : a * (n + 6) ≥ 11 * (n + 6) := by
          rw [show 11 = 10 + 1 by norm_num]
          apply Nat.add_le_add_right
          exact Nat.mul_le_mul_right h10 (n + 6)
        have h13 : 11 * (n + 6) > a * b + 10 := by
          rw [show a * b + 10 = a * b + 11 - 1 by omega]
          apply Nat.sub_lt_sub_right
          apply Nat.lt_add_of_pos_right
          norm_num
        rw [← h8] at h13
        have h14 : (n - 5) * (n + 6) > (n - 5) * (n + 6) := by
          linarith
        exact (Nat.ne_of_lt h14) h11
      have h15 : n + 6 < b := by
        by_contra! h15
        have h16 : n + 6 ≥ b := by omega
        have h17 : (n - 5) * (n + 6) ≥ (n - 5) * b := by
          apply Nat.mul_le_mul_left
          exact h16
        have h18 : (n - 5) * b ≥ (n - 5) * (n + 6) := by
          apply Nat.mul_le_mul_right
          exact Nat.le_of_lt_succ h16
        have h19 : (n - 5) * (n + 6) > (n - 5) * (n + 6) := by
          linarith
        exact (Nat.ne_of_lt h19) h17
      have h20 : a > 1 := by
        by_contra! h20
        have h21 : a = 1 := by omega
        rw [h21] at h7
        simp at h7
        have h22 : n - 5 = (n - 6) + 1 := by
          omega
        rw [h22, Nat.sub_add_cancel (Nat.le_of_lt_succ h)] at h7
        have h23 : n - 6 = (n - 7) + 1 := by
          omega
        rw [h23, Nat.sub_add_cancel (Nat.le_of_lt_succ h)] at h7
        have h24 : n - 7 = (n - 8) + 1 := by
          omega
        rw [h24, Nat.sub_add_cancel (Nat.le_of_lt_succ h)] at h7
        have h25 : n - 8 = (n - 9) + 1 := by
          omega
        rw [h25, Nat.sub_add_cancel (Nat.le_of_lt_succ h)] at h7
        have h26 : n - 9 = (n - 10) + 1 := by
          omega
        rw [h26, Nat.sub_add_cancel (Nat.le_of_lt_succ h)] at h7
        have h27 : n - 10 ≥ 0 := by omega
        have h28 : n - 10 = (n - 11) + 1 := by
          omega
        rw [h28, Nat.sub_add_cancel (Nat.le_of_lt_succ h)] at h7
        have h29 : n - 11 ≥ 0 := by omega
        have h30 : (n - 11) * (n + 6) ≥ 0 := by
          apply Nat.mul_nonneg
          omega
          omega
        have h31 : (n - 11) * (n + 6) ≤ 0 := by omega
        have h32 : (n - 11) * (n + 6) = 0 := by omega
        simp at h32
        have h33 : n - 11 = 0 := by
          apply Nat.mul_eq_zero.mp h32
          omega
        rw [h33] at h29
        omega
      have h21 : b > 1 := by
        by_contra! h21
        have h22 : b = 1 := by omega
        rw [h22] at h7
        simp at h7
        have h23 : n + 6 = (n + 5) + 1 := by omega
        rw [h23] at h7
        have h24 : n + 5 = (n + 4) + 1 := by omega
        rw [h24] at h7
        have h25 : n + 4 = (n + 3) + 1 := by omega
        rw [h25] at h7
        have h26 : n + 3 = (n + 2) + 1 := by omega
        rw [h26] at h7
        have h27 : n + 2 = (n + 1) + 1 := by omega
        rw [h27] at h7
        have h28 : n + 1 = n + 1 - 1 + 1 := by omega
        rw [h28] at h7
        have h29 : n + 1 - 1 = n := by
          omega
        rw [h29] at h7
        simp at h7
        have h30 : n - 5 ≥ 0 := by omega
        have h31 : (n - 5) * (n + 6) ≥ 0 := by
          apply Nat.mul_nonneg
          omega
          omega
        have h32 : (n - 5) * (n + 6) ≤ 0 := by omega
        have h33 : (n - 5) * (n + 6) = 0 := by omega
        simp at h33
        have h34 : n - 5 = 0 := by
          apply Nat.mul_eq_zero.mp h33
          omega
        rw [h34] at h30
        omega
      have h22 : a ≤ n - 5 := by
        by_contra! h22
        have h23 : n - 5 < a := by omega
        have h24 : n + 6 ≤ a := by
          omega
        have h25 : (n - 5) * (n + 6) < (n - 5) * (n + 6) := by
          linarith
        exact (Nat.ne_of_lt h25) h23
      have h23 : b ≤ n + 6 := by
        by_contra! h23
        have h24 : n + 6 < b := by omega
        have h25 : (n - 5) * (n + 6) < (n - 5) * (n + 6) := by
          linarith
        exact (Nat.ne_of_lt h25) h24
      have h24 : a * b ≤ (n - 5) * (n + 6) := by
        apply Nat.mul_le_mul
        exact h22
        exact h23
        omega
        omega
      have h25 : a * b + 10 ≤ (n - 5) * (n + 6) - 10 + 10 := by
        linarith
      rw [← h8] at h25
      have h26 : a * b + 10 ≤ a * b := by
        linarith
      have h27 : 10 ≤ 0 := by omega
      exact (Nat.ne_of_lt h27) h26
    omega
  -- Since $p(41) = 41^2 - 41 + 41 = 41^2$, we have $41 \mid p(41)$.
  have h4 : 41 ∣ p 41 := by
    rw [h₀]
    use 41
    omega
  -- Since $41 \mid p(41)$, $41 \mid \gcd(p(41), p(42))$.
  have h5 : 41 ∣ Nat.gcd (p 41) (p 42) := by
    have h42 : 41 ∣ p 42 := by
      rw [h₀]
      use 42
      omega
    exact Nat.dvd_gcd h4 h42
  -- Since $\gcd(p(n), p(n+1)) > 1$, $41 \leq n$.
  by_contra! h
  interval_cases n
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction
  · contradiction