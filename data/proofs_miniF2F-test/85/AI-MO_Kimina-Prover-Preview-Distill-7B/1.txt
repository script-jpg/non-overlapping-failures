-- Assume $2^n - 1$ is a prime number.
  -- We need to show that $n$ is also a prime number.

  -- Obviously, $n$ cannot be $1$ since $2^1 - 1 = 1$ is not a prime number.
  have h2 : n ≠ 1 := by
    intro h
    rw [h] at h₁
    norm_num at h₁

  -- Case 1: $n$ is even
  -- $n$ is even if $n$ is divisible by $2$.
  by_cases h : n % 2 = 0
  · -- If $n$ is even, then $2^n - 1$ is divisible by $2^2 - 1 = 3$.
    have h3 : 3 ∣ (2 ^ n - 1) := by
      suffices : 2 ^ 2 ∣ 2 ^ n
      · exact (Nat.sub_dvd_pow_sub_pow _ _ _).mpr this
      · rw [<-Nat.pow_mul]
        apply Nat.pow_dvd_pow
        omega
    -- $3$ is a prime number, so if $3$ divides $2^n - 1$, then $2^n - 1$ is not a prime number.
    have h4 : Nat.Prime 3 := by norm_num
    -- This is a contradiction!
    exact Nat.not_prime_mul (by norm_num) (by omega) at (Nat.dvd_prime h4).mp h3
  · -- Case 2: $n$ is odd
    -- We know that $n$ is odd if $n \equiv 1 \pmod{2}$.
    have h : n ≡ 1 [MOD 2] := by omega
    -- Assume $n$ is composite.
    -- To prove: if $n$ is composite, then $2^n - 1$ is not a prime number.
    by_contra! h5
    -- Since $n$ is composite, there exists $1 < a < n$ such that $n = ab$.
    obtain ⟨a, ha₁, ha₂, h₀⟩ := Nat.not_prime_iff_exists_dvd_lt.1 h5
    -- $a$ cannot be $1$ since $a > 1$.
    have ha₃ : 1 < a := by
      omega
    -- $a$ cannot be $n$ since $a < n$.
    have ha₄ : a < n := by
      omega
    -- replace $n$ with $a$ in `h₁`
    rw [h₀] at h₁
    -- $2^a - 1$ divides $2^n - 1$.
    have h6 : 2 ^ a - 1 ∣ 2 ^ n - 1 := by
      rw [<-Nat.pow_mul]
      apply Nat.pow_dvd_pow
      omega
    -- $1 < 2^a - 1 < 2^n - 1$ since $1 < a < n$.
    have h7 : 1 < 2 ^ a - 1 := by
      have : 2 ≤ 2 ^ a := by
        nth_rw 1 [<-Nat.pow_one 2]
        apply Nat.pow_le_pow_of_le_right
        omega
      omega
    have h8 : 2 ^ a - 1 < 2 ^ n - 1 := by
      apply Nat.sub_lt_sub_right
      apply Nat.pow_lt_pow_right
      omega
      omega
    -- If $2^a - 1$ divides $2^n - 1$ and $1 < 2^a - 1 < 2^n - 1$, then $2^n - 1$ is not a prime number.
    have h9 : ¬Nat.Prime (2 ^ n - 1) := by
      exact Nat.not_prime_mul (by omega) (by omega) h6
    -- This is a contradiction!
    exact h9 h₁
```