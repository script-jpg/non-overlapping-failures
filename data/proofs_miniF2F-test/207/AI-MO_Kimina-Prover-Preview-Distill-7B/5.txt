-- https://artofproblemsolving.com/wiki/index.php/2005_AIMEⅡ_Problems/Problem15

  -- Let $S_n = a \cdot x^n + b \cdot y^n$.

  -- Then $S_1 = 3$, $S_2 = 7$, $S_3 = 16$, $S_4 = 42$, and we want to find $S_5$.

  -- Observe that $x \cdot S_{n-1} + y \cdot S_{n-2} = S_n$ if $x \neq y$.

  have : x * S 1 + y * S 2 = S 3 := by
    simp [S, h₀, h₁, h₂]
    ring

  have : x * S 2 + y * S 3 = S 4 := by
    simp [S, h₁, h₂, h₃]
    ring

  have : x * S 3 + y * S 4 = S 5 := by
    simp [S, h₂, h₃]
    ring

  -- Then $x \cdot S_2 + y \cdot S_1 = S_3$ and $x \cdot S_3 + y \cdot S_2 = S_4$.

  -- We obtain a system of equations.

  -- We can solve for $x+y$ and $xy$.

  have : x + y = 4 := by
    have : (x + y) * (42 * x - 16 * y) = 42 * (x * y) - 16 * (x * y) := by
      ring
    simp [← this] at *
    linarith

  have : x * y = -1 / 2 := by
    have : x * y * (4 * x - 4 * y) = 42 * (x * y) - 16 * (x * y) := by
      ring
    simp [← this] at *
    linarith

  -- Then $x$ and $y$ are the roots of $t^2 - 4t - \frac{1}{2} = 0$.

  have : x^2 - 4 * x - 1 / 2 = 0 := by
    ring_nf
    rw [← this, ← this]
    ring
  have : y^2 - 4 * y - 1 / 2 = 0 := by
    ring_nf
    rw [← this, ← this]
    ring

  -- We can use the quadratic formula to find $x$ and $y$.

  -- But it is not necessary to do so.

  -- Notice that $x \cdot S_4 + y \cdot S_5 = S_6$.

  -- We can solve for $S_5$.

  have : x * S 4 + y * S 5 = S 6 := by
    simp [S]
    ring

  have : S 6 = 47 * (x * y) - 16 * (x * y) := by
    rw [this, h₃, h₂, this, h₁, h₀]
    ring

  -- Then $S_5 = \boxed{020}$.

  rw [h₃, this]
  linarith
```