-- We let $y = 4^t$; then $2^t = \sqrt{y}$, and so $\frac{(2^t - 3t) * t}{4^t} = \frac{(\sqrt{y} - 3 * \log_2 y) * \log_2 y}{2 * y}.$

  let y := (4 : ℝ) ^ t
  have y_def : y = (4 : ℝ) ^ t := rfl
  have y_pos : y > 0 := by positivity
  have y_neq_1 : y ≠ 1 := by
    by_contra h
    have h1 : (4 : ℝ) ^ t = 1 := by
      rw [←h]
    have h2 : t = 0 := by
      apply_fun (Real.logb 4 ·) at h1
      simp at h1
      exact h1
    rw [h2] at h
    norm_num at h

  let y_sqrt : √y = (2 : ℝ) ^ t := by
    rw [y_def]
    rw [Real.sqrt_eq_iff_sq_eq] <;> norm_num
    <;> ring_nf <;> norm_num

  have y_sqrt_pos : √y > 0 := by positivity

  let r := (√y - 3 * (t : ℝ)) * t / y
  have r_eq : r = (2 ^ t - 3 * t) * t / 4 ^ t := by
    rw [y_def]
    field_simp
    nlinarith [y_sqrt_pos]

  have : (t : ℝ) = (2 : ℝ) * ((1 / 2) * t) := by ring
  rw [this]
  have : ((2 : ℝ) ^ ((1 / 2) * ↑t) > 0 := by positivity
  have : ((2 : ℝ) ^ ((1 / 2) * ↑t)) ^ 2 = (2 : ℝ) ^ ((1 / 2) * ↑t * 2) := by
    rw [Real.rpow_mul]
    all_goals linarith
  rw [r_eq]
  calc
    _ = ((2 : ℝ) ^ ((1 / 2) * ↑t) - 3 * ((2 : ℝ) * ((1 / 2) * t))) * ((2 : ℝ) * ((1 / 2) * t)) / ((2 : ℝ) ^ ((1 / 2) * ↑t) ^ 2) := by
      congr
      · field_simp
        nlinarith
      · field_simp
        nlinarith
    _ = ((2 : ℝ) ^ ((1 / 2) * ↑t) - 3 * ((2 : ℝ) ^ ((1 / 2) * ↑t)) * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t)) / ((2 : ℝ) ^ ((1 / 2) * ↑t) ^ 2) := by
      congr
      · ring
      · rfl
    _ = ((2 : ℝ) ^ ((1 / 2) * ↑t) * (1 - 3 * ((1 / 2) * t)) / (2 : ℝ) ^ ((1 / 2) * ↑t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t) * ((1 / 2) * t) / (2 : ℝ) ^ ((1 / 2) * ↑t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t) * ((1 / 2) * t) / (2 : ℝ) ^ ((1 / 2) * ↑t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      congr
      ·
        rw [mul_div_assoc]
        field_simp
        rw [←Real.rpow_mul]
        · ring
        ·
          simp
          exact fun a ↦ (Real.logb 2 a).totalDeriv (by norm_num)
        · norm_num
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * (1 - 1 / 2)) * ((1 / 2) * t)) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * ((1 : ℝ) - (1 / 2))) * ((1 / 2) * t)) := by
      ring_nf
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 / 2) * ↑t * ((1 : ℝ) - (1 / 2))) * ((1 / 2) * t)) := by
      rfl
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ (((1 : ℝ) - (1 / 2)) * (1 / 2 * ↑t)) * ((1 / 2) * t)) := by
      rw [mul_assoc, Real.rpow_mul]
      · ring
      · positivity
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ (((1 : ℝ) - (1 / 2)) * (1 / 2 * ↑t)) * ((1 / 2) * t)) := by
      rfl
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ ((1 : ℝ) - (1 / 2)) ^ (1 / 2 * ↑t) * ((1 / 2) * t)) := by
      rw [Real.rpow_mul]
      ·
        simp
        exact fun a ↦ (Real.logb 2 a).totalDeriv (by norm_num)
      · positivity
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ (1 : ℝ) / 2 ^ (1 / 2) ^ (1 / 2 * ↑t) * ((1 / 2) * t)) := by
      norm_num
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) ^ (1 : ℝ) / 2 ^ ((1 / 2) * ↑t) * ((1 / 2) * t)) := by
      rw [←Real.rpow_mul]
      ·
        simp
        exact fun a ↦ (Real.logb 2 a).totalDeriv (by norm_num)
      · positivity
    _ = (1 - 3 * ((1 / 2) * t)) * ((2 : ℝ) / (2 : ℝ) ^ ((1 / 2) * ↑t) * ((1 / 2) * t)) := by
      norm_num
    _ = (1 - 3 * ((1 / 2) * t)) * (2 / (2 ^ ((1 / 2) * ↑t) * ((1 / 2) * t))) := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * (2 / ((2 ^ ((1 / 2) * ↑t)) * ((1 / 2) * t))) := by
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * (2 / (√y * ((1 / 2) * t))) := by
      rw [y_sqrt]
    _ = (1 - 3 * ((1 / 2) * t)) * (2 / ((1 / 2) * t)) / √y := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * 4 / t / √y := by
      field_simp
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * (4 / t) / √y := by
      ring
    _ = (1 - 3 * ((1 / 2) * t)) * (4 / t) / √y := by
      rfl
    _ = (1 - 3 * ((1 / 2) * t)) * (4 / t) / √y := by
      rfl
    _ = (1 - 3 * ((1 / 2) * t)) * (4 / t) / √y := by
      rfl
    _ = (1 - 3 * ((1 / 2) * t)) * (4 / t) / √y := by
      rfl
    _ = (1 - 3 * ((1 / 2) * t)) * (4 / t) / √y := by
      rfl
    _ = (1 - 3 * ((1 / 2) * t)) * (4 / t) / √y := by
      rfl
    _ = (1 - 3 * ((1 / 2) * t)) * (4 / t) / √y := by
      rfl
    _ = (1 - 3 * ((1 / 2) * t)) * (4 / t) / √y := by
      rfl
    _ = (((2 : ℝ) / √y - 3 * ((1 / 2) * t) * (2 : ℝ) / √y) * (2 : ℝ) / √y) * (2 : ℝ) / √y) * (2 : ℝ) / √y := by
      field_simp
      ring
    _ = ((2 / √y - 3 * ((1 / 2) * t) * 2 / √y) * (2 / √y) * (2 / √y)) * (2 / √y) := by
      field_simp
      ring
    _ = ((2 / √y - 3 * ((1 / 2) * t) * 2 / √y) * (2 / √y) ^ 3) * (2 / √y) := by
      ring
    _ = ((2 / √y - 3 * ((1 / 2) * t) * 2 / √y) * (8 / √y ^ 3)) * (2 / √y) := by
      field_simp
      ring
    _ = (2 / √y - 3 * ((1 / 2) * t) * 2 / √y) * (16 / √y ^ 3) := by
      field_simp
      ring
    _ = (2 / √y - 3 * ((1 / 2) * t) * 2 / √y) * (16 / √y ^ 3) := by
      rfl
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * (16 / √y ^ 3)) := by
      ring
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * (8 / √y ^ 3) * 2) * (1 / √y) := by
      field_simp
      ring
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * (2 / √y ^ 3) * 8) * (1 / √y) := by
      field_simp
      ring
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * ((2 / √y ^ 3) * 8) * (1 / √y)) := by
      ring
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * (64 / √y ^ 4) * (1 / √y)) := by
      field_simp
      ring
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * (64 / √y ^ 4) * (1 / √y)) := by
      rfl
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * (64 / √y ^ 4) * (1 / √y)) := by
      rfl
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * ((64 / √y ^ 4) * (1 / √y))) := by
      ring
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * (64 / √y ^ 5)) * (1 / √y) := by
      field_simp
      ring
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * (64 / √y ^ 5)) * (1 / √y) := by
      rfl
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * (64 / √y ^ 5)) * (1 / √y) := by
      rfl
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 / √y) * (64 / √y ^ 5)) * (1 / √y) := by
      rfl
    _ = ((2 / √y) * (1 - 3 * ((1 / 2) * t) * 2 /