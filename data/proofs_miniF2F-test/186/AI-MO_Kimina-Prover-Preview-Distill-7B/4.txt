have h₄ : a * b * c * d = 40320 := by simp [h₀]
  have h₅ : a * b = 524 - a - b := by omega
  have h₆ : b * c = 146 - b - c := by omega
  have h₇ : c * d = 104 - c - d := by omega

  have h₈ : a * b * c = 524 * c - c ^ 2 - 524 * b - b ^ 2 + b * c + a * b + b * c + c ^ 2 :=
    calc
      _ = (a * b + a + b) * c := by rw [h₁]
      _ = (524 - a - b) * c := by rw [h₅]
      _ = 524 * c - a * c - b * c := by rw [mul_sub, mul_sub]
      _ = 524 * c - c ^ 2 - 524 * b - b ^ 2 + b * c + (a * b + a + b) + (b * c + b + c) - a * c + c ^ 2 :=
        by rw [h₁, h₆]; ring
      _ = _ := by ring
  subst a * b * c

  have h₉ : (a - d) * (b - c) = 576 := by
    calc
      _ = (a * b - b * c) * (a - d) - (a * d - b * c) * (b - c) := by ring
      _ = (524 - a * b - b * c) * (a - d) - (a * d - b * c) * (b - c) := by rw [h₅]
      _ = (524 - (a * b + b * c)) * (a - d) - (a * d - b * c) * (b - c) := by ring
      _ = (524 - (a * b + b * c) - a * d + b * c) * (a - d) - (a * d - b * c) * (b - c) := by ring
      _ = (524 - 146 - a * d + b * c) * (a - d) - (a * d - b * c) * (b - c) := by rw [h₆]
      _ = (524 - 146 - (a * d - b * c)) * (a - d) - (a * d - b * c) * (b - c) := by ring
      _ = (524 - 146 - (a * d - b * c) - b * c + b * c) * (a - d) - (a * d - b * c) * (b - c) := by ring
      _ = (524 - 146 - b * c) * (a - d) - (a * d - b * c) * (b - c) := by rw [h₆]
      _ = (524 - 146 - (a * d - b * c) + (a * d - b * c)) * (a - d) - (a * d - b * c) * (b - c) := by ring
      _ = 524 * (a - d) - (a * d - b * c) * (a - d + b - c) := by ring
      _ = 524 * (a - d) - (a * d - b * c) * (a - d + b - c) - (a * d * c - b * c ^ 2 + a * d - b * c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d * c - b * c ^ 2 + a * d - b * c) + (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) - (a * d - b * c) * (a - d + b - c) + (a * d - b * c) * (a - d + b - c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by rw [←h₇, ←h₆]; ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a * d - b * c) * (a - d + b - c) + (a * d * c - b * c ^ 2 + a * d - b * c) := by ring
      _ = 524 * (a - d) - (a * d * c - b * c ^ 2 + a * d - b * c) * (a - d + b - c + 1) - (a *