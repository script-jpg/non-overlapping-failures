-- By AM-GM, we have...
  have h₄ : 4 * a ≥ a ^ 2 := by nlinarith
  have h₅ : 4 * b ≥ b ^ 2 := by nlinarith
  have h₆ : 4 * c ≥ c ^ 2 := by nlinarith
  have h₇ : 4 * d ≥ d ^ 2 := by nlinarith

  -- We have $a\leq 168$ and $d\leq 24$.
  have h₈ : a ≤ 168 := by nlinarith
  have h₉ : d ≤ 24 := by nlinarith

  -- We have $a>20$ and $d<24$.
  have h₁₀ : a > 20 := by nlinarith
  have h₁₁ : d < 24 := by nlinarith

  -- $a$ is a divisor of $8!$ and $a\in(20, 168]$
  have h₁₂ : a ∈ (divisors (8!)).filter (fun x => x ≤ 168 ∧ x > 20) := by
    simp
    refine ⟨⟨?_,?_⟩,?_⟩
    · exact (Nat.divisors_dvd (8!)).mpr h₀
    · exact h₈
    · exact h₁₀

  -- $d$ is a divisor of $8!$ and $d\in(0, 24)$
  have h₁₃ : d ∈ (divisors (8!)).filter (fun x => x < 24) := by
    simp
    refine ⟨⟨?_,?_⟩,?_⟩
    · exact (Nat.divisors_dvd (8!)).mpr h₀
    · exact h₉
    · exact h₁₁

  -- We have $a=24$ and $d=24$, so $a-d=0$.
  have h₁₄ : a = 24 := by
    -- It suffices to show that $a$ is a multiple of $24$ and $a<24$.
    suffices h₁₄ : 24 ∣ a ∧ a < 24 by omega
    apply And.intro
    · rw [dvd_iff_exists_eq_mul_right]
      -- If $a=24$, then $b=20$, which contradicts $a>20$.
      by_contra!
      simp [this] at h₁₀
    · exact h₁₁

  have h₁₅ : d = 24 := by
    -- It suffices to show that $d$ is a multiple of $24$ and $d>0$.
    suffices h₁₅ : 24 ∣ d ∧ d > 0 by omega
    apply And.intro
    · rw [dvd_iff_exists_eq_mul_right]
      by_contra!
      simp [this] at h₁₁
    · exact h₉

  omega
```