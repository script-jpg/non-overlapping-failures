-- aux lemma, if $a, b \ge 0$ and $a + b = 1$, then $ab \le \frac 1 4$.
  have l_0 (a b : NNReal) (h₀ : a + b = 1) : a * b ≤ 1 / 4 := by
    rw [show a * b = a * (1 - a) by rw [h₀]; ring]
    have : a * (1 - a) ≤ 1 / 4 := by
      have : 0 ≤ (1 - a) := by simp [h₀]
      have : (a - 1 / 2) ^ 2 ≥ 0 := by exact sq_nonneg (a - 1 / 2)
      linarith
    exact this

  -- aux lemma, if $a, b, c \ge 0$ and $a + b + c = 1$, then $a^2 b + a^2 c \le \frac 4 9$.
  have l_1 (a b c : NNReal) (h₀ : a + b + c = 1) : a ^ 2 * b + a ^ 2 * c ≤ 4 / 9 := by
    have : a ^ 2 * b + a ^ 2 * c = a ^ 2 * (b + c) := by ring
    rw [this, show b + c = 1 - a by rw [h₀]; ring]
    have : a ^ 2 * (1 - a) ≤ 4 / 9 := by
      have : 0 ≤ (1 - a) := by simp [h₀]
      have : (3 * a - 1) ^ 2 ≥ 0 := by exact sq_nonneg (3 * a - 1)
      linarith
    exact this

  -- aux lemma, if $a, b, c \ge 0$ and $a + b + c = 1$, then $a^3 b + a^3 c \le \frac 4 {27}$.
  have l_2 (a b c : NNReal) (h₀ : a + b + c = 1) : a ^ 3 * b + a ^ 3 * c ≤ 4 / 27 := by
    have : a ^ 3 * b + a ^ 3 * c = a ^ 3 * (b + c) := by ring
    rw [this, show b + c = 1 - a by rw [h₀]; ring]
    have : a ^ 3 * (1 - a) ≤ 4 / 27 := by
      have : 0 ≤ (1 - a) := by simp [h₀]
      have : (9 * a - 1) ^ 2 ≥ 0 := by exact sq_nonneg (9 * a - 1)
      linarith
    exact this

  -- aux lemma, if $a, b, c, d \ge 0$ and $a + b + c + d = 1$, then $a^2 b^2 + a^2 c^2 + a^2 d^2 \le \frac 1 4$.
  have l_3 (a b c d : NNReal) (h₀ : a + b + c + d = 1) : a ^ 2 * b ^ 2 + a ^ 2 * c ^ 2 + a ^ 2 * d ^ 2 ≤ 1 / 4 := by
    have : a ^ 2 * b ^ 2 + a ^ 2 * c ^ 2 + a ^ 2 * d ^ 2 = a ^ 2 * (b ^ 2 + c ^ 2 + d ^ 2) := by ring
    rw [this]
    have : b ^ 2 + c ^ 2 + d ^ 2 ≥ (b + c + d) ^ 2 / 3 := by
      have : (b - c) ^ 2 + (c - d) ^ 2 + (d - b) ^ 2 ≥ 0 := by exact add_nonneg (add_nonneg (sq_nonneg (b - c)) (sq_nonneg (c - d))) (sq_nonneg (d - b))
      linarith
    have : a ^ 2 * (b ^ 2 + c ^ 2 + d ^ 2) ≤ a ^ 2 * ((b + c + d) ^ 2 / 3) := by
      gcongr
    rw [show b + c + d = 1 - a by rw [h₀]; ring] at this
    have : a ^ 2 * ((1 - a) ^ 2 / 3) ≤ 1 / 4 := by
      have : 0 ≤ (1 - a) := by simp [h₀]
      have : (6 * a - 1) ^ 2 ≥ 0 := by exact sq_nonneg (6 * a - 1)
      linarith
    linarith

  -- aux lemma, if $a, b, c, d, e \ge 0$ and $a + b + c + d + e = 1$, then $a^2 b^2 c^2 + a^2 b^2 d^2 + a^2 b^2 e^2 \le \frac 4 {125}$.
  have l_4 (a b c d e : NNReal) (h₀ : a + b + c + d + e = 1) : a ^ 2 * b ^ 2 * c ^ 2 + a ^ 2 * b ^ 2 * d ^ 2 + a ^ 2 * b ^ 2 * e ^ 2 ≤ 4 / 125 := by
    have : a ^ 2 * b ^ 2 * c ^ 2 + a ^ 2 * b ^ 2 * d ^ 2 + a ^ 2 * b ^ 2 * e ^ 2 = a ^ 2 * b ^ 2 * (c ^ 2 + d ^ 2 + e ^ 2) := by ring
    rw [this]
    have : c ^ 2 + d ^ 2 + e ^ 2 ≥ (c + d + e) ^ 2 / 3 := by
      have : (c - d) ^ 2 + (d - e) ^ 2 + (e - c) ^ 2 ≥ 0 := by exact add_nonneg (add_nonneg (sq_nonneg (c - d)) (sq_nonneg (d - e))) (sq_nonneg (e - c))
      linarith
    have : a ^ 2 * b ^ 2 * (c ^ 2 + d ^ 2 + e ^ 2) ≤ a ^ 2 * b ^ 2 * ((c + d + e) ^ 2 / 3) := by
      gcongr
    rw [show c + d + e = 1 - a - b by rw [h₀]; ring] at this
    have : a ^ 2 * b ^ 2 * ((1 - a - b) ^ 2 / 3) ≤ 4 / 125 := by
      have : 0 ≤ (1 - a - b) := by simp [h₀]
      have : (15 * a * b - 2 * (a + b) - 1) ^ 2 ≥ 0 := by exact sq_nonneg (15 * a * b - 2 * (a + b) - 1)
      linarith
    linarith

  -- aux lemma, if $a, b, c, d, e, f \ge 0$ and $a + b + c + d + e + f = 1$, then $a^3 b^3 c^3 + a^3 b^3 d^3 + a^3 b^3 e^3 + a^3 b^3 f^3 \le \frac 8 {729}$.
  have l_5 (a b c d e f : NNReal) (h₀ : a + b + c + d + e + f = 1) : a ^ 3 * b ^ 3 * c ^ 3 + a ^ 3 * b ^ 3 * d ^ 3 + a ^ 3 * b ^ 3 * e ^ 3 + a ^ 3 * b ^ 3 * f ^ 3 ≤ 8 / 729 := by
    have : a ^ 3 * b ^ 3 * c ^ 3 + a ^ 3 * b ^ 3 * d ^ 3 + a ^ 3 * b ^ 3 * e ^ 3 + a ^ 3 * b ^ 3 * f ^ 3 = a ^ 3 * b ^ 3 * (c ^ 3 + d ^ 3 + e ^ 3 + f ^ 3) := by ring
    rw [this]
    have : c ^ 3 + d ^ 3 + e ^ 3 + f ^ 3 ≥ (c + d + e + f) ^ 3 / 4 := by
      have : (c - d) ^ 2 + (d - e) ^ 2 + (e - f) ^ 2 + (f - c) ^ 2 ≥ 0 := by exact add_nonneg (add_nonneg (add_nonneg (sq_nonneg (c - d)) (sq_nonneg (d - e))) (sq_nonneg (e - f))) (sq_nonneg (f - c))
      have : (c + d + e + f) ^ 3 = (c + d + e + f) * (c + d + e + f) * (c + d + e + f) := by ring
      rw [this]
      have : (c + d + e + f) * (c + d + e + f) * (c + d + e + f) ≤ 4 * (c ^ 3 + d ^ 3 + e ^ 3 + f ^ 3) := by
        linarith
      linarith
    have : a ^ 3 * b ^ 3 * (c ^ 3 + d ^ 3 + e ^ 3 + f ^ 3) ≤ a ^ 3 * b ^ 3 * ((c + d + e + f) ^ 3 / 4) := by
      gcongr
    rw [show c + d + e + f = 1 - a - b by rw [h₀]; ring] at this
    have : a ^ 3 * b ^ 3 * ((1 - a - b) ^ 3 / 4) ≤ 8 / 729 := by
      have : 0 ≤ (1 - a - b) := by simp [h₀]
      have : (27 * a * b - 2 * (a + b) - 1) ^ 2 ≥ 0 := by exact sq_nonneg (27 * a * b - 2 * (a + b) - 1)
      linarith
    linarith

  -- By Cauchy-Schwarz, we have $(\sum_{n=0}^{98} a_{n+1}^2 a_{n+2} + a_{100}^2 a_1)^2 \le (\sum_{n=0}^{99} a_{n+1}^2)(\sum_{n=0}^{99} a_{n+1}^2 a_{n+2}^2 + a_{100}^2)$.
  have h₁ : ((∑ x in Finset.range 99, a (x + 1) ^ 2 * a (x + 2)) + a 100 ^ 2 * a 1) ^ 2 ≤ (∑ x in Finset.range 100, a (x + 1) ^ 2) * (∑ x in Finset.range 100, a (x + 1) ^ 2 * a (x + 2) ^ 2 + a 100 ^ 2) := by
    let f : ℕ → ℝ := fun x => a (x + 1)
    let g : ℕ → ℝ := fun x => a (x + 2)
    let h : ℕ → ℝ := fun x => a (x + 100)
    have : ∑ x in Finset.range 99, a (x + 1) ^ 2 * a (x + 2) = ∑ x in Finset.range 99, f x * g x := by
      simp [f, g]
      rfl
    rw [this]
    have : ∑ x in Finset.range 100, a (x + 1) ^ 2 = ∑ x in Finset.range 100, f x ^ 2 := by
      simp [f]
      rfl
    rw [this]
    have : ∑ x in Finset.range 100, a (x + 1) ^ 2 * a (x + 2) ^ 2 = ∑ x in Finset.range 100, (f x * g x) ^ 2 := by
      simp [f, g]
      rfl
    rw [this]
    have : ∑ x in Finset.range 100, a (x + 100) ^ 2 = ∑ x in Finset.range 100, h x ^ 2 := by
      simp [h]
      rfl
    rw [this]

    have := Finset.sum_mul_sq_le_sq_mul_sq (Finset.range 100) f g h
    simp [Finset.sum_range_succ] at this
    linarith

  -- By the lemma, we have $\sum_{n=0}^{99} a_{n+1}^2 a_{n+2}^2 \le \frac 1 4$.
  have h₂ : ∑ x in Finset.range 100, a (x + 1) ^ 2 * a (x + 2) ^ 2 ≤ 1 / 4 := by
    have : ∑ x in Finset.range 100, a (x + 1) ^ 2 * a (x + 2) ^ 2 = ∑ x in Finset.range 100, (a (x + 1) * a (x + 2)) ^ 2 := by
      simp_rw [mul_pow]
      rfl
    rw [this]
    have : ∑ x in Finset.range 100, (a (x + 1) * a (x + 2)) ^ 2 ≤ ∑ x in Finset.range 100, (1 / 4) := by
      apply Finset.sum_le_sum
      intro i hi
      exact l_0 (a (i + 1) * a (i + 2)) (by norm_num)
    rw [Finset.sum_const] at this
    linarith

  -- Show that $\sum_{n=0}^{98} (a_{n+1}^2 a_{n+2} + a_{100}^2 a_1) < \frac{12}{25}$.
  have h₃ : (∑ x in Finset.range 99, a (x + 1) ^ 2 * a (x + 2)) + a 100 ^ 2 * a 1 < 12 / 25 := by
    by_contra! h₃
    nlinarith [h₀, h₂, h₃]

  exact h₃
```