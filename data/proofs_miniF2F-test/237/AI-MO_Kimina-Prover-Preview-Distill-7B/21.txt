obtain ⟨k, hk, h⟩ := h₁

  have hkpos : 0 < k := hk

  have hmid : 2 ^ k = (a + b ^ 2) * (b + a ^ 2) := h

  have hmul : 2 ^ k = (a + b ^ 2) * (b + a ^ 2) := h

  have ha : 0 < a := h₀.1

  have hb : 0 < b := h₀.2

  -- basic inequality

  have h2 : a * b ≤ a ^ 2 + b ^ 2 := by

    have h3 : (a + b) ^ 2 = a ^ 2 + 2 * a * b + b ^ 2 := by ring

    rw [show a ^ 2 + b ^ 2 = (a + b) ^ 2 - 2 * a * b by linarith] at *

    have h4 : (a - b) ^ 2 ≥ 0 := sq_nonneg (a - b)

    linarith

  -- $a + b \mid 2 ^ k$

  have h3 : a + b ∣ 2 ^ k := by

    rw [hmul]

    apply dvd_mul_right

  -- $a + b \mid 2 ^ k$, so there exists $t$ such that $2 ^ k = (a + b) * t$

  have h4 : ∃ t : ℕ, 2 ^ k = (a + b) * t := h3

  obtain ⟨t, ht⟩ := h4

  -- $2 ^ k \equiv 0 \pmod {a + b}$

  have h5 : 2 ^ k ≡ 0 [MOD (a + b)] := by

    rw [ht]

    exact Nat.modEq_zero_iff_dvd.mpr h3

  -- $2 ^ k \equiv 0 \pmod {a + b}$

  have h6 : 2 ^ (k - 1) * 2 ≡ 0 [MOD (a + b)] := by

    congr 1

    rw [Nat.modEq_zero_iff_dvd]

    rw [Nat.dvd_mul_left]

    exact Nat.pow_dvd_pow 2 (by omega) hkpos

  -- so $a + b \mid 2 ^ (k - 1)$

  replace h6 : a + b ∣ 2 ^ (k - 1) := by

    have h7 : 2 ^ (k - 1) * 2 ≡ 0 [MOD (a + b)] := by exact h6

    replace h7 : 2 ^ (k - 1) ≡ 0 [MOD (a + b)] := by

      have h8 : a + b \mid 2 ^ (k - 1) * 2 := by exact Nat.dvd_of_mod_eq_zero h7

      have h9 : a + b \nmid 2 ^ (k - 1) := by

        intro h9

        have h10 : 2 ^ (k - 1) * 2 ≡ 2 ^ (k - 1) * 1 [MOD (a + b)] := by

          nth_rw 2 [show 1 = 2 ^ 0 by norm_num]

          apply Nat.ModEq.mul_left

          apply Nat.ModEq.pow

          exact Nat.modEq_self 2 (a + b)

        have h11 : 2 ^ (k - 1) * 2 ≡ 2 ^ (k - 1) [MOD (a + b)] := by

          calc

            2 ^ (k - 1) * 2 ≡ 2 ^ (k - 1) * 1 [MOD (a + b)] := by exact h10

            _ ≡ 2 ^ (k - 1) [MOD (a + b)] := by congr 1; exact Nat.ModEq.rfl

        have h12 : 2 ^ (k - 1) ≡ 0 [MOD (a + b)] := by exact Nat.ModEq.symm (Nat.ModEq.trans (id (Nat.ModEq.symm h11)) h7)

        have h13 : ¬ 2 ^ (k - 1) ≡ 0 [MOD (a + b)] := by

          intro h13

          exact Nat.Prime.not_dvd_pow (Nat.prime_two) h9 h13

        contradiction

      exact Nat.dvd_of_mod_eq_zero h7

    apply Nat.dvd_of_mod_eq_zero at h6

    exact h6

  -- $a + b \mid 2 ^ (k - 1)$, so there exists $t$ such that $2 ^ (k - 1) = (a + b) * t$

  have h7 : ∃ t : ℕ, 2 ^ (k - 1) = (a + b) * t := h6

  obtain ⟨t, ht⟩ := h7

  -- $2 ^ (k - 1) < 2 ^ k$, so $a + b < 2 ^ (k - 1)$ or $a + b = 2 ^ (k - 1)$

  have h8 : a + b < 2 ^ (k - 1) ∨ a + b = 2 ^ (k - 1) := by

    by_cases h8 : a + b < 2 ^ (k - 1)

    · left; exact h8

    · right

      apply le_antisymm?_ h8

      have h9 : a + b ∣ 2 ^ (k - 1) := by exact h7

      replace h9 : a + b ≤ 2 ^ (k - 1) := by

        apply Nat.le_of_dvd

        · exact Nat.pos_pow_of_pos (by omega) (by omega)

        · exact h9

      linarith

  cases' h8 with h8 h8

  -- if $a + b < 2 ^ (k - 1)$, then $a + b \mid 2 ^ (k - 1)$ and $a + b \mid 2 ^ k$, so $a + b \mid 2 ^ (k - 1) - 2 ^ k$, which is impossible

  · have h9 : a + b ∣ 2 ^ (k - 1) := by exact h7

    have h10 : a + b ∣ 2 ^ k := by exact h3

    have h11 : a + b ∣ 2 ^ (k - 1) - 2 ^ k := by

      apply Nat.dvd_sub'

      · exact Nat.dvd_refl (2 ^ (k - 1))

      · exact Nat.dvd_pow 2 (by omega)

      · exact le_of_lt (Nat.pow_lt_pow_iff_right (by omega)).mpr h8

    have h12 : 2 ^ (k - 1) - 2 ^ k < 0 := by

      have h13 : 2 ^ k < 2 ^ (k - 1) := by exact Nat.pow_lt_pow_iff_right (by omega).mpr h8

      omega

    have h13 : 2 ^ (k - 1) - 2 ^ k ≠ 0 := by omega

    have h14 : a + b ∣ 0 := by

      rw [show 0 = 2 ^ (k - 1) - 2 ^ k - (2 ^ (k - 1) - 2 ^ k) by ring]

      apply Nat.dvd_sub

      · exact h11

      · exact Nat.dvd_refl (2 ^ (k - 1) - 2 ^ k)

    have h15 : a + b ≤ 0 := by exact Nat.le_of_dvd (by omega) h14

    have h16 : a + b > 0 := by exact Nat.add_pos_left hb ha

    linarith

  -- if $a + b = 2 ^ (k - 1)$, then $a + b \mid 2 ^ k$, so $a + b \mid 2 ^ k - 2 ^ (k - 1)$, which is impossible

  · have h9 : a + b ∣ 2 ^ k := by exact h3

    have h10 : a + b ∣ 2 ^ (k - 1) := by exact h7

    have h11 : a + b ∣ 2 ^ k - 2 ^ (k - 1) := by

      apply Nat.dvd_sub'

      · exact Nat.dvd_refl (2 ^ k)

      · exact Nat.dvd_pow 2 (by omega)

      · exact le_of_eq h8

    have h12 : 2 ^ k - 2 ^ (k - 1) = 2 ^ (k - 1) := by

      have h13 : k - 1 < k := by omega

      have h14 : 2 ^ (k - 1) * 2 = 2 ^ (k - 1) + 2 ^ (k - 1) := by omega

      rw [←h14]

      nth_rw 1 [show 2 ^ (k - 1) = 2 ^ (k - 1) * 1 by norm_num]

      apply Nat.pow_right_injective (by omega) h13

    have h13 : a + b ∣ 2 ^ (k - 1) := by

      rw [h12] at h11

      exact h11

    have h14 : a + b ≤ 2 ^ (k - 1) := by exact Nat.le_of_dvd (by omega) h13

    have h15 : a + b > 2 ^ (k - 1) := by exact Nat.lt_of_le_of_ne h14 h8

    linarith
```