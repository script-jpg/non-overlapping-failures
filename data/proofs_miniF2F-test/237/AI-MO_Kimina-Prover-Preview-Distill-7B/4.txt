obtain ⟨k, hk, h⟩ := h₁

  have hk' : 2 ^ k = (a * b) + (a ^ 3 + b ^ 3) + (a ^ 2 * b ^ 2) * (a + b) := by
    calc
      2 ^ k = (a + b) * (a + b ^ 2) * (b + a ^ 2) := by rw [h]
      _ = (a + b) * (a * b + (a ^ 2 + b ^ 2) * (a + b) + (a * b) ^ 2) := by nlinarith
      _ = (a * b) + (a ^ 3 + b ^ 3) + (a * b) ^ 2 * (a + b) := by nlinarith
      _ = (a * b) + (a ^ 3 + b ^ 3) + (a ^ 2 * b ^ 2) * (a + b) := by nlinarith

  have ha : a < 2 := by
    by_contra!

    by_cases ha' : 1 < a

    · nlinarith [show 2 ^ k > 2 ^ (2 : ℕ) by nlinarith]

    · have : a = 1 := by omega
      simp [this] at hk'

      have : 2 ^ (k - 1) = (1 + b ^ 2) * (b + 1) := by
        calc
          2 ^ (k - 1) = (1 + b) * (1 + b ^ 2) * (b + 1) := by rw [hk']; ring
          _ = (1 + b ^ 2) * (b + 1) := by nlinarith
      have h1 : 2 ^ (k - 1) > 2 ^ (1 : ℕ) := by
        apply Nat.lt_pow_succ_iff.mpr
        by_contra!
        have : k - 1 ≤ 1 := by
          refine Nat.sub_le_of_le_add?_?_
          · exact Nat.zero_le (a * b)
          · apply Nat.le_add_right_of_le?_
            exact Nat.le_refl b
        have : 2 ^ (k - 1) ≤ 2 ^ 1 := by
          refine Nat.pow_le_pow_iff_right?_ this
          exact Nat.zero_le b
        linarith
      obtain h2 := Nat.pow_le_pow_iff_right (by norm_num) (by omega)
      linarith

    · simp at ha'
      have : a = 0 := by omega
      simp [this] at h₀
  simp [show a = 1 by omega] at hk'

  have hb : b < 2 := by
    by_contra!

    by_cases hb' : 1 < b

    · nlinarith [show 2 ^ k > 2 ^ (2 : ℕ) by nlinarith]

    · have : b = 1 := by omega
      simp [this] at hk'

      have : 2 ^ (k - 1) = (1 + a ^ 2) * (a + 1) := by
        calc
          2 ^ (k - 1) = (1 + a) * (1 + a ^ 2) * (a + 1) := by rw [hk']; ring
          _ = (1 + a ^ 2) * (a + 1) := by nlinarith
      have h1 : 2 ^ (k - 1) > 2 ^ (1 : ℕ) := by
        apply Nat.lt_pow_succ_iff.mpr
        by_contra!
        have : k - 1 ≤ 1 := by
          refine Nat.sub_le_of_le_add?_?_
          · exact Nat.zero_le (a * b)
          · apply Nat.le_add_right_of_le?_
            exact Nat.le_refl a
        have : 2 ^ (k - 1) ≤ 2 ^ 1 := by
          refine Nat.pow_le_pow_iff_right?_ this
          exact Nat.zero_le a
        linarith
      obtain h2 := Nat.pow_le_pow_iff_right (by norm_num) (by omega)
      linarith

    · simp at hb'
      have : b = 0 := by omega
      simp [this] at h₀
  simp [show b = 1 by omega] at hk'

  obtain ha | ha := Nat.eq_zero_or_pos a
  · contradiction
  · obtain hb | hb := Nat.eq_zero_or_pos b
    · contradiction
    · simp_all
```