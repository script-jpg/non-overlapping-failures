obtain ⟨k, hk_pos, hk⟩ := h₁
  have h₂ : a = 1 := by
    have h₃ : a = 1 := by
      -- We will show that a = 1 by contradiction.
      by_contra! h
      have h₄ : a ≥ 2 := by omega
      have h₅ : 2 ^ k = (a + b ^ 2) * (b + a ^ 2) := hk
      have h₆ : (a + b ^ 2) * (b + a ^ 2) ≥ 2 * (b + a ^ 2) := by
        nlinarith [sq_nonneg (a - 1), sq_nonneg (b - 1), mul_pos (h₀.1) (h₀.2)]
      have h₇ : 2 ^ k ≥ 2 * (b + a ^ 2) := by linarith
      have h₈ : b + a ^ 2 ≥ 2 := by nlinarith [sq_nonneg (a - 1), sq_nonneg (b - 1), mul_pos (h₀.1) (h₀.2)]
      have h₉ : 2 ^ k ≥ 2 * 2 := by nlinarith
      have h₁₀ : k ≥ 2 := by
        by_contra! h₁₁
        have h₁₂ : k = 1 := by omega
        rw [h₁₂] at h₅
        nlinarith [sq_nonneg (a - 1), sq_nonneg (b - 1), mul_pos (h₀.1) (h₀.2)]
      have h₁₁ : 2 ^ k % 4 = 0 ∨ 2 ^ k % 4 = 2 := by
        cases k with
        | zero => omega
        | succ k' =>
          cases k' with
          | zero => omega
          | succ k'' =>
            simp [pow_succ, Nat.mul_mod, Nat.pow_mod]
            <;> omega
      have h₁₂ : (a + b ^ 2) * (b + a ^ 2) % 4 = 0 ∨ (a + b ^ 2) * (b + a ^ 2) % 4 = 2 := by omega
      have h₁₃ : a % 4 = 0 ∨ a % 4 = 1 ∨ a % 4 = 2 ∨ a % 4 = 3 := by omega
      have h₁₄ : b % 4 = 0 ∨ b % 4 = 1 ∨ b % 4 = 2 ∨ b % 4 = 3 := by omega
      rcases h₁₃ with (h₁₅ | h₁₅ | h₁₅ | h₁₅) <;> rcases h₁₄ with (h₁₆ | h₁₆ | h₁₆ | h₁₆) <;> simp [h₁₅, h₁₆, Nat.mul_mod, Nat.add_mod, Nat.pow_mod] at h₁₁ h₁₂ ⊢ <;> omega
    exact h₃
  exact h₂
```