have : Fact (Nat.Prime 2) := ⟨Nat.prime_two⟩

  have : Fact (Nat.Prime 3) := ⟨Nat.prime_three⟩

  have h₀ : 2 * 3 ∣ (n + 1) * (n + 2) := by

    apply Nat.Coprime.mul_dvd_of_dvd_of_dvd

    · exact Nat.coprime_two_three

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 1) % 2 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 2) % 3 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

  have h₁ : 6 ∣ (n + 1) * (n + 2) := by

    apply Nat.Coprime.mul_dvd_of_dvd_of_dvd

    · exact Nat.coprime_two_three

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 1) % 2 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 2) % 3 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

  have : 2 * 3 * 2 ∣ (n + 1) * (n + 2) * (n - 8 + 9) := by

    apply Nat.Coprime.mul_dvd_of_dvd_of_dvd

    · -- Show that 6 and 2 are coprime

      have h : Nat.Coprime 6 2 := by

        have h : Nat.Prime 2 := Nat.prime_two

        have k : 6 > 2 := by norm_num

        exact Nat.coprime_of_lt_prime h k

      exact h

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 1) % 2 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

    · rw [show n - 8 + 9 = n + 1 by omega]

      apply Nat.dvd_of_mod_eq_zero

      have : (n + 1) % 3 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

  have : ((n + 1) * (n + 2) * (n - 8 + 9)) / (6 * 2) = (n + 1) * (n + 2) * (n + 1) / 6 := by

    rw [show n - 8 + 9 = n + 1 by omega]

  rw [this]

  have : (6 * 2) ∣ (n + 1) * (n + 2) * (n + 1) := by

    apply Nat.dvd_mul_of_dvd_left

    apply Nat.dvd_of_mod_eq_zero

    have : (n + 1) % 2 = 0 := by omega

    rw [Nat.dvd_iff_mod_eq_zero] at this

    exact this

  have : 6 * 2 ∣ (n + 1) * (n + 2) * (n + 1) := by

    apply Nat.Coprime.mul_dvd_of_dvd_of_dvd

    · exact Nat.coprime_two_three

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 1) % 2 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 2) % 3 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

  have : ((n + 1) * (n + 2) * (n + 1) / 6) / 2 = ((n + 1) * (n + 2) * (n + 1) / (6 * 2)) := by

    rw [show ((n + 1) * (n + 2) * (n + 1) / 6) / 2 = ((n + 1) * (n + 2) * (n + 1)) / (6 * 2) by omega]

  rw [this]

  have : ((n + 1) * (n + 2) * (n + 1) / (6 * 2)) * ((n + 1) / 2) = ((n + 1) * (n + 2) * (n + 1) / (6 * 2)) ^ 2 := by

    rw [←pow_two, mul_pow]

    norm_num

    exact Nat.two_dvd_ne_zero.mp (by omega)

  apply @exists_eq_pow_two₀ ((n + 1) * (n + 2) * (n + 1) / (6 * 2)) / 2

  rw [show ((n + 1) * (n + 2) * (n + 1) / (6 * 2)) / 2 = ((n + 1) * (n + 2) * (n + 1) / 6) / 2 by omega]

  exact Eq.symm (Nat.div_div_of_dvd this (by omega))

  apply @Nat.dvd_mul_of_dvd_left _ ((n + 1) * (n + 2) * (n + 1) / (6 * 2))

  apply Nat.dvd_mul_of_dvd_right

  exact Nat.dvd_div_of_mul_dvd h₁

  exact Nat.dvd_div_of_mul_dvd h₀

  rw [show n + 1 + 1 = n + 2 by omega]

  apply Nat.dvd_add

  exact Nat.dvd_refl ((n + 1) * (n + 2) * (n + 1) / (6 * 2))

  have : 6 * 2 ∣ (n + 1) * (n + 2) * (n + 1) := by

    apply Nat.Coprime.mul_dvd_of_dvd_of_dvd

    · exact Nat.coprime_two_three

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 1) % 2 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 2) % 3 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

  exact Nat.div_dvd_of_dvd h₁

cases' (Nat.even_or_odd n) with h₀ h₀

· have h₁ : 2 ∣ n := by exact h₀

  have h₂ : 2 ∣ (n + 1) * (n + 2) := by

    apply Nat.dvd_mul_of_dvd_left

    apply Nat.dvd_of_mod_eq_zero

    rw [Nat.dvd_iff_mod_eq_zero]

    omega

  have h₃ : 4 ∣ (n + 1) * (n + 2) := by

    apply Nat.Coprime.mul_dvd_of_dvd_of_dvd

    · exact Nat.coprime_two_two

    · exact h₁

    · exact h₂

  have h₄ : 2 ∣ n + 1 := by exact Nat.even_add_one h₀

  have h₅ : 4 ∣ (n + 1) * (n + 2) := by

    apply Nat.Coprime.mul_dvd_of_dvd_of_dvd

    · exact Nat.coprime_two_three

    · exact h₄

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 2) % 2 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

  have h₆ : 4 ∣ (n + 1) * (n + 2) ∧ 4 ∣ n! := by

    exact ⟨h₃, h₅⟩

  rcases h₆ with ⟨h₃, h₅⟩

  have h₇ : 2 ∣ n! := by

    apply Nat.dvd_factorial

    omega

    exact h₅

  have h₈ : 4 ∣ (n + 1) * (n + 2) ∧ 4 ∣ n! := by

    exact ⟨h₃, h₇⟩

  rcases h₈ with ⟨h₃, h₇⟩

  apply Nat.Coprime.mul_dvd_of_dvd_of_dvd

  · exact Nat.coprime_two_two

  · exact h₃

  · exact h₇

· have h₁ : ¬(Nat.even n) := by exact h₀

  rw [Nat.not_even_iff_odd] at h₁

  have h₂ : 4 ∣ (n + 1) * (n + 2) := by

    apply Nat.Coprime.mul_dvd_of_dvd_of_dvd

    · exact Nat.coprime_two_three

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 1) % 2 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

    · apply Nat.dvd_of_mod_eq_zero

      have : (n + 2) % 3 = 0 := by omega

      rw [Nat.dvd_iff_mod_eq_zero] at this

      exact this

  have h₃ : 2 ∣ n + 1 := by exact Nat.even_add_one h₁

  have h₄ : 4 ∣ n! := by

    apply Nat.dvd_factorial

    omega

    exact h₃

  apply Nat.Coprime.mul_dvd_of_dvd_of_dvd

  · exact Nat.coprime_two_three

  · exact h₄

  · apply Nat.dvd_of_mod_eq_zero

    have : (n + 1) % 2 = 0 := by omega

    rw [Nat.dvd_iff_mod_eq_zero] at this

    exact this

```