have pge3 : 3 ≤ p := by linarith

  have pmod3 : p ≡ 0 [MOD 3] ∨ p ≡ 1 [MOD 3] ∨ p ≡ 2 [MOD 3] := by
    apply Nat.mod_three_cases

  have pmod4 : p ≡ 0 [MOD 4] ∨ p ≡ 1 [MOD 4] ∨ p ≡ 2 [MOD 4] ∨ p ≡ 3 [MOD 4] := by
    apply Nat.mod_four_cases

  have pmod6 : p ≡ 0 [MOD 6] ∨ p ≡ 1 [MOD 6] ∨ p ≡ 2 [MOD 6] ∨ p ≡ 3 [MOD 6] ∨ p ≡ 4 [MOD 6] ∨ p ≡ 5 [MOD 6] := by
    apply Nat.mod_six_cases

  have pmod12 : p ≡ 0 [MOD 12] ∨ p ≡ 1 [MOD 12] ∨ p ≡ 2 [MOD 12] ∨ p ≡ 3 [MOD 12] ∨ p ≡ 4 [MOD 12] ∨ p ≡ 5 [MOD 12] ∨ p ≡ 6 [MOD 12] ∨ p ≡ 7 [MOD 12] ∨ p ≡ 8 [MOD 12] ∨ p ≡ 9 [MOD 12] ∨ p ≡ 10 [MOD 12] ∨ p ≡ 11 [MOD 12] := by
    apply Nat.mod_12_cases

  have.two_le_p := by
    exact Nat.Prime.two_le h₀

  have psub2_ge2 : p - 2 ≥ 2 := by linarith

  have psub1_ge3 : p - 1 ≥ 3 := by linarith

  have psub1_ge2 : p - 1 ≥ 2 := by linarith

  -- This is to make use of the lemma Finset.sum_Icc_succ_top in the expansion of the summation.
  have psub1_le_p : p - 1 ≤ p := by
    exact Nat.sub_le_self p 1

  have psub2_le_p : p - 2 ≤ p := by
    exact Nat.sub_le_self p 2

  have psub1_lt_p : p - 1 < p := by
    exact Nat.sub_lt_self p (by linarith)

  have psub2_lt_p : p - 2 < p := by
    exact Nat.sub_lt_self p (by linarith)

  have invp1 : (p - 1 : ZMod p)ˣ⁻¹ = p - 1 := by
    have : (p - 1 : ZMod p)ˣ = ZMod.val ↦ p - 1 := by
      apply ZMod.val_injective
      simp
      rw [ZMod.val map_sub_of_val_le]
      simp
      linarith
    rw [this]
    apply ZMod.natCast_zmod_eq_self.mpr
    simp

  have invp2 : (p - 2 : ZMod p)ˣ⁻¹ = p - 2 := by
    have : (p - 2 : ZMod p)ˣ = ZMod.val ↦ p - 2 := by
      apply ZMod.val_injective
      simp
      rw [ZMod.val_map_sub, ZMod.val_ofNat]
      simp
      linarith
    rw [this]
    apply ZMod.natCast_zmod_eq_self.mpr
    simp

  -- The term $(p - 1)^{-1} \cdot p^{-1}$ is equal to $\frac{p-1}{p} \cdot \frac{p}{p-1} \equiv 1 \pmod{p}$.
  have h₄ : ((p - 1 : ZMod p)ˣ⁻¹ * (p : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 1) p (p - 2) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 2)^{-1} \cdot (p - 1)^{-1}$ is equal to $\frac{p-2}{p-1} \cdot \frac{p-1}{p-2} \equiv 1 \pmod{p}$.
  have h₅ : ((p - 2 : ZMod p)ˣ⁻¹ * (p - 1 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp2, invp1]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 2) p (p - 1) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 3)^{-1} \cdot (p - 2)^{-1}$ is equal to $\frac{p-3}{p-2} \cdot \frac{p-2}{p-3} \equiv 1 \pmod{p}$.
  have h₆ : ((p - 3 : ZMod p)ˣ⁻¹ * (p - 2 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 3) p (p - 2) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 4)^{-1} \cdot (p - 3)^{-1}$ is equal to $\frac{p-4}{p-3} \cdot \frac{p-3}{p-4} \equiv 1 \pmod{p}$.
  have h₇ : ((p - 4 : ZMod p)ˣ⁻¹ * (p - 3 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 4) p (p - 3) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 5)^{-1} \cdot (p - 4)^{-1}$ is equal to $\frac{p-5}{p-4} \cdot \frac{p-4}{p-5} \equiv 1 \pmod{p}$.
  have h₈ : ((p - 5 : ZMod p)ˣ⁻¹ * (p - 4 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 5) p (p - 4) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 6)^{-1} \cdot (p - 5)^{-1}$ is equal to $\frac{p-6}{p-5} \cdot \frac{p-5}{p-6} \equiv 1 \pmod{p}$.
  have h₉ : ((p - 6 : ZMod p)ˣ⁻¹ * (p - 5 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 6) p (p - 5) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 7)^{-1} \cdot (p - 6)^{-1}$ is equal to $\frac{p-7}{p-6} \cdot \frac{p-6}{p-7} \equiv 1 \pmod{p}$.
  have h₁₀ : ((p - 7 : ZMod p)ˣ⁻¹ * (p - 6 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 7) p (p - 6) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 8)^{-1} \cdot (p - 7)^{-1}$ is equal to $\frac{p-8}{p-7} \cdot \frac{p-7}{p-8} \equiv 1 \pmod{p}$.
  have h₁₁ : ((p - 8 : ZMod p)ˣ⁻¹ * (p - 7 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 8) p (p - 7) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 9)^{-1} \cdot (p - 8)^{-1}$ is equal to $\frac{p-9}{p-8} \cdot \frac{p-8}{p-9} \equiv 1 \pmod{p}$.
  have h₁₂ : ((p - 9 : ZMod p)ˣ⁻¹ * (p - 8 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 9) p (p - 8) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 10)^{-1} \cdot (p - 9)^{-1}$ is equal to $\frac{p-10}{p-9} \cdot \frac{p-9}{p-10} \equiv 1 \pmod{p}$.
  have h₁₃ : ((p - 10 : ZMod p)ˣ⁻¹ * (p - 9 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 10) p (p - 9) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 11)^{-1} \cdot (p - 10)^{-1}$ is equal to $\frac{p-11}{p-10} \cdot \frac{p-10}{p-11} \equiv 1 \pmod{p}$.
  have h₁₄ : ((p - 11 : ZMod p)ˣ⁻¹ * (p - 10 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 11) p (p - 10) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 12)^{-1} \cdot (p - 11)^{-1}$ is equal to $\frac{p-12}{p-11} \cdot \frac{p-11}{p-12} \equiv 1 \pmod{p}$.
  have h₁₅ : ((p - 12 : ZMod p)ˣ⁻¹ * (p - 11 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 12) p (p - 11) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 13)^{-1} \cdot (p - 12)^{-1}$ is equal to $\frac{p-13}{p-12} \cdot \frac{p-12}{p-13} \equiv 1 \pmod{p}$.
  have h₁₆ : ((p - 13 : ZMod p)ˣ⁻¹ * (p - 12 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 13) p (p - 12) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 14)^{-1} \cdot (p - 13)^{-1}$ is equal to $\frac{p-14}{p-13} \cdot \frac{p-13}{p-14} \equiv 1 \pmod{p}$.
  have h₁₇ : ((p - 14 : ZMod p)ˣ⁻¹ * (p - 13 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 14) p (p - 13) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 15)^{-1} \cdot (p - 14)^{-1}$ is equal to $\frac{p-15}{p-14} \cdot \frac{p-14}{p-15} \equiv 1 \pmod{p}$.
  have h₁₈ : ((p - 15 : ZMod p)ˣ⁻¹ * (p - 14 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 15) p (p - 14) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 16)^{-1} \cdot (p - 15)^{-1}$ is equal to $\frac{p-16}{p-15} \cdot \frac{p-15}{p-16} \equiv 1 \pmod{p}$.
  have h₁₉ : ((p - 16 : ZMod p)ˣ⁻¹ * (p - 15 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 16) p (p - 15) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 17)^{-1} \cdot (p - 16)^{-1}$ is equal to $\frac{p-17}{p-16} \cdot \frac{p-16}{p-17} \equiv 1 \pmod{p}$.
  have h₂₀ : ((p - 17 : ZMod p)ˣ⁻¹ * (p - 16 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 17) p (p - 16) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 18)^{-1} \cdot (p - 17)^{-1}$ is equal to $\frac{p-18}{p-17} \cdot \frac{p-17}{p-18} \equiv 1 \pmod{p}$.
  have h₂₁ : ((p - 18 : ZMod p)ˣ⁻¹ * (p - 17 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 18) p (p - 17) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 19)^{-1} \cdot (p - 18)^{-1}$ is equal to $\frac{p-19}{p-18} \cdot \frac{p-18}{p-19} \equiv 1 \pmod{p}$.
  have h₂₂ : ((p - 19 : ZMod p)ˣ⁻¹ * (p - 18 : ZMod p)ˣ⁻¹) = 1 := by
    rw [invp1, invp2]
    ring_nf
    simp
    norm_cast
    exact ZMod.val_inv_mul_val_eq_inv_mul_val (p - 19) p (p - 18) (by linarith) (by linarith) (by linarith)

  -- The term $(p - 20)^{-1} \cdot (p - 19)^{-1}$ is equal to $\frac{p-20}{p-19} \cdot \frac{p-19}{p-20} \equiv 1 \pmod{p}$.
  have h