/-
  Given a real number \( x \), we need to show that if \( |x - 1| + |x| + |x + 1| = x + 2 \), then \( 0 \leq x \leq 1 \). We will consider different cases based on the signs of \( x - 1 \), \( x \), and \( x + 1 \).
  1. **Case 1**: \( x - 1 \geq 0 \) and \( x \geq 0 \) and \( x + 1 \geq 0 \).
     - Here, \( |x - 1| = x - 1 \), \( |x| = x \), and \( |x + 1| = x + 1 \).
     - Substituting these into the equation, we get \( (x - 1) + x + (x + 1) = x + 2 \), which simplifies to \( 3x = x + 2 \).
     - Solving for \( x \), we find \( 2x = 2 \) or \( x = 1 \).
  2. **Case 2**: \( x - 1 \geq 0 \) and \( x \geq 0 \) and \( x + 1 < 0 \).
     - Here, \( |x - 1| = x - 1 \), \( |x| = x \), and \( |x + 1| = -(x + 1) \).
     - Substituting these into the equation, we get \( (x - 1) + x + (-(x + 1)) = x + 2 \), which simplifies to \( x - 1 + x - x - 1 = x + 2 \).
     - This simplifies further to \( -2 = x + 2 \), which is a contradiction.
  3. **Case 3**: \( x - 1 \geq 0 \) and \( x < 0 \) and \( x + 1 \geq 0 \).
     - Here, \( |x - 1| = x - 1 \), \( |x| = -x \), and \( |x + 1| = x + 1 \).
     - Substituting these into the equation, we get \( (x - 1) + (-x) + (x + 1) = x + 2 \), which simplifies to \( x - 1 - x + x + 1 = x + 2 \).
     - This simplifies further to \( x + 1 = x + 2 \), which is a contradiction.
  4. **Case 4**: \( x - 1 \geq 0 \) and \( x < 0 \) and \( x + 1 < 0 \).
     - Here, \( |x - 1| = x - 1 \), \( |x| = -x \), and \( |x + 1| = -(x + 1) \).
     - Substituting these into the equation, we get \( (x - 1) + (-x) + (-(x + 1)) = x + 2 \), which simplifies to \( x - 1 - x - x - 1 = x + 2 \).
     - This simplifies further to \( -2x - 2 = x + 2 \), which is a contradiction.
  5. **Case 5**: \( x - 1 < 0 \) and \( x \geq 0 \) and \( x + 1 \geq 0 \).
     - Here, \( |x - 1| = -(x - 1) \), \( |x| = x \), and \( |x + 1| = x + 1 \).
     - Substituting these into the equation, we get \( -(x - 1) + x + (x + 1) = x + 2 \), which simplifies to \( -x + 1 + x + x + 1 = x + 2 \).
     - This simplifies further to \( x + 2 = x + 2 \), which is always true.
  6. **Case 6**: \( x - 1 < 0 \) and \( x \geq 0 \) and \( x + 1 < 0 \).
     - Here, \( |x - 1| = -(x - 1) \), \( |x| = x \), and \( |x + 1| = -(x + 1) \).
     - Substituting these into the equation, we get \( -(x - 1) + x + (-(x + 1)) = x + 2 \), which simplifies to \( -x + 1 + x - x - 1 = x + 2 \).
     - This simplifies further to \( -x - x = x + 2 \), which is a contradiction.
  7. **Case 7**: \( x - 1 < 0 \) and \( x < 0 \) and \( x + 1 \geq 0 \).
     - Here, \( |x - 1| = -(x - 1) \), \( |x| = -x \), and \( |x + 1| = x + 1 \).
     - Substituting these into the equation, we get \( -(x - 1) + (-x) + (x + 1) = x + 2 \), which simplifies to \( -x + 1 - x + x + 1 = x + 2 \).
     - This simplifies further to \( 2 - x = x + 2 \), which is a contradiction.
  8. **Case 8**: \( x - 1 < 0 \) and \( x < 0 \) and \( x + 1 < 0 \).
     - Here, \( |x - 1| = -(x - 1) \), \( |x| = -x \), and \( |x + 1| = -(x + 1) \).
     - Substituting these into the equation, we get \( -(x - 1) + (-x) + (-(x + 1)) = x + 2 \), which simplifies to \( -x + 1 - x - x - 1 = x + 2 \).
     - This simplifies further to \( -3x = x + 2 \), which is a contradiction.
  Combining all cases, we conclude that \( 0 \leq x \leq 1 \).
  -/
  -- Consider different cases based on the signs of x - 1, x, and x + 1
  cases' le_total 0 (x - 1) with h h <;> cases' le_total 0 x with h' h' <;> cases' le_total 0 (x + 1) with h'' h'' <;>
    simp_all only [abs_of_nonneg, abs_of_nonpos, sub_nonneg, sub_nonpos, add_left_neg, add_right_neg,
      add_zero, zero_add, zero_sub, neg_add_rev, neg_sub, neg_zero]
  -- Use linear arithmetic to solve the resulting equations
  all_goals
    constructor <;> nlinarith
```