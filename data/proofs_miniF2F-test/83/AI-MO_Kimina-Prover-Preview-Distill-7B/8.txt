-- Let $a_{1} = 1$, and $a_{n+1} = a_{n} \cdot (1 + 1/2^n)$ for $n \geq 1$.
  let a : ℕ → ℝ := fun n => Fin.prod (Finset.Icc 1 n) (fun k => 1 + (1 : ℝ) / 2 ^ k)
  let s : ℕ → ℝ := fun n => a (n + 1) / 2

  -- We will show that $s_{n} < 5/2$ for all $n \geq 1$.
  have h₁ : ∀ n, s (n + 1) < 5 / 2 := by
    intro n
    induction n with
    | zero =>
      simp [s]
      norm_num [a, Fin.prod_Icc_succ_top]
    | succ n ih =>
      rw [s, ih]
      apply lt_trans' (by norm_num)
      simp [s]
      norm_num [a, Fin.prod_Icc_succ_top]
      apply add_lt_add_left
      rw [mul_lt_mul_left (by norm_num), Finset.prod_Icc_succ_top (fun k => (1 : ℝ) / 2 ^ k) (by linarith)]
      -- The last sum is actually $1 / 2^{n} \cdot (1 + 1 / 2^{n})$.
      have : (fun (n : ℕ) ↦ 1 / 2 ^ n) = (fun (n : ℕ) ↦ (1 : ℝ) / 2 ^ n) := by
        funext n
        exact rfl
      rw [this, Finset.prod_Icc_succ_top (fun k => (1 : ℝ) / 2 ^ k) (by linarith)]
      let g (n : ℕ) := 1 / 2 ^ n
      have hg : ∀ n, g (n + 1) < 2 * g n := by
        intro n
        simp [g]
        rw [div_pow]
        simp
        norm_num
        have : (2 : ℝ) ^ n > 0 := by exact pow_pos (by norm_num) n
        apply (div_lt_div_iff₀ (by norm_num) this).mpr
        rw [mul_pow]
        have : (2 : ℝ) ^ n * 2 ^ n = (2 : ℝ) ^ (n + n) := by
          rw [<-pow_add]
          ring_nf
        rw [this]
        have : (2 : ℝ) ^ (n + n) * 2 < (2 : ℝ) ^ (n + n) * (2 : ℝ) ^ 1 := by
          apply (mul_lt_mul_left (by positivity)).mpr
          apply (pow_lt_pow_iff_right₀ (by norm_num)).mpr
          linarith
        rw [<-pow_add] at this
        exact this
      -- By induction, we know that $1 / 2^{n} \cdot (1 + 1 / 2^{n}) < 2 \cdot 1 / 2^{n} = 1 / 2^{n - 1}$.
      apply lt_trans' (mul_lt_mul_left (by positivity))
      rw [Finset.prod_Icc_succ_top (fun k => (1 : ℝ) / 2 ^ k) (by linarith)]
      -- Then, $1 / 2^{n} \cdot (1 + 1 / 2^{n}) < 1 / 2^{n - 1} < 1 / 2^{0} = 1$.
      apply mul_lt_mul_left (by positivity)
      rw [<-pow_succ]
      apply one_lt_pow₀ (by norm_num)
      linarith

  -- Because $s_{n} < 5/2$ for all $n \geq 1$,
  have h₂ : ∀ n, a (n + 1) / 2 < 5 / 2 := by
    intro n
    induction n with
    | zero =>
      simp [a, Fin.prod_Icc_succ_top]
    | succ n ih =>
      rw [show n + 1 + 1 = n + 2 by linarith, s, ih]
      apply lt_trans (by norm_num)
      apply lt_of_lt_of_le (h₁ (n + 1))
      apply div_le_div₀ (by norm_num) (by norm_num)

  -- so $a_{n} < 5/2$ for all $n \geq 2$.
  have h₃ : ∀ n, 2 ≤ n → a n < 5 / 2 := by
    intro n hn
    induction n with
    | zero => linarith
    | succ n ih =>
      cases n with
      | zero => simp [a, Fin.prod_Icc_succ_top]
      | succ n =>
        have : a (n + 2) = a (n + 1) * (1 + (1 : ℝ) / 2 ^ (n + 1)) := by
          simp [a, Fin.prod_Icc_succ_top]
          have : Finset.Icc 1 (n + 1) = insert (n + 1) (Finset.Icc 1 n) := by
            ext k
            simp
            omega
          rw [this, Fin.prod_insert (by linarith), mul_assoc]
        rw [this, mul_lt_mul_left (by positivity), ih (by linarith)]
        apply lt_trans (by norm_num)
        apply lt_of_lt_of_le (h₂ (n + 1))
        omega

  -- The original statement is $a_{n} < 5/2$ for all $n \geq 1$.
  intro n
  induction n with
  | zero => simp [a, Fin.prod_Icc_succ_top]
  | succ n ih =>
    cases n with
    | zero => simp [a, Fin.prod_Icc_succ_top]
    | succ n =>
      have := h₃ n (by omega)
      simp [a, Fin.prod_Icc_succ_top] at this ⊢
      rw [<-this]
      apply lt_trans (by norm_num)
      apply ih (by omega)
```