-- Let $n = 3^{17} + 3^{10}$. It is known that $11$ divides into $n+1$. If $n$ can be written in base $10$ as $ABCACCBAB$, where $A,B,C$ are distinct digits such that $A$ and $C$ are odd and $B$ is not divisible by $3$, find $100A + 10B + C$. Show that it is 129.

  -- We need to prove: 100 * A + 10 * B + C = 129

  -- First, we prove a lemma that 3^10 = 59049, which is correct
  have h1 : 3 ^ 10 = 59049 := by norm_num

  -- replace n with 3^17 + 3^10 in h₀
  rw [h1] at h₀

  -- We know that A, B, C are digits, so they must be in the range 0-9
  -- we prove this fact in h₇
  have h₇ : A < 10 ∧ B < 10 ∧ C < 10 := by
    have h₇ : A ∈ Finset.Icc 0 9 := by simp [h₃]
    have h₈ : B ∈ Finset.Icc 0 9 := by simp [h₃]
    have h₉ : C ∈ Finset.Icc 0 9 := by simp [h₃]
    simp at h₇ h₈ h₉
    constructor
    · omega
    · omega
    · omega

  -- We know that A, B, C are distinct
  -- we prove this fact in h₁₀
  have h₁₀ : [A, B, C].Pairwise (· ≠ ·) := by exact h₂

  -- We know that A, B, C are in 0-9
  -- we prove this fact in h₁₁
  have h₁₁ : A ∈ Finset.Icc 0 9 ∧ B ∈ Finset.Icc 0 9 ∧ C ∈ Finset.Icc 0 9 := by
    constructor
    · exact h₃
    · exact h₄
    · exact h₅

  -- Now we need to determine A, B, C

  -- We know that n = ABCACCBAB in base 10, which means:
  -- n = A * 10^8 + B * 10^7 + C * 10^6 + A * 10^5 + C * 10^4 + C * 10^3 + B * 10^2 + A * 10 + B
  -- its decimal expansion is 590973225, so we can determine A, B, C.

  -- We prove A = 5 in h₈
  have h₈ : A = 5 := by
    -- we determine C first
    -- C = 3^17 + 3^10 % 10
    have h₈ : C = 3 ^ 17 + 3 ^ 10 % 10 := by
      symm
      rw [←Nat.mod_add_div (3 ^ 17) 10]
      rw [h₀]
      simp
    norm_num at h₈

    -- Now we determine B
    -- B = (3^17 + 3^10) / 10 % 10
    have h₉ : B = (3 ^ 17 + 3 ^ 10) / 10 % 10 := by
      have h₉ : B = (3 ^ 17 + 3 ^ 10) / 10 % 10 := by
        symm
        rw [←Nat.mod_add_div (3 ^ 17 + 3 ^ 10) 10]
        simp
        omega
      exact h₉
    norm_num at h₉

    -- Finally we determine A
    -- A = (3^17 + 3^10) / 100 % 10
    have h₁₀ : A = (3 ^ 17 + 3 ^ 10) / 100 % 10 := by
      have h₁₀ : A = (3 ^ 17 + 3 ^ 10) / 100 % 10 := by
        symm
        rw [←Nat.mod_add_div (3 ^ 17 + 3 ^ 10) 100]
        simp
        omega
      exact h₁₀
    norm_num at h₁₀

    -- By trial and error, we find A = 5
    omega

  -- From h₈ we know A = 5
  -- So we can determine C
  have h₉ : C = 7 := by
    rw [h₈] at h₆
    norm_num at h₆
    omega

  -- From h₉ we know C = 7
  -- So we can determine B
  have h₁₀ : B = 2 := by
    rw [h₉] at h₅
    norm_num at h₅
    omega

  -- Now we substitute A, B, C into the goal
  subst A B C
  norm_num

```