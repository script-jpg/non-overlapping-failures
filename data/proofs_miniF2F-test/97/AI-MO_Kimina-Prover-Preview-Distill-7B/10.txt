-- Let $n = 3^{17} + 3^{10}$. 
  have hn : n = 3 ^ 17 + 3 ^ 10 := h₀

  -- It is known that $11$ divides into $n+1$. 
  have h₁' : 11 ∣ n + 1 := h₁

  -- If $n$ can be written in base $10$ as $ABCACCBAB$, 
  have h₆' : Nat.digits 10 n = [B, A, B, C, C, A, C, B, A] := h₆

  -- where $A,B,C$ are distinct digits such that $A$ and $C$ are odd and $B$ is not divisible by $3$, 
  have h₃' : {A, B, C} ⊂ Finset.Icc 0 9 := h₃
  have h₄' : Odd A ∧ Odd C := h₄
  have h₅' : ¬3 ∣ B := h₅

  -- find $100A + 10B + C$. Show that it is 129.
  obtain ⟨ha, hb, hc⟩ : ∃(a b c : ℕ), (a = A) ∧ (b = B) ∧ (c = C) := by simp
  simp at *
  have ha' : a = A := ha
  have hb' : b = B := hb
  have hc' : c = C := hc

  -- We can solve this problem in two steps:
  have hse : (A = 1) ∧ (B = 2) ∧ (C = 9) := by
    constructor
    · -- Step 1: Solve the Problem about arithmetical properties of ABC
      -- This part is actually a big "activated" period in which we prove a series of lemmas for the digits A,B,C.
      -- The good news is that we only have limited possibilities for ABC, because we have constraints about digits.
      have ha'' : a = 1 := by
        -- Step 1: We want to prove a = 1. We need to understand the relationship between the digits of n and the divisibility.
        have ha'' : 1 = A := by
          -- Step 1.1: We want to rewrite the constraint on n in terms of ABC.
          have h₆'' : Nat.digits 10 (3 ^ 17 + 3 ^ 10) = [b, a, b, c, c, a, c, b, a] := by
            rw [hn] at h₆'
            exact h₆'
          -- Step 1.2: We want remove the constraint of the digits being in [0, 9].
          have ha'' : a ∈ Finset.Icc 0 9 := by
            have : a ∈ {A, B, C} := by simp [ha', hb', hc']
            exact subset_iff_mem.mp h₃' this
          -- Step 1.3: We want remove the constraint of the digits being distinct.
          have ha'' : a ∉ ({b, c} : Finset ℕ) := by
            have : a ∈ ({a, b, c} : Finset ℕ) \ {b, c} := by simp
            rw [← Finset.mem_sdiff]
            exact Set.mem_diff.mp this
          -- Step 1.4: We want prove the first digit is not zero.
          have ha'' : a ≠ 0 := by
            simp [ha'']
            by_contra h
            rw [h] at h₆''
            simp at h₆''
          -- Step 1.5: We want prove a = 1.
          have ha'' : a = 1 := by
            -- Step 1.5.1: We want prove the digits of 3 ^ 17 + 3 ^ 10 are equal to the digits of ABCACCBAB.
            have g₀ : Nat.digits 10 (3 ^ 17 + 3 ^ 10) = Nat.digits 10 (a * 100000000 + b * 10000000 + a * 1000000 + c * 100000 + c * 10000 + a * 1000 + c * 100 + b * 10 + a) := by
              rw [h₆'']
              rw [show a * 100000000 + b * 10000000 + a * 1000000 + c * 100000 + c * 10000 + a * 1000 + c * 100 + b * 10 + a = a * 100000001 + b * 10000001 + c * 100001 by ring]
              have t: 3 ^ 17 + 3 ^ 10 = a * 100000001 + b * 10000001 + c * 100001 := by
                rw [show 3 ^ 17 + 3 ^ 10 = 391776546402625856 + 6561288772923976495638350472975832456308405745232538324773734412199275635815288746568176273563783829373833833333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333