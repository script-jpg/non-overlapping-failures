-- determine f(1,y)
  have h₃ : ∀ y, f 1 y = 2 ^ (y + 2) - 2 := by
    intro y
    -- induction on y
    induction y
    · -- y = 0
      simp
      rw [h₁ 0, h₀ 1, h₁ 1, h₀ 2, h₁ 2, h₀ 3, h₁ 3, h₀ 4, h₁ 4, h₀ 5, h₁ 5, h₀ 6, h₁ 6, h₀ 7, h₁ 7, h₀ 8, h₁ 8, h₀ 9, h₁ 9, h₀ 10, h₁ 10, h₀ 11, h₁ 11, h₀ 12, h₁ 12, h₀ 13, h₁ 13, h₀ 14, h₁ 14, h₀ 15, h₁ 15, h₀ 16, h₁ 16, h₀ 17, h₁ 17, h₀ 18, h₁ 18, h₀ 19, h₁ 19]
      norm_num
    · -- y = y + 1
      intro y _
      rw [h₂ 1 y, h₃ y]
      -- f(1,y) = 2^(y+2) - 2
      rw [h₁ y, h₃ y]
      -- f(1,y) = 2^(y+2) - 2
      simp
      rw [h₂ 1 y]
      clear h₂
      -- calc 2^(y+2) - 2 + (2^((y+2) + 2) - 2) = (2^(y+2) - 2) * 4 - 2 - 2 = 2^(y+2) * 4 - 8 - 2 = 2^(y+3) - 10
      calc
        (2 ^ (y + 2) - 2) + (2 ^ ((y + 2) + 2) - 2)
          = (2 ^ (y + 2) - 2) + (2 ^ (y + 2) * 4 - 2) := by ring
        _ = (2 ^ (y + 2) - 2) + (2 ^ (y + 2) * 4 - 2) := by ring
        _ = 2 ^ (y + 2) * 5 - 4 := by ring
        _ = 2 ^ (y + 3) - 10 := by ring

  -- determine f(2,y)
  have h₄ : ∀ y, f 2 y = 2 ^ (y + 3) - 3 := by
    intro y
    -- induction on y
    induction y
    · -- y = 0
      simp
      rw [h₁ 0, h₃ 0, h₁ 1, h₃ 1, h₁ 2, h₃ 2, h₁ 3, h₃ 3, h₁ 4, h₃ 4, h₁ 5, h₃ 5, h₁ 6, h₃ 6, h₁ 7, h₃ 7, h₁ 8, h₃ 8, h₁ 9, h₃ 9, h₁ 10, h₃ 10, h₁ 11, h₃ 11, h₁ 12, h₃ 12, h₁ 13, h₃ 13, h₁ 14, h₃ 14, h₁ 15, h₃ 15, h₁ 16, h₃ 16, h₁ 17, h₃ 17, h₁ 18, h₃ 18, h₁ 19, h₃ 19]
      norm_num
    · -- y = y + 1
      intro y _
      rw [h₂ 2 y, h₄ y]
      clear h₂
      rw [h₁ y, h₄ y]
      -- f(2,y) = f(1,f(2,y-1))
      calc
        2 ^ (y + 3) - 3 + (2 ^ ((y + 3) + 2) - 3)
          = (2 ^ (y + 3) - 3) + (2 ^ (y + 3) * 8 - 3) := by ring
        _ = 2 ^ (y + 3) * 9 - 6 := by ring
        _ = 2 ^ (y + 4) - 12 := by ring

  -- determine f(3,y)
  have h₅ : ∀ y, f 3 y = 2 ^ (y + 4) - 5 := by
    intro y
    -- induction on y
    induction y
    · -- y = 0
      simp
      rw [h₁ 0, h₄ 0, h₁ 1, h₄ 1, h₁ 2, h₄ 2, h₁ 3, h₄ 3, h₁ 4, h₄ 4, h₁ 5, h₄ 5, h₁ 6, h₄ 6, h₁ 7, h₄ 7, h₁ 8, h₄ 8, h₁ 9, h₄ 9, h₁ 10, h₄ 10, h₁ 11, h₄ 11, h₁ 12, h₄ 12, h₁ 13, h₄ 13, h₁ 14, h₄ 14, h₁ 15, h₄ 15, h₁ 16, h₄ 16, h₁ 17, h₄ 17, h₁ 18, h₄ 18, h₁ 19, h₄ 19]
      norm_num
    · -- y = y + 1
      intro y _
      rw [h₂ 3 y, h₅ y]
      clear h₂
      rw [h₁ y, h₅ y]
      -- f(3,y) = f(2,f(3,y-1))
      calc
        2 ^ (y + 4) - 5 + (2 ^ ((y + 4) + 2) - 5)
          = (2 ^ (y + 4) - 5) + (2 ^ (y + 4) * 16 - 5) := by ring
        _ = 2 ^ (y + 4) * 17 - 10 := by ring
        _ = 2 ^ (y + 5) - 20 := by ring

  -- determine f(4,y)
  have h₆ : ∀ y, f 4 y = 2 ^ (y + 5) - 13 := by
    intro y
    -- induction on y
    induction y
    · -- y = 0
      simp
      rw [h₁ 0, h₅ 0, h₁ 1, h₅ 1, h₁ 2, h₅ 2, h₁ 3, h₅ 3, h₁ 4, h₅ 4, h₁ 5, h₅ 5, h₁ 6, h₅ 6, h₁ 7, h₅ 7, h₁ 8, h₅ 8, h₁ 9, h₅ 9, h₁ 10, h₅ 10, h₁ 11, h₅ 11, h₁ 12, h₅ 12, h₁ 13, h₅ 13, h₁ 14, h₅ 14, h₁ 15, h₅ 15, h₁ 16, h₅ 16, h₁ 17, h₅ 17, h₁ 18, h₅ 18, h₁ 19, h₅ 19]
      norm_num
    · -- y = y + 1
      intro y _
      rw [h₂ 4 y, h₆ y]
      clear h₂
      rw [h₁ y, h₆ y]
      -- f(4,y) = f(3,f(4,y-1))
      calc
        2 ^ (y + 5) - 13 + (2 ^ ((y + 5) + 2) - 13)
          = (2 ^ (y + 5) - 13) + (2 ^ (y + 5) * 32 - 13) := by ring
        _ = 2 ^ (y + 5) * 33 - 26 := by ring
        _ = 2 ^ (y + 6) - 52 := by ring

  intro y
  rw [h₆ y]
  -- goal devides into 4 cases
  have h : ∀ y, y % 4 = 0 ∨ y % 4 = 1 ∨ y % 4 = 2 ∨ y % 4 = 3 := by
    intro y
    omega
  rcases h y with h | h | h | h
  · -- y mod 4 = 0
    rw [Nat.modEq_zero_iff_dvd] at h
    replace h : ∃ k : ℕ, y = 4 * k := by exact h
    rcases h with ⟨k, hk⟩
    rw [hk]
    -- calc 2 ^ (4 * k + 5) - 13 = 2 ^ (4 * k) * 2 ^ 5 - 13 = (2 ^ 4) ^ k * 2 ^ 5 - 13 = 16 ^ k * 2 ^ 5 - 13 = 16 ^ k * 32 - 13 = 16 ^ k * (32 - 13) = 16 ^ k * 19
    calc
      2 ^ (4 * k + 5) - 13 = 2 ^ (4 * k) * 2 ^ 5 - 13 := by ring
      _ = (2 ^ 4) ^ k * 2 ^ 5 - 13 := by rw [Nat.pow_mul]
      _ = 16 ^ k * 2 ^ 5 - 13 := by rw [show 2 ^ 4 = 16 by norm_num]
      _ = 16 ^ k * 32 - 13 := by rw [show 2 ^ 5 = 32 by norm_num]
      _ = 16 ^ k * (32 - 13) := by ring
      _ = 16 ^ k * 19 := by norm_num
      _ = 19 * 16 ^ k := by ring
  · -- y mod 4 = 1
    rw [Nat.modEq_iff_dvd' (by omega)] at h
    replace h : ∃ k : ℕ, y = 4 * k + 1 := by exact h
    rcases h with ⟨k, hk⟩
    rw [hk]
    -- calc 2 ^ (4 * k + 1 + 5) - 13 = 2 ^ (4 * k + 6) - 13 = 2 ^ (4 * k) * 2 ^ 6 - 13 = (2 ^ 4) ^ k * 2 ^ 6 - 13 = 16 ^ k * 64 - 13 = 16 ^ k * (64 - 13) = 16 ^ k * 51
    calc
      2 ^ (4 * k + 1 + 5) - 13 = 2 ^ (4 * k + 1) * 2 ^ 5 - 13 := by ring
      _ = (2 ^ 4) ^ k * 2 ^ 1 * 2 ^ 5 - 13 := by rw [Nat.pow_mul]
      _ = 16 ^ k * 2 ^ 1 * 2 ^ 5 - 13 := by rw [show 2 ^ 4 = 16 by norm_num]
      _ = 16 ^ k * 2 ^ 6 - 13 := by rw [show 2 ^ 1 * 2 ^ 5 = 2 ^ 6 by norm_num]
      _ = 16 ^ k * 64 - 13 := by rw [show 2 ^ 6 = 64 by norm_num]
      _ = 16 ^ k * (64 - 13) := by ring
      _ = 16 ^ k * 51 := by norm_num
      _ = 51 * 16 ^ k := by ring
  · -- y mod 4 = 2
    rw [Nat.modEq_iff_dvd' (by omega)] at h
    replace h : ∃ k : ℕ, y = 4 * k + 2 := by exact h
    rcases h with ⟨k, hk⟩
    rw [hk]
    -- calc 2 ^ (4 * k + 2 + 5) - 13 = 2 ^ (4 * k + 7) - 13 = 2 ^ (4 * k) * 2 ^ 7 - 13 = (2 ^ 4) ^ k * 2 ^ 7 - 13 = 16 ^ k * 128 - 13 = 16 ^ k * (128 - 13) = 16 ^ k * 115
    calc
      2 ^ (4 * k + 2 + 5) - 13 = 2 ^ (4 * k + 2) * 2 ^ 5 - 13 := by ring
      _ = (2 ^ 4) ^ k * 2 ^ 2 * 2 ^ 5 - 13 := by rw [Nat.pow_mul]
      _ = 16 ^ k * 2 ^ 2 * 2 ^ 5 - 13 := by rw [show 2 ^ 4 = 16 by norm_num]
      _ = 16 ^ k * 2 ^ 7 - 13 := by rw [show 2 ^ 2 * 2 ^ 5 = 2 ^ 7 by norm_num]
      _ = 16 ^ k * 128 - 13 := by rw [show 2 ^ 7 = 128 by norm_num]
      _ = 16 ^ k * (128 - 13) := by ring
      _ = 16 ^ k * 115 := by norm_num
      _ = 115 * 16 ^ k := by ring
  · -- y mod 4 = 3
    rw [Nat.modEq_iff_dvd' (by omega)] at h
    replace h : ∃ k : ℕ, y = 4 * k + 3 := by exact h
    rcases h with ⟨k, hk⟩
    rw [hk]
    -- calc 2 ^ (4 * k + 3 + 5) - 13 = 2 ^ (4 * k + 8) - 13 = 2 ^ (4 * k) * 2 ^ 8 - 13 = (2 ^ 4) ^ k * 2 ^ 8 - 13 = 16 ^ k * 256 - 13 = 16 ^ k * (256 - 13) = 16 ^ k * 243
    calc
      2 ^ (4 * k + 3 + 5) - 13 = 2 ^ (4 * k + 3) * 2 ^ 5 - 13 := by ring
      _ = (2 ^ 4) ^ k * 2 ^ 3 * 2 ^ 5 - 13 := by rw [Nat.pow_mul]
      _ = 16 ^ k * 2 ^ 3 * 2 ^ 5 - 13 := by rw [show 2 ^ 4 = 16 by norm_num]
      _ = 16 ^ k * 2 ^ 8 - 13 := by rw [show 2 ^ 3 * 2 ^ 5 = 2 ^ 8 by norm_num]
      _ = 16 ^ k * 256 - 13 := by rw [show 2 ^ 8 = 256 by norm_num]
      _ = 16 ^ k * (256 - 13) := by ring
      _ = 16 ^ k * 243 := by norm_num
      _ = 243 * 16 ^ k := by ring

```