have h₃ := h₁ 0
  have h₄ := h₁ 1
  have h₅ := h₁ 2
  have h₆ := h₁ 3
  have h₇ := h₂ 0 0
  have h₈ := h₂ 0 1
  have h₉ := h₂ 0 2
  have h₁₀ := h₂ 0 3
  have h₁₁ := h₂ 1 0
  have h₁₂ := h₂ 1 1
  have h₁₃ := h₂ 1 2
  have h₁₄ := h₂ 1 3
  have h₁₅ := h₂ 2 0
  have h₁₆ := h₂ 2 1
  have h₁₇ := h₂ 2 2
  have h₁₈ := h₂ 2 3
  have h₁₉ := h₂ 3 0
  have h₂₀ := h₂ 3 1
  have h₂₁ := h₂ 3 2
  have h₂₂ := h₂ 3 3
  simp at h₃ h₄ h₅ h₆ h₇ h₈ h₉ h₁₀ h₁₁ h₁₂ h₁₃ h₁₄ h₁₅ h₁₆ h₁₇ h₁₈ h₁₉ h₂₀ h₂₁ h₂₂
  <;> norm_num [h₀, h₁, h₂] at *
  <;> omega

theorem imo_1981_p6_2 (f : ℕ → ℕ → ℕ) (h₀ : ∀ y, f 0 y = y + 1) (h₁ : ∀ x, f (x + 1) 0 = f x 1)
    (h₂ : ∀ x y, f (x + 1) (y + 1) = f x (f (x + 1) y)) : ∀ y, f 4 (y + 1) = 2 ^ (f 4 y + 3) - 3 := by
  have h₃ := h₁ 0
  have h₄ := h₁ 1
  have h₅ := h₁ 2
  have h₆ := h₁ 3
  have h₇ := h₂ 0 0
  have h₈ := h₂ 0 1
  have h₉ := h₂ 0 2
  have h₁₀ := h₂ 0 3
  have h₁₁ := h₂ 1 0
  have h₁₂ := h₂ 1 1
  have h₁₃ := h₂ 1 2
  have h₁₄ := h₂ 1 3
  have h₁₅ := h₂ 2 0
  have h₁₆ := h₂ 2 1
  have h₁₇ := h₂ 2 2
  have h₁₈ := h₂ 2 3
  have h₁₉ := h₂ 3 0
  have h₂₀ := h₂ 3 1
  have h₂₁ := h₂ 3 2
  have h₂₂ := h₂ 3 3
  simp at h₃ h₄ h₅ h₆ h₇ h₈ h₉ h₁₀ h₁₁ h₁₂ h₁₃ h₁₄ h₁₅ h₁₆ h₁₇ h₁₈ h₁₉ h₂₀ h₂₁ h₂₂
  <;> norm_num [h₀, h₁, h₂] at *
  <;> omega

theorem imo_1981_p6_3 (f : ℕ → ℕ → ℕ) (h₀ : ∀ y, f 0 y = y + 1) (h₁ : ∀ x, f (x + 1) 0 = f x 1)
    (h₂ : ∀ x y, f (x + 1) (y + 1) = f x (f (x +