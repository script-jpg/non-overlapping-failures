-- A bunch of lemmas to show that $f(2^m)$ divides $f(2^n)$.
  have lm_1 (a b : ℕ) : b ∣ a → 2 ^ b ∣ 2 ^ a := by
    intro h
    apply Nat.pow_dvd_pow _ h

  have lm_2 (a b : ℕ) : b ∣ a → 4 ^ b ∣ 4 ^ a := by
    intro h
    apply Nat.pow_dvd_pow _ h

  have lm_3 (a b : ℕ) : b ∣ a → 6 ^ b ∣ 6 ^ a := by
    intro h
    apply Nat.pow_dvd_pow _ h

  have lm_4 (a b : ℕ) : b ∣ a → 9 ^ b ∣ 9 ^ a := by
    intro h
    apply Nat.pow_dvd_pow _ h

  -- Show that $f(2^m)$ divides $4^{2^n}$.
  have lm_5 : f (2 ^ m) ∣ 4 ^ (2 ^ n) := by
    rw [h₀]
    apply Nat.dvd_add
    · rw [Nat.pow_add, lm_1, h₂]
      apply lm_2
      apply dvd_refl
    · apply Nat.dvd_add
      · rw [Nat.pow_add, lm_1, h₂]
        apply lm_3
        apply dvd_refl
      · apply lm_4
        apply dvd_refl
        -- Show that $2^m$ divides $2^n$.
        exact Nat.pow_dvd_pow _ h₂

  -- Show that $f(2^m)$ divides $6^{2^n}$.
  have lm_6 : f (2 ^ m) ∣ 6 ^ (2 ^ n) := by
    rw [h₀]
    apply Nat.dvd_add
    · rw [Nat.pow_add, lm_1, h₂]
      apply lm_3
      apply dvd_refl
    · apply Nat.dvd_add
      · rw [Nat.pow_add, lm_1, h₂]
        apply lm_4
        apply dvd_refl
      · apply lm_2
        apply dvd_refl
        -- Show that $2^m$ divides $2^n$.
        exact Nat.pow_dvd_pow _ h₂

  -- Show that $f(2^m)$ divides $9^{2^n}$.
  have lm_7 : f (2 ^ m) ∣ 9 ^ (2 ^ n) := by
    rw [h₀]
    apply Nat.dvd_add
    · apply Nat.dvd_add
      · rw [Nat.pow_add, lm_1, h₂]
        apply lm_4
        apply dvd_refl
      · apply lm_2
        apply dvd_refl
        -- Show that $2^m$ divides $2^n$.
        exact Nat.pow_dvd_pow _ h₂
    · apply lm_3
      apply dvd_refl
      -- Show that $2^m$ divides $2^n$.
      exact Nat.pow_dvd_pow _ h₂

  -- Show that $f(2^m)$ divides $f(2^n)$.
  apply Nat.dvd_add
  · rw [h₀]
    apply Nat.dvd_add
    · apply Nat.dvd_add
      · exact lm_5
      · exact lm_6
    · apply lm_7
  · apply dvd_refl

```