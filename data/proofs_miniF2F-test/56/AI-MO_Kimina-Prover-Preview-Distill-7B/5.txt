-- A lemma that the powers of 4 are closed under divisibility.
  have pow4 heartbeats maxHeartbeats (a b : ℕ) (h : a ≤ b) : 4 ^ a ∣ 4 ^ b := by
    induction' h with h ih
    · four_pow_one a
    · calc
        _ ∣ 4 ^ (b - 1) * 4 ^ 1 := by
            rw [Nat.pow_add]
            apply Nat.dvd_mul_left
          _ = 4 ^ b := by
            rw [Nat.sub_add_cancel h, mul_comm 4, four_pow_one]

  -- A lemma that the powers of 6 are closed under divisibility.
  have pow6 heartbeats maxHeartbeats (a b : ℕ) (h : a ≤ b) : 6 ^ a ∣ 6 ^ b := by
    induction' h with h ih
    · six_pow_one a
    · calc
        _ ∣ 6 ^ (b - 1) * 6 ^ 1 := by
            rw [Nat.pow_add]
            apply Nat.dvd_mul_left
          _ = 6 ^ b := by
            rw [Nat.sub_add_cancel h, mul_comm 6, six_pow_one]

  -- A lemma that the powers of 9 are closed under divisibility.
  have pow9 heartbeats maxHeartbeats (a b : ℕ) (h : a ≤ b) : 9 ^ a ∣ 9 ^ b := by
    induction' h with h ih
    · nine_pow_one a
    · calc
        _ ∣ 9 ^ (b - 1) * 9 ^ 1 := by
            rw [Nat.pow_add]
            apply Nat.dvd_mul_left
          _ = 9 ^ b := by
            rw [Nat.sub_add_cancel h, mul_comm 9, nine_pow_one]

  --os.mul_dvd_mul_left (f (2 ^ m)) (f (2 ^ n)) (g := f (2 ^ m)) (m := g 1) (n := g 2) (by apply Nat.zero_lt_of_ne_zero; intro h; rw [h₀] at h; omega)
  have h₃ : f (2 ^ m) ∣ f (2 ^ n) := by
    simp only [h₀, Nat.pow_add]
    apply Nat.dvd_add
    · apply Nat.dvd_add
      --os.dvd_mul_left (4 ^ m) (4 ^ n)
      · exact pow4 h₂
      --os.dvd_mul_left (6 ^ m) (6 ^ n)
      · apply Nat.dvd_mul_left
        exact pow6 h₂
      --os.dvd_mul_left (9 ^ m) (9 ^ n)
      · apply Nat.dvd_mul_left
        exact pow9 h₂
    --os.dvd_mul_right (f (2 ^ m)) (f (2 ^ n))
    · apply Nat.dvd_mul_right
      -- The powers of $6^n$ are closed under divisibility.
      · calc
          _ ∣ 6 ^ m * 6 ^ (n - m) := by
            apply Nat.mul_dvd_mul_left
            rw [Nat.pow_add, Nat.pow_add]
            omega
          _ = 6 ^ n := by
            rw [Nat.pow_add, Nat.mul_comm, Nat.sub_add_cancel h₂, Nat.mul_comm m, <-Nat.pow_add, mul_comm 6]
            rw [Nat.sub_add_cancel h₂]
      -- The powers of $9^n$ are closed under divisibility.
      · calc
          _ ∣ 9 ^ m * 9 ^ (n - m) := by
            apply Nat.mul_dvd_mul_left
            rw [Nat.pow_add, Nat.pow_add]
            omega
          _ = 9 ^ n := by
            rw [Nat.pow_add, Nat.mul_comm, Nat.sub_add_cancel h₂, Nat.mul_comm m, <-Nat.pow_add, mul_comm 9]
            rw [Nat.sub_add_cancel h₂]
  exact h₃

```