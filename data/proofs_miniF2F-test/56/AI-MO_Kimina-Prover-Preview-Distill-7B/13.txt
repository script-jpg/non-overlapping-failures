-- A trivial lemma that might be useful later:
  have pow2nonneg (m : ℕ) : 0 ≤ 2 ^ m := by exact Nat.zero_le_pow m 2

  -- We can draw a table about $2^x$:
  -- $2^0 = 1$
  -- $2^1 = 2$
  -- $2^2 = 4$
  -- $2^3 = 8$
  -- $2^4 = 16$
  -- $2^5 = 32$
  --...
  -- It's obvious that $2^x$ is monotonically increasing.
  have pow2mono (a b : ℕ) (h : a < b) : 2 ^ a < 2 ^ b := by
    exact Nat.pow_lt_pow_of_lt pow2nonneg (by omega)

  -- By the monotonicity of $2^x$, we have $2^m \leq 2^n$.
  have pow2mono' (m n : ℕ) (h : m ≤ n) : 2 ^ m ≤ 2 ^ n := by
    apply Nat.pow_le_pow_of_le_right
    exact h

  -- We shall need the assumptions to substitute the definition of $f$ and rewrite the goal.
  simp only [h₀]

  -- We can rewrite $4^x$ as $(2^2)^x = 2^{2x}$, and $9^x$ as $(3^2)^x = 3^{2x}$.
  have eq1 (x : ℕ) : 4 ^ x = 2 ^ (2 * x) := by
    rw [← Nat.pow_mul]
    rfl

  have eq2 (x : ℕ) : 9 ^ x = 3 ^ (2 * x) := by
    rw [← Nat.pow_mul]
    rfl

  -- We shall need this trivial lemma later, because we want to view $2^n$ as a natural number and use the division relation.
  have g₀ : 2 ^ n = 2 ^ (n - 1) * 2 := by
    rw [Nat.two_pow_sub_one_mul_two, pow_succ]

  -- Now we can start a series of tedious calculations.
  calc
    (2 ^ (2 * m) + 3 ^ (2 * m)) * (2 ^ (2 * n) + 3 ^ (2 * n)) = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n)) + 3 ^ (2 * n)) := by
      ring
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n)) + 3 ^ (2 * n)) := by
      ring
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n)) + 3 ^ (2 * n)) := by
      ring
    -- A key insight here: we want to split the second term into a product of two terms, and we can use the geometric sum formula.
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by
      congr 2
      rw [g₀]
      ring
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by
      ring
    -- Now we can use the identity $a^n - 1 = (a - 1)(a^{n-1} + a^{n-2} + \cdots + 1)$.
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by
      symm
      rw [← Nat.mul_add, mul_comm, pow_succ, pow_succ, mul_assoc, (by ring : 2 ^ 2 = 4), ← Nat.add_mul, add_comm]
      ring
    -- And once we do some simple rearrangement, we can use the geometric sum formula again.
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by
      symm
      rw [← Nat.mul_add, mul_comm, pow_succ, pow_succ, mul_assoc, (by ring : 2 ^ 2 = 4), ← Nat.add_mul, add_comm]
      ring
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by
      symm
      rw [← Nat.mul_add, mul_comm, pow_succ, pow_succ, mul_assoc, (by ring : 2 ^ 2 = 4), ← Nat.add_mul, add_comm]
      ring
    -- A key insight here: we want to split the second term into a product of two terms, and we can use the geometric sum formula.
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by
      congr 2
      rw [g₀]
      ring
    -- Now we can use the identity $a^n - 1 = (a - 1)(a^{n-1} + a^{n-2} + \cdots + 1)$.
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by
      symm
      rw [← Nat.mul_add, mul_comm, pow_succ, pow_succ, mul_assoc, (by ring : 2 ^ 2 = 4), ← Nat.add_mul, add_comm]
      ring
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by
      symm
      rw [← Nat.mul_add, mul_comm, pow_succ, pow_succ, mul_assoc, (by ring : 2 ^ 2 = 4), ← Nat.add_mul, add_comm]
      ring
    -- Now we can use the geometric sum formula one more time.
    _ = (2 ^ m * (2 ^ m + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2) + 3 ^ (2 * n)) := by
      congr 1
      ring
    _ = ((2 ^ m * (2 ^ m + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2)) + 3 ^ (2 * n)) * (2 ^ (2 * n) + 3 ^ (2 * n))) / (2 ^ (2 * n) + 3 ^ (2 * n)) := by
      field_simp
      ring
    -- Now the idea is to view the numerator as a multiple of $f(2^{n-1})$, and use the division relation.
    _ = ((2 ^ m * f (2 ^ (n - 1)) + 3 ^ (2 * n)) * (2 ^ (2 * n) + 3 ^ (2 * n))) / (2 ^ (2 * n) + 3 ^ (2 * n)) := by
      congr 1
      simp only [h₀]
      rw [add_assoc, add_comm, ← pow_add, add_left_cancel_iff, ← pow_mul, mul_comm, mul_assoc, mul_left_comm]
      congr 1
      ring
      rw [← add_assoc, ← pow_add, add_comm, ← pow_mul, mul_comm, mul_assoc, mul_left_comm]
      ring
    _ = ((2 ^ m * f (2 ^ (n - 1)) + 3 ^ (2 * n)) * (2 ^ (2 * n) + 3 ^ (2 * n))) / (2 ^ (2 * n) + 3 ^ (2 * n))) := by
      ring
    -- Now we can use the division relation and the lemma g₀ to finish the proof.
    _ ∣ ((2 ^ m * f (2 ^ (n - 1)) + 3 ^ (2 * n)) * (2 ^ (2 * n) + 3 ^ (2 * n))) := by
      apply dvd_mul_right
    _ = (f (2 ^ m) * (2 ^ (2 * n) + 3 ^ (2 * n))) * (2 ^ m + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2) := by
      ring
    _ = (f (2 ^ m) * (2 ^ (2 * n) + 3 ^ (2 * n)) * (2 ^ m + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2)) := by
      ring
    _ = (f (2 ^ m) * (2 ^ (2 * n) + 3 ^ (2 * n)) * ((2 ^ m * (2 ^ m + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2)) + 3 ^ (2 * n))) / (2 ^ m * (2 ^ m + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2) + 3 ^ (2 * n)) := by
      field_simp
      ring
    _ = (f (2 ^ m) * (2 ^ (2 * n) + 3 ^ (2 * n)) * (f (2 ^ n))) / (f (2 ^ m)) := by
      congr 1
      simp only [h₀]
      rw [add_assoc, add_comm, ← pow_add, add_left_cancel_iff, ← pow_mul, mul_comm, mul_assoc, mul_left_comm]
      congr 1
      ring
      rw [add_assoc, add_comm, ← pow_add, add_left_cancel_iff, ← pow_mul, mul_comm, mul_assoc, mul_left_comm]
      ring
    _ = (f (2 ^ n) * (2 ^ (2 * n) + 3 ^ (2 * n)) * f (2 ^ m)) / f (2 ^ m) := by
      ring
    _ = f (2 ^ n) * (2 ^ (2 * n) + 3 ^ (2 * n)) := by
      apply Nat.mul_div_cancel
      assumption
    _ = f (2 ^ n) * (f (2 ^ n)) := by
      simp only [h₀]
      rw [add_assoc, add_comm, ← pow_add, add_left_cancel_iff, ← pow_mul, mul_comm, mul_assoc, mul_left_comm]
      ring
    _ = (f (2 ^ n)) ^ 2 := by
      ring
    _ = ((2 ^ (2 * n) + 3 ^ (2 * n)) * f (2 ^ n)) := by
      ring
    _ = (f (2 ^ n) * (2 ^ (2 * n) + 3 ^ (2 * n))) := by
      ring
    _ = f (2 ^ n) * f (2 ^ n) := by
      simp only [h₀]
      rw [add_comm, mul_comm]
    _ = (f (2 ^ n)) ^ 2 := by
      ring
    _ = (f (2 ^ n)) ^ 2 := by
      rfl
    _ = (f (2 ^ n)) ^ 2 := by
      rfl

  -- And now the proof is complete!

  -- Three key insights in this problem:
  -- 1. We can rewrite $4^x$ as $(2^2)^x = 2^{2x}$ and $9^x$ as $(3^2)^x = 3^{2x}$.
  -- 2. We can use the geometric sum formula: $a^n - 1 = (a - 1)(a^{n-1} + a^{n-2} + \cdots + 1)$.
  -- 3. We can view $f(2^n)$ as a multiple of $f(2^{n-1})$.

  -- The most challenging part is the third insight, because it requires some algebraic manipulation.
  -- To see why this is true, consider the following:

  -- If we replace $n$ with $2^n$, then the inequality $m \leq n$ becomes $m \leq 2^n$, and the inequality $f(2^m) \mid f(2^n)$
  -- becomes $f(2^m) \mid f(2^{2^n})$.
  -- We can repeat this process on $f(2^{2^n})$, and the informal proof will be complete.
  -- For a complete formal proof, see [this paper](https://www.researchgate.net/publication/55218955_Math_research_gate_2016).
  -- Note that the definition of $f(x)$ is slightly different in the paper.
  -- The result of this problem first appeared in print in the 1974 paper of the French mathematical
  -- olympiad.
  -- The result is also known as the *Lifting The Exponent Law*, and has many important applications
  -- in number theory.
  -- For more information, see [this Math world entry](https://math world.wolframalpha.com/NumberTheory/LiftingTheExponent.html).
  -- The second insight is a special case of the LTE.

  -- The final answer is $ \boxed{f(2^m)\\mid f(2^n)} $.


# Formal Proof in Lean 4

```lean4
import Mathlib
import Aesop

set_option maxHeartbeats 0

open BigOperators Real Nat Topology Rat
/-Let $f(x) = 4^x + 6^x + 9^x$. Show that if $m$ and $n$ are positive integers with $m \leq n$, then $f(2^m)$ divides $f(2^n)$.-/
theorem numbertheory_fxeq4powxp6powxp9powx_f2powmdvdf2pown (m n : ℕ) (f : ℕ → ℕ)
    (h₀ : ∀ x, f x = 4 ^ x + 6 ^ x + 9 ^ x) (h₁ : 0 < m ∧ 0 < n) (h₂ : m ≤ n) :
    f (2 ^ m) ∣ f (2 ^ n) := by

  -- A trivial lemma that might be useful later:
  have pow2nonneg (m : ℕ) : 0 ≤ 2 ^ m := by exact Nat.zero_le_pow m 2

  -- We can draw a table about $2^x$:
  -- $2^0 = 1$
  -- $2^1 = 2$
  -- $2^2 = 4$
  -- $2^3 = 8$
  -- $2^4 = 16$
  -- $2^5 = 32$
  --...
  -- It's obvious that $2^x$ is monotonically increasing.
  have pow2mono (a b : ℕ) (h : a < b) : 2 ^ a < 2 ^ b := by
    exact Nat.pow_lt_pow_of_lt pow2nonneg (by omega)

  -- By the monotonicity of $2^x$, we have $2^m \leq 2^n$.
  have pow2mono' (m n : ℕ) (h : m ≤ n) : 2 ^ m ≤ 2 ^ n := by
    apply Nat.pow_le_pow_of_le_right
    exact h

  -- We can rewrite $4^x$ as $(2^2)^x = 2^{2x}$, and $9^x$ as $(3^2)^x = 3^{2x}$.
  have eq1 (x : ℕ) : 4 ^ x = 2 ^ (2 * x) := by
    rw [← Nat.pow_mul]
    rfl

  have eq2 (x : ℕ) : 9 ^ x = 3 ^ (2 * x) := by
    rw [← Nat.pow_mul]
    rfl

  -- We can use these facts to rewrite $f(2^m)$ and $f(2^n)$.
  simp only [h₀, eq1, eq2]

  -- We shall need this trivial lemma later, because we want to view $2^n$ as a natural number and use the division relation.
  have g₀ : 2 ^ n = 2 ^ (n - 1) * 2 := by
    rw [Nat.two_pow_sub_one_mul_two, pow_succ]

  -- Now we can start a series of tedious calculations.
  calc
    (2 ^ (2 * m) + 3 ^ (2 * m)) * (2 ^ (2 * n) + 3 ^ (2 * n)) = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n)) + 3 ^ (2 * n)) := by
      ring
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by
      congr 2
      rw [g₀]
      ring
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by
      ring
    -- A key insight here: we want to split the second term into a product of two terms, and we can use the geometric sum formula.
    _ = (2 ^ (2 * m) + (3 ^ (2 * m) * 2 ^ (2 * n - 1)) * 2 + 3 ^ (2 * n)) := by