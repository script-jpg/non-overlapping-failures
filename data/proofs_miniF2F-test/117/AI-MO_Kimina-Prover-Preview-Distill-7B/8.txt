-- preparing some facts for `omega`
  have h₄ : ∀ n, ¬ (6 ∣ n ∧ 6 ∣ n + 1) := by
    intro n h
    omega

  have h₅ : ∀ n, ¬ (6 ∣ n ∧ 6 ∣ n + 2) := by
    intro n h
    omega

  have h₆ : ∀ n, ¬ (6 ∣ n + 1 ∧ 6 ∣ n + 2) := by
    intro n h
    omega

  -- Since $6n+3$, $6n+2$ and $6n+1$ are pairwise relatively prime$, their product divides $(6n+k)$. Hence $6(6n+3)(6n+2)(6n+1)$ divides $(6n+k)$. That implies $6n+k$ is a multiple of $6(6n+3)(6n+2)(6n+1)/\gcd(6, (6n+3)(6n+2)(6n+1))!$.
  have h₇ (n : ℕ) : (6 * n + 3) * (6 * n + 2) * (6 * n + 1) * (6 * (6 * n + 3) * (6 * n + 2) * (6 * n + 1)) / Nat.gcd (6 * (6 * n + 3) * (6 * n + 2) * (6 * n + 1)) (6 * n + 3) * (6 * n + 2) * (6 * n + 1) ∣ 6 * n + k := by
    -- Since $6n+3$ and $6n+1$ are both relatively prime to $6n+k$, their product is also relatively prime to $6n+k$.
    have h₈ : Nat.Coprime (6 * n + 3) (6 * n + k) := by
      have h₈ : Nat.gcd (6 * n + 3) (6 * n + k) = 1 := h₁ n
      exact Nat.coprime_iff_gcd_eq_one.mp h₈
    have h₉ : Nat.Coprime (6 * n + 1) (6 * n + k) := by
      have h₉ : Nat.gcd (6 * n + 1) (6 * n + k) = 1 := h₃ n
      exact Nat.coprime_iff_gcd_eq_one.mp h₉
    -- Moreover, that product is also relatively prime to $6n+2$.
    have h₁₀ : Nat.Coprime ((6 * n + 3) * (6 * n + 2) * (6 * n + 1)) (6 * n + k) := by
      rw [Nat.coprime_mul_iff_left]
      constructor <;> assumption
    have h₁₁ : Nat.gcd ((6 * n + 3) * (6 * n + 2) * (6 * n + 1)) (6 * n + k) = 1 := by
      exact Nat.coprime_iff_gcd_eq_one.mp h₁₀
    -- As a result, the product of these three numbers divides $6n+k$.
    have h₁₂ : ((6 * n + 3) * (6 * n + 2) * (6 * n + 1)) ∣ 6 * n + k := by
      apply Nat.dvd_of_gcd_eq_one h₁₁
    -- However, that product can't be equal to $6n+k$ because it is larger.
    have h₁₃ : ((6 * n + 3) * (6 * n + 2) * (6 * n + 1)) < 6 * n + k := by
      by_contra h
      have h₁₄ : 6 ∣ (6 * n + 3) * (6 * n + 2) * (6 * n + 1) := by
        exact Nat.dvd_mul_right 6 ((6 * n + 2) * (6 * n + 1))
      have h₁₅ : 6 ∣ 6 * n + k := by
        rw [h]
        exact Nat.dvd_add_left (6 * n) (k - 6 * n)
      have h₁₆ : 6 ∣ (k - (6 * n)) := by
        exact Nat.dvd_sub (by omega) h₁₅
      have h₁₇ : 6 ∣ (6 * n + 3) * (6 * n + 2) * (6 * n + 1) + (k - (6 * n)) := by
        exact Nat.dvd_add h₁₄ h₁₆
      have h₁₈ : 6 ∣ (6 * n + 3) * (6 * n + 2) * (6 * n + 1) + (k - (6 * n)) + (6 * n) := by
        exact Nat.dvd_add h₁₇ (by omega)
      omega
    exact Nat.le_of_dvd (by omega) h₁₂

  -- By the same argument, we can prove that $6n+1$, $6n+2$ and $6n+3$ also divide $6n+k$.
  have h₁₄ (n : ℕ) : (6 * n + 1) * (6 * n + 2) * (6 * n + 3) / Nat.gcd ((6 * n + 1) * (6 * n + 2) * (6 * n + 3)) (6 * n + 1) ∣ 6 * n + k := by
    have h₁₅ : Nat.Coprime (6 * n + 2) (6 * n + k) := by
      have h₁₅ : Nat.gcd (6 * n + 2) (6 * n + k) = 1 := h₂ n
      exact Nat.coprime_iff_gcd_eq_one.mp h₁₅
    have h₁₆ : Nat.Coprime (6 * n + 3) (6 * n + k) := by
      have h₁₆ : Nat.gcd (6 * n + 3) (6 * n + k) = 1 := h₁ n
      exact Nat.coprime_iff_gcd_eq_one.mp h₁₆
    have h₁₇ : Nat.Coprime ((6 * n + 1) * (6 * n + 2) * (6 * n + 3)) (6 * n + k) := by
      rw [Nat.coprime_mul_iff_left]
      constructor <;> assumption
    have h₁₈ : Nat.gcd ((6 * n + 1) * (6 * n + 2) * (6 * n + 3)) (6 * n + k) = 1 := by
      exact Nat.coprime_iff_gcd_eq_one.mp h₁₇
    have h₁₉ : ((6 * n + 1) * (6 * n + 2) * (6 * n + 3)) ∣ 6 * n + k := by
      apply Nat.dvd_of_gcd_eq_one h₁₈
    have h₂₀ : ((6 * n + 1) * (6 * n + 2) * (6 * n + 3)) < 6 * n + k := by
      by_contra h
      have h₂₁ : 6 ∣ (6 * n + 1) * (6 * n + 2) * (6 * n + 3) := by
        exact Nat.dvd_mul_right 6 ((6 * n + 2) * (6 * n + 3))
      have h₂₂ : 6 ∣ 6 * n + k := by
        rw [h]
        exact Nat.dvd_add_left (6 * n) (k - 6 * n)
      have h₂₃ : 6 ∣ (k - (6 * n)) := by
        exact Nat.dvd_sub (by omega) h₂₂
      have h₂₄ : 6 ∣ (6 * n + 1) * (6 * n + 2) * (6 * n + 3) + (k - (6 * n)) := by
        exact Nat.dvd_add h₂₁ h₂₃
      have h₂₅ : 6 ∣ (6 * n + 1) * (6 * n + 2) * (6 * n + 3) + (k - (6 * n)) + (6 * n) := by
        exact Nat.dvd_add h₂₄ (by omega)
      omega
    exact Nat.le_of_dvd (by omega) h₁₉

  have h₁₇ (n : ℕ) : (6 * n + 1) * (6 * n + 3) / Nat.gcd ((6 * n + 1) * (6 * n + 3)) (6 * n + 1) ∣ 6 * n + k := by
    have h₁₈ : Nat.Coprime (6 * n + 3) (6 * n + k) := by
      have h₁₈ : Nat.gcd (6 * n + 3) (6 * n + k) = 1 := h₁ n
      exact Nat.coprime_iff_gcd_eq_one.mp h₁₈
    have h₁₉ : Nat.Coprime (6 * n + 1) (6 * n + k) := by
      have h₁₉ : Nat.gcd (6 * n + 1) (6 * n + k) = 1 := h₂ n
      exact Nat.coprime_iff_gcd_eq_one.mp h₁₉
    have h₂₀ : Nat.Coprime ((6 * n + 1) * (6 * n + 3)) (6 * n + k) := by
      rw [Nat.coprime_mul_iff_left]
      constructor <;> assumption
    have h₂₁ : Nat.gcd ((6 * n + 1) * (6 * n + 3)) (6 * n + k) = 1 := by
      exact Nat.coprime_iff_gcd_eq_one.mp h₂₀
    have h₂₂ : (6 * n + 1) * (6 * n + 3) ∣ 6 * n + k := by
      apply Nat.dvd_of_gcd_eq_one h₂₁
    have h₂₃ : (6 * n + 1) * (6 * n + 3) < 6 * n + k := by
      by_contra h
      have h₂₄ : 6 ∣ (6 * n + 1) * (6 * n + 3) := by
        exact Nat.dvd_mul_right 6 (6 * n + 3)
      have h₂₅ : 6 ∣ 6 * n + k := by
        rw [h]
        exact Nat.dvd_add_left (6 * n) (k - 6 * n)
      have h₂₆ : 6 ∣ (k - (6 * n)) := by
        exact Nat.dvd_sub (by omega) h₂₅
      have h₂₇ : 6 ∣ (6 * n + 1) * (6 * n + 3) + (k - (6 * n)) := by
        exact Nat.dvd_add h₂₄ h₂₆
      have h₂₈ : 6 ∣ (6 * n + 1) * (6 * n + 3) + (k - (6 * n)) + (6 * n) := by
        exact Nat.dvd_add h₂₇ (by omega)
      omega
    exact Nat.le_of_dvd (by omega) h₂₂

  have h₁₈ (n : ℕ) : (6 * n + 2) * (6 * n + 3) / Nat.gcd ((6 * n + 2) * (6 * n + 3)) (6 * n + 2) ∣ 6 * n + k := by
    have h₁₉ : Nat.Coprime (6 * n + 3) (6 * n + k) := by
      have h₁₉ : Nat.gcd (6 * n + 3) (6 * n + k) = 1 := h₁ n
      exact Nat.coprime_iff_gcd_eq_one.mp h₁₉
    have h₂₀ : Nat.Coprime (6 * n + 2) (6 * n + k) := by
      have h₂₀ : Nat.gcd (6 * n + 2) (6 * n + k) = 1 := h₂ n
      exact Nat.coprime_iff_gcd_eq_one.mp h₂₀
    have h₂₁ : Nat.Coprime ((6 * n + 2) * (6 * n + 3)) (6 * n + k) := by
      rw [Nat.coprime_mul_iff_left]
      constructor <;> assumption
    have h₂₂ : Nat.gcd ((6 * n + 2) * (6 * n + 3)) (6 * n + k) = 1 := by
      exact Nat.coprime_iff_gcd_eq_one.mp h₂₁
    have h₂₃ : (6 * n + 2) * (6 * n + 3) ∣ 6 * n + k := by
      apply Nat.dvd_of_gcd_eq_one h₂₂
    have h₂₄ : (6 * n + 2) * (6 * n + 3) < 6 * n + k := by
      by_contra h
      have h₂₅ : 6 ∣ (6 * n + 2) * (6 * n + 3) := by
        exact Nat.dvd_mul_right 6 (6 * n + 3)
      have h₂₆ : 6 ∣ 6 * n + k := by
        rw [h]
        exact Nat.dvd_add_left (6 * n) (k - 6 * n)
      have h₂₇ : 6 ∣ (k - (6 * n)) := by
        exact Nat.dvd_sub (by omega) h₂₆
      have h₂₈ : 6 ∣ (6 * n + 2) * (6 * n + 3) + (k - (6 * n)) := by
        exact Nat.dvd_add h₂₅ h₂₇
      have h₂₉ : 6 ∣ (6 * n + 2) * (6 * n + 3) + (k - (6 * n)) + (6 * n) := by
        exact Nat.dvd_add h₂₈ (by omega)
      omega
    exact Nat.le_of_dvd (by omega) h₂₃

  -- We can show that $6n+1$, $6n+2$, $6n+3$ and their product all are relatively prime to $6n+5$.
  have h₁₉ (n : ℕ) : Nat.gcd (6 * n + 5) (6 * n + 1) = 1 := by
    have h₁₉ : Nat.Coprime (6 * n + 5) (6 * n + 1) := by
      have h₁₃ : ¬ (6 ∣ (6 * n + 5) ∨ 6 ∣ (6 * n + 1)) := by
        intro h
        rcases h with h | h
        · have h₁₄ : 6 ∣ 6 * n + 5 - (6 * n) := by
            exact Nat.dvd_sub (by omega) h
          have h₁₅ : 6 ∣ 5 := by
            exact Nat.dvd_add h₁₄ (by omega)
          have h₁₆ : 6 ∣ 1 := by
            exact Nat.dvd_sub (by omega) h₁₅
          omega
        · have h₁₇ : 6 ∣ 6 * n + 1 - (6 * n) := by
            exact Nat.dvd_sub (by omega) h
          have h₁₈ : 6 ∣ 1 := by
            exact Nat.dvd_add h₁₇ (by omega)
          omega
      by_contra h
      have h₂₃ : 6 ∣ (6 * n + 5) ∨ 6 ∣ (6 * n + 1) := by
        apply (Nat.Prime.dvd_mul (by norm_num)).mp h
      omega
    exact Nat.coprime_iff_gcd_eq_one.mpr h₁₉

  have h₂₀ (n : ℕ) : Nat.gcd (6 * n + 5) (6 * n + 2) = 1 := by
    have h₂₀ : Nat.Coprime (6 * n + 5) (6 * n + 2) := by
      have h₂₃ : ¬ (6 ∣ (6 * n + 5) ∨ 6 ∣ (6 * n + 2)) := by
        intro h
        rcases h with h | h
        · have h₂₄ : 6 ∣ 6 * n + 5 - (6 * n) := by
            exact Nat.dvd_sub (by omega) h
          have h₂₅ : 6 ∣ 5 := by
            exact Nat.dvd_add h₂₄ (by omega)
          have h₂₆ : 6 ∣ 1 := by
            exact Nat.dvd_sub (by omega) h₂₅
          omega
        · have h₂₇ : 6 ∣ 6 * n + 2 - (6 * n) := by
            exact Nat.dvd_sub (by omega) h
          have h₂₈ : 6 ∣ 2 := by
            exact Nat.dvd_add h₂₇ (by omega)
          have h₂₉ : 6 ∣ 1 := by
            exact Nat.dvd_sub (by omega) h₂₈
          omega
      by_contra h
      have h₂₃ :