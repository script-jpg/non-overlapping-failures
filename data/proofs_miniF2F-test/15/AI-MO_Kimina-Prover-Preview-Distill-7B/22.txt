-- Show that $\lvert a - b \rvert \leq 1 + ab$.
  have h₁ : abs (a - b) ≤ 1 + a * b := by
    calc
      abs (a - b) ≤ abs a + abs b := by apply abs_sub b a
      _ ≤ 1 + a * b := by
        apply add_le_add
        · simp [abs_le]
        · rw [mul_comm]
          calc
            0 ≤ (1 - a) * (1 - b) := by apply mul_nonneg <;> linarith
            _ = 1 + a * b - (a + b) := by ring
            _ ≤ 1 + a * b := by linarith

  -- Consider whether $a \geq b$ or $a < b$.
  by_cases h₂ : a - b ≥ 0

  -- If $a \geq b$, then $ab + \lvert a - b \rvert = ab + a - b$.
  · rw [abs_of_nonneg h₂]
    calc
      a * b + (a - b) = (a + b) * (a - b) := by ring
      _ ≤ 1 * (a - b) := by
        apply mul_le_mul_of_nonneg_right
        · linarith
        · linarith
      _ ≤ 1 := by linarith

  -- If $a < b$, then $ab + \lvert a - b \rvert = ab + b - a$.
  · rw [abs_of_neg (lt_of_not_ge h₂)]
    calc
      a * b + (b - a) = (a + b) * (b - a) := by ring
      _ ≤ 1 * (b - a) := by
        apply mul_le_mul_of_nonneg_right
        · linarith
        · linarith
      _ ≤ 1 := by linarith
```