-- We have $\lvert a \rvert \leq \sqrt{a^2 + b^2}$ and $\lvert b \rvert \leq \sqrt{a^2 + b^2}$.
  have h₁ : abs a ≤ Real.sqrt (a ^ 2 + b ^ 2) := by
    have : a ^ 2 ≤ a ^ 2 + b ^ 2 := by
      linarith [sq_nonneg b]
    exact (abs_le_sqrt_add_sq this (sq_nonneg a)).mpr (by linarith)
  have h₂ : abs b ≤ Real.sqrt (a ^ 2 + b ^ 2) := by
    have : b ^ 2 ≤ a ^ 2 + b ^ 2 := by
      linarith [sq_nonneg a]
    exact (abs_le_sqrt_add_sq (sq_nonneg a) this).mpr (by linarith)

  rw [h₀] at h₁ h₂

  -- We have $2ab \leq a^2 + b^2$.
  have h₃ : 2 * a * b ≤ a ^ 2 + b ^ 2 := by
    linarith [two_mul_le_add_sq a b]

  -- We have $-1 \leq a - b \leq 1$.
  have h₄ : -1 ≤ a - b := by
    have : -1 ≤ a ^ 2 + b ^ 2 - 2 * a * b := by
      linarith [sq_nonneg (a - b)]
    rw [show a ^ 2 + b ^ 2 - 2 * a * b = (a - b) ^ 2 by ring] at this
    nlinarith
  have h₅ : a - b ≤ 1 := by
    have : a ^ 2 + b ^ 2 + 2 * a * b ≤ 1 := by
      linarith [sq_nonneg (a + b)]
    rw [show a ^ 2 + b ^ 2 + 2 * a * b = (a + b) ^ 2 by ring] at this
    nlinarith

  -- We have $ab + \lvert a - b \rvert \leq 1$.
  by_cases h₆ : a - b ≥ 0
  · rw [abs_of_nonneg h₆]
    linarith
  · rw [abs_of_neg (lt_of_not_ge h₆)]
    linarith
```