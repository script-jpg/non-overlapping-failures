Consider the absolute value of \(a - b\); if \(a \geq b\), then \(|a - b| = a - b\), otherwise \(|a - b| = b - a\).

Case 1: \(a \geq b\)

Then \(a - b \geq 0\), and the expression \(a b + |a - b|\) becomes \(a b + a - b = a b + a - b\).

Since \(a^2 + b^2 = 1\), we have \((a - b)^2 \geq 0\), hence \(a^2 - 2ab + b^2 \geq 0\), which simplifies to \(a^2 + b^2 \geq 2ab\), or \(1 \geq 2ab\), i.e., \(ab \leq \frac{1}{2}\).

Thus, \(ab + a - b \leq ab + \frac{1}{2} \leq 1\).

Case 2: \(a \leq b\)

Then \(a - b \leq 0\), the expression \(a b + |a - b|\) becomes \(a b + b - a = b - a + ab\).

Using the same inequality \(a^2 + b^2 = 1\), we have \((a - b)^2 \geq 0\), which simplifies to \(a^2 + b^2 \geq 2ab\), i.e., \(1 \geq 2ab\), i.e., \(ab \leq \frac{1}{2}\).

Thus, \(b - a + ab \leq b - a + \frac{1}{2} \leq 1\).

In both cases, we have shown that \(ab + |a - b| \leq 1\).

-/

-- Consider the cases where a - b is non-negative or non-positive.
cases' le_total 0 (a - b) with h₁ h₁

-- Case 1: a - b ≥ 0, so |a - b| = a - b.
-- Simplify the expression to a * b + a - b.
{ simp_all only [abs_of_nonneg, abs_of_nonpos, sub_nonneg, sub_nonpos]

    -- Use the fact that a^2 + b^2 = 1 and the non-negativity of (a - b)^2 to bound the expression.
    nlinarith [sq_nonneg (a + b), h₀] }

-- Case 2: a - b ≤ 0, so |a - b| = b - a.
-- Simplify the expression to b - a + a * b.
{ simp_all only [abs_of_nonneg, abs_of_nonpos, sub_nonneg, sub_nonpos]

    -- Use the fact that a^2 + b^2 = 1 and the non-negativity of (a - b)^2 to bound the expression.
    nlinarith [sq_nonneg (a + b), h₀] }
```