-- We will use the Intermediate Value Theorem to show that there are at least 6 solutions.
  -- Let f be the function $1-3\sin\theta+5\cos3\theta$.
  let f : ℝ → ℝ := fun θ => 1 - 3 * Real.sin θ + 5 * Real.cos (3 * θ)

  -- First, we show that $f(\theta_1) \neq 0$ for $\theta_1 = \frac{14\pi}{3}$. 
  have h₁ : f (14 * Real.pi / 3) ≠ 0 := by
    simp [f]
    have h₁ : Real.sin (14 * Real.pi / 3) = -Real.sqrt 3 / 2 := by
      rw [show 14 * Real.pi / 3 = 2 * Real.pi + 8 * Real.pi / 3 by ring]
      rw [Real.sin_add, Real.sin_two_pi, Real.cos_two_pi]
      rw [show 8 * Real.pi / 3 = 3 * Real.pi - Real.pi / 3 by ring]
      rw [Real.sin_sub, Real.sin_three_pi, Real.cos_three_pi, Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    have h₂ : Real.cos (14 * Real.pi / 3) = -1 / 2 := by
      simp [show 14 * Real.pi / 3 = 2 * Real.pi + 8 * Real.pi / 3 by ring]
      rw [Real.cos_add, Real.cos_two_pi, Real.sin_two_pi]
      rw [show 8 * Real.pi / 3 = 3 * Real.pi - Real.pi / 3 by ring]
      rw [Real.cos_sub, Real.cos_three_pi, Real.sin_three_pi, Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    rw [h₁, h₂]
    linarith

  -- Next, we show that $f(\theta_1) \neq 0$ for $\theta_1 = \frac{4\pi}{3}$. 
  have h₂ : f (4 * Real.pi / 3) ≠ 0 := by
    simp [f]
    have h₁ : Real.sin (4 * Real.pi / 3) = -Real.sqrt 3 / 2 := by
      rw [show 4 * Real.pi / 3 = Real.pi + Real.pi / 3 by ring]
      rw [Real.sin_add, Real.sin_pi, Real.cos_pi]
      rw [Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    have h₂ : Real.cos (4 * Real.pi / 3) = -1 / 2 := by
      rw [show 4 * Real.pi / 3 = Real.pi + Real.pi / 3 by ring]
      rw [Real.cos_add, Real.cos_pi, Real.sin_pi]
      rw [Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    rw [h₁, h₂]
    linarith

  -- Next, we show that $f(\theta_1) \neq 0$ for $\theta_1 = \frac{2\pi}{3}$. 
  have h₃ : f (2 * Real.pi / 3) ≠ 0 := by
    simp [f]
    have h₁ : Real.sin (2 * Real.pi / 3) = Real.sqrt 3 / 2 := by
      rw [show 2 * Real.pi / 3 = Real.pi - Real.pi / 3 by ring]
      rw [Real.sin_sub, Real.sin_pi, Real.cos_pi]
      rw [Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    have h₂ : Real.cos (2 * Real.pi / 3) = -1 / 2 := by
      rw [show 2 * Real.pi / 3 = Real.pi - Real.pi / 3 by ring]
      rw [Real.cos_sub, Real.cos_pi, Real.sin_pi]
      rw [Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    rw [h₁, h₂]
    linarith

  -- Next, we show that $f(\theta_1) \neq 0$ for $\theta_1 = \frac{8\pi}{3}$. 
  have h₄ : f (8 * Real.pi / 3) ≠ 0 := by
    simp [f]
    have h₁ : Real.sin (8 * Real.pi / 3) = Real.sqrt 3 / 2 := by
      rw [show 8 * Real.pi / 3 = 2 * Real.pi + 2 * Real.pi / 3 by ring]
      rw [Real.sin_add, Real.sin_two_pi, Real.cos_two_pi]
      rw [show 2 * Real.pi / 3 = Real.pi - Real.pi / 3 by ring]
      rw [Real.sin_sub, Real.sin_pi, Real.cos_pi]
      rw [Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    have h₂ : Real.cos (8 * Real.pi / 3) = -1 / 2 := by
      rw [show 8 * Real.pi / 3 = 2 * Real.pi + 2 * Real.pi / 3 by ring]
      rw [Real.cos_add, Real.cos_two_pi, Real.sin_two_pi]
      rw [show 2 * Real.pi / 3 = Real.pi - Real.pi / 3 by ring]
      rw [Real.cos_sub, Real.cos_pi, Real.sin_pi]
      rw [Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    rw [h₁, h₂]
    linarith

  -- Next, we show that $f(\theta_1) \neq 0$ for $\theta_1 = \frac{10\pi}{3}$. 
  have h₅ : f (10 * Real.pi / 3) ≠ 0 := by
    simp [f]
    have h₁ : Real.sin (10 * Real.pi / 3) = -Real.sqrt 3 / 2 := by
      rw [show 10 * Real.pi / 3 = 2 * Real.pi + 4 * Real.pi / 3 by ring]
      rw [Real.sin_add, Real.sin_two_pi, Real.cos_two_pi]
      rw [show 4 * Real.pi / 3 = Real.pi + Real.pi / 3 by ring]
      rw [Real.sin_add, Real.sin_pi, Real.cos_pi]
      rw [Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    have h₂ : Real.cos (10 * Real.pi / 3) = -1 / 2 := by
      simp [show 10 * Real.pi / 3 = 2 * Real.pi + 4 * Real.pi / 3 by ring]
      rw [Real.cos_add, Real.cos_two_pi, Real.sin_two_pi]
      rw [show 4 * Real.pi / 3 = Real.pi + Real.pi / 3 by ring]
      rw [Real.cos_add, Real.cos_pi, Real.sin_pi]
      rw [Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    rw [h₁, h₂]
    linarith

  -- Finally, we show that $f(\theta_1) \neq 0$ for $\theta_1 = \frac{16\pi}{3}$. 
  have h₆ : f (16 * Real.pi / 3) ≠ 0 := by
    simp [f]
    have h₁ : Real.sin (16 * Real.pi / 3) = -Real.sqrt 3 / 2 := by
      rw [show 16 * Real.pi / 3 = 2 * Real.pi + 10 * Real.pi / 3 by ring]
      rw [Real.sin_add, Real.sin_two_pi, Real.cos_two_pi]
      rw [show 10 * Real.pi / 3 = 2 * Real.pi + 4 * Real.pi / 3 by ring]
      rw [Real.sin_add, Real.sin_two_pi, Real.cos_two_pi]
      rw [show 4 * Real.pi / 3 = Real.pi + Real.pi / 3 by ring]
      rw [Real.sin_add, Real.sin_pi, Real.cos_pi]
      rw [Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    have h₂ : Real.cos (16 * Real.pi / 3) = -1 / 2 := by
      rw [show 16 * Real.pi / 3 = 2 * Real.pi + 10 * Real.pi / 3 by ring]
      rw [Real.cos_add, Real.cos_two_pi, Real.sin_two_pi]
      rw [show 10 * Real.pi / 3 = 2 * Real.pi + 4 * Real.pi / 3 by ring]
      rw [Real.cos_add, Real.cos_two_pi, Real.sin_two_pi]
      rw [show 4 * Real.pi / 3 = Real.pi + Real.pi / 3 by ring]
      rw [Real.cos_add, Real.cos_pi, Real.sin_pi]
      rw [Real.sin_pi_div_three, Real.cos_pi_div_three]
      ring_nf
      rw [Real.sq_sqrt]
      linarith
    rw [h₁, h₂]
    linarith

  -- We have shown that $f(\theta) \neq 0$ at $\theta = \frac{2\pi k}{3}$ where $k = 1, 2, 4, 5, 8, 10, 16$.
  -- The function $f(\theta)$ is continuous and is a combination of sine and cosine functions.
  -- By the Intermediate Value Theorem, there must be a solution between each of these values.
  -- So there are at least 6 solutions.

  -- We will use the fact that $f(\theta)$ is continuous and analyze its behavior in the interval $(0, 2\pi]$.
  have h₇ : ∀ x : ℝ, 0 < x ∧ x ≤ 2 * Real.pi ∧ 1 - 3 * Real.sin x + 5 * Real.cos (3 * x) = 0 →
      x ∈ S := by
    intro x ⟨h₁, h₂, h₃⟩
    specialize h₀ x
    constructor
    · exact h₃
    · exact h₀ ⟨h₁, h₂⟩

  -- We will analyze the sign of $f(\theta)$ in the intervals determined by the points where we found non-zero values.
  -- We want to show that there are solutions in the intervals $(\frac{14\pi}{3}, \frac{4\pi}{3})$, $(\frac{4\pi}{3}, \frac{2\pi}{3})$, $(\frac{2\pi}{3}, \frac{8\pi}{3})$, $(\frac{8\pi}{3}, \frac{10\pi}{3})$, $(\frac{10\pi}{3}, \frac{16\pi}{3})$, and $(\frac{16\pi}{3}, 2\pi]$.
  -- We will do this by showing that $f(\theta)$ changes sign in each interval, which implies the existence of a root in that interval.
  -- Since $f(\theta)$ is continuous, and we have shown that $f(\frac{14\pi}{3}) \neq 0$, $f(\frac{4\pi}{3}) \neq 0$, $f(\frac{2\pi}{3}) \neq 0$, $f(\frac{8\pi}{3}) \neq 0$, $f(\frac{10\pi}{3}) \neq 0$, $f(\frac{16\pi}{3}) \neq 0$, and $f(2\pi) = 1 - 3\sin(2\pi) + 5\cos(6\pi) = 1 - 0 + 5 \cdot 1 = 6 \neq 0$, we can analyze the sign of $f(\theta)$ in each interval.

  -- Choose $\theta_1 \in (\frac{14\pi}{3}, \frac{4\pi}{3})$ such that $f(\theta_1) < 0$.
  have h₈ : f (15 * Real.pi / 4) < 0 := by
    simp [f]
    have h₁ : Real.sin (15 * Real.pi / 4) < 0 := by
      have h₂ : 15 * Real.pi / 4 ≤ Real.pi := by
        linarith [Real.pi_pos]
      have h₃ : Real.sin (15 * Real.pi / 4) < 0 := by
        apply Real.sin_neg_of_pos_of_pos_of_pi_lt
        · linarith
        · linarith
        · linarith
      exact h₃
    have h₂ : Real.cos (15 * Real.pi / 4) < 0 := by
      have h₃ : 15 * Real.pi / 4 ≤ Real.pi + Real.pi / 2 := by
        linarith [Real.pi_pos]
      have h₄ : Real.cos (15 * Real.pi / 4) < 0 := by
        apply Real.cos_neg_of_pi_div_two_lt_of_lt
        · linarith
        · linarith
      exact h₄
    linarith

  -- Choose $\theta_2 \in (\frac{4\pi}{3}, \frac{2\pi}{3})$ such that $f(\theta_2) < 0$.
  have h₉ : f (5 * Real.pi / 4) < 0 := by
    simp [f]
    have h₁ : Real.sin (5 * Real.pi / 4) < 0 := by
      have h₂ : 5 * Real.pi / 4 ≤ Real.pi := by
        linarith [Real.pi_pos]
      have h₃ : Real.sin (5 * Real.pi / 4) < 0 := by
        apply Real.sin_neg_of_pos_of_pos_of_pi_lt
        · linarith
        · linarith
        · linarith
      exact h₃
    have h₂ : Real.cos (5 * Real.pi / 4) < 0 := by
      have h₃ : 5 * Real.pi / 4 ≤ Real.pi + Real.pi / 2 := by
        linarith [Real.pi_pos]
      have h₄ : Real.cos (5 * Real.pi / 4) < 0 := by
        apply Real.cos_neg_of_pi_div_two_lt_of_lt
        · linarith
        · linarith
      exact h₄
    linarith

  -- Choose $\theta_3 \in (\frac{2\pi}{3}, \frac{8\pi}{3})$ such that $f(\theta_3) < 0$.
  have h₁₀ : f (5 * Real.pi / 6) < 0 := by
    simp [f]
    have h₁ : Real.sin (5 * Real.pi / 6) > 0 := by
      have h₂ : Real.sin (5 * Real.pi / 6) = Real.sin (Real.pi - Real.pi / 6) := by
        ring_nf
      rw [h₂]
      have h₃ : Real.sin (Real.pi - Real.pi / 6) = Real.sin (Real.pi / 6) := by
        rw [Real.sin_pi_sub]
      rw [h₃]
      have h₄ : Real.sin (Real.pi / 6) > 0 := by
        apply Real.sin_pos_of_pos_of_lt_pi
        · linarith
        · linarith
      exact h₄
    have h₂ : Real.cos (5 * Real.pi / 6) < 0 := by
      have h₃ : 5 * Real.pi / 6 ≤ Real.pi := by
        linarith [Real.pi_pos]
      have h₄ : Real.cos (5 * Real.pi / 6) < 0 := by
        apply Real.cos_neg_of_pi_div_two_lt_of_lt
        · linarith
        · linarith
      exact h₄
    linarith

  -- Choose $\theta_4 \in (\frac{8\pi}{3}, \frac{10\pi}{3})$ such that $f(\theta_4) < 0$.
  have h₁₁ : f (13 * Real.pi / 4) < 0 := by
    simp [f]
    have h₁ : Real.sin (13 * Real.pi / 4) < 0 := by
      have h₂ : 13 * Real.pi / 4 ≤ Real.pi := by
        linarith [Real.pi_pos]
      have h₃ : Real.sin (13 * Real.pi / 4) < 0 := by
        apply Real.sin_neg_of_pos_of_pos_of_pi_lt
        · linarith
        · linarith
        · linarith
      exact h₃
    have h₂ : Real.cos (13 * Real.pi / 4) < 0 := by
      have h₃ : 13 * Real.pi / 4 ≤ Real.pi + Real.pi / 2 := by
        linarith [Real.pi_pos]
      have h₄ : Real.cos (13 * Real.pi / 4) < 0 := by
        apply Real.cos_neg_of_pi_div_two_lt_of_lt
        · linarith
        · linarith
      exact h₄
    linarith

  -- Choose $\theta_5 \in (\frac{10\pi}{3}, \frac{16\pi}{3})$ such that $f(\theta_5) < 0$.
  have h₁₂ : f (23 * Real.pi / 4) < 0 := by
    simp [f