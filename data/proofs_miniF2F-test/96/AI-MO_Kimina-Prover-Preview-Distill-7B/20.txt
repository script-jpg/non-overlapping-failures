-- We need to consider all possible values of $A$, $M$ and $C$ in natural numbers
  -- such that $A + M + C = 12$. It is clear that $A\cdot M\cdot C + A\cdot M +
  -- M\cdot C + A\cdot C \leq 112$.
  match a with
  | 0 =>
    -- If $A = 0$, then $M + C = 12$. $M\cdot C + M + C \leq 112$.
    match m with
    | 0 =>
      -- If $M = 0$, then $C = 12$. But $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 1 =>
      -- If $M = 1$, then $C = 11$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 2 =>
      -- If $M = 2$, then $C = 10$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 3 =>
      -- If $M = 3$, then $C = 9$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 4 =>
      -- If $M = 4$, then $C = 8$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 5 =>
      -- If $M = 5$, then $C = 7$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 6 =>
      -- If $M = 6$, then $C = 6$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 216$.
      simp
      <;> omega
    | 7 =>
      -- If $M = 7$, then $C = 5$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 105$.
      simp
      <;> omega
    | 8 =>
      -- If $M = 8$, then $C = 4$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 64$.
      simp
      <;> omega
    | 9 =>
      -- If $M = 9$, then $C = 3$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 27$.
      simp
      <;> omega
    | 10 =>
      -- If $M = 10$, then $C = 2$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 8$.
      simp
      <;> omega
    | 11 =>
      -- If $M = 11$, then $C = 1$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 11$.
      simp
      <;> omega
    | 12 =>
      -- If $M = 12$, then $C = 0$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
  | 1 =>
    -- If $A = 1$, then $M + C = 11$. $M\cdot C + M + C \leq 112$.
    match m with
    | 0 =>
      -- If $M = 0$, then $C = 11$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 1 =>
      -- If $M = 1$, then $C = 10$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 11$.
      simp
      <;> omega
    | 2 =>
      -- If $M = 2$, then $C = 9$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 36$.
      simp
      <;> omega
    | 3 =>
      -- If $M = 3$, then $C = 8$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 63$.
      simp
      <;> omega
    | 4 =>
      -- If $M = 4$, then $C = 7$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 84$.
      simp
      <;> omega
    | 5 =>
      -- If $M = 5$, then $C = 6$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 105$.
      simp
      <;> omega
    | 6 =>
      -- If $M = 6$, then $C = 5$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 84$.
      simp
      <;> omega
    | 7 =>
      -- If $M = 7$, then $C = 4$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 64$.
      simp
      <;> omega
    | 8 =>
      -- If $M = 8$, then $C = 3$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 36$.
      simp
      <;> omega
    | 9 =>
      -- If $M = 9$, then $C = 2$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 18$.
      simp
      <;> omega
    | 10 =>
      -- If $M = 10$, then $C = 1$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 11$.
      simp
      <;> omega
    | 11 =>
      -- If $M = 11$, then $C = 0$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
  | 2 =>
    -- If $A = 2$, then $M + C = 10$. $M\cdot C + M + C \leq 112$.
    match m with
    | 0 =>
      -- If $M = 0$, then $C = 10$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 1 =>
      -- If $M = 1$, then $C = 9$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 18$.
      simp
      <;> omega
    | 2 =>
      -- If $M = 2$, then $C = 8$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 56$.
      simp
      <;> omega
    | 3 =>
      -- If $M = 3$, then $C = 7$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 91$.
      simp
      <;> omega
    | 4 =>
      -- If $M = 4$, then $C = 6$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 108$.
      simp
      <;> omega
    | 5 =>
      -- If $M = 5$, then $C = 5$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 112$.
      simp
      <;> omega
    | 6 =>
      -- If $M = 6$, then $C = 4$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 84$.
      simp
      <;> omega
    | 7 =>
      -- If $M = 7$, then $C = 3$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 63$.
      simp
      <;> omega
    | 8 =>
      -- If $M = 8$, then $C = 2$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 36$.
      simp
      <;> omega
    | 9 =>
      -- If $M = 9$, then $C = 1$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 11$.
      simp
      <;> omega
    | 10 =>
      -- If $M = 10$, then $C = 0$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
  | 3 =>
    -- If $A = 3$, then $M + C = 9$. $M\cdot C + M + C \leq 112$.
    match m with
    | 0 =>
      -- If $M = 0$, then $C = 9$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 1 =>
      -- If $M = 1$, then $C = 8$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 24$.
      simp
      <;> omega
    | 2 =>
      -- If $M = 2$, then $C = 7$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 42$.
      simp
      <;> omega
    | 3 =>
      -- If $M = 3$, then $C = 6$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 60$.
      simp
      <;> omega
    | 4 =>
      -- If $M = 4$, then $C = 5$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 70$.
      simp
      <;> omega
    | 5 =>
      -- If $M = 5$, then $C = 4$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 64$.
      simp
      <;> omega
    | 6 =>
      -- If $M = 6$, then $C = 3$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 45$.
      simp
      <;> omega
    | 7 =>
      -- If $M = 7$, then $C = 2$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 28$.
      simp
      <;> omega
    | 8 =>
      -- If $M = 8$, then $C = 1$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 11$.
      simp
      <;> omega
    | 9 =>
      -- If $M = 9$, then $C = 0$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
  | 4 =>
    -- If $A = 4$, then $M + C = 8$. $M\cdot C + M + C \leq 112$.
    match m with
    | 0 =>
      -- If $M = 0$, then $C = 8$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 1 =>
      -- If $M = 1$, then $C = 7$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 28$.
      simp
      <;> omega
    | 2 =>
      -- If $M = 2$, then $C = 6$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 52$.
      simp
      <;> omega
    | 3 =>
      -- If $M = 3$, then $C = 5$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 65$.
      simp
      <;> omega
    | 4 =>
      -- If $M = 4$, then $C = 4$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 64$.
      simp
      <;> omega
    | 5 =>
      -- If $M = 5$, then $C = 3$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 45$.
      simp
      <;> omega
    | 6 =>
      -- If $M = 6$, then $C = 2$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 28$.
      simp
      <;> omega
    | 7 =>
      -- If $M = 7$, then $C = 1$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 11$.
      simp
      <;> omega
    | 8 =>
      -- If $M = 8$, then $C = 0$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
  | 5 =>
    -- If $A = 5$, then $M + C = 7$. $M\cdot C + M + C \leq 112$.
    match m with
    | 0 =>
      -- If $M = 0$, then $C = 7$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 0$.
      simp
      <;> omega
    | 1 =>
      -- If $M = 1$, then $C = 6$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 42$.
      simp
      <;> omega
    | 2 =>
      -- If $M = 2$, then $C = 5$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 65$.
      simp
      <;> omega
    | 3 =>
      -- If $M = 3$, then $C = 4$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 72$.
      simp
      <;> omega
    | 4 =>
      -- If $M = 4$, then $C = 3$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 63$.
      simp
      <;> omega
    | 5 =>
      -- If $M = 5$, then $C = 2$. $C \cdot M\cdot A + C \cdot M + M \cdot A +
      -- C\cdot A = 40$.
      simp
      <;> omega
    | 6 =>
      --