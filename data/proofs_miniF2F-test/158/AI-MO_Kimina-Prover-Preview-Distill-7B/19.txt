-- 由加法的三角不等式性
  have h1: a ^ 2 / b + b + c + d ≥ a + b + c + d := by
    have h_amgm : a ^ 2 / b + b ≥ 2 * a := by
      -- 由几何平均数小于等于算术平均数得
      have h_amgm : a ^ 2 / b + b ≥ 2 * a := by
        have h₁ : a ^ 2 / b + b - 2 * a ≥ 0 := by
          calc
            a ^ 2 / b + b - 2 * a = a ^ 2 / b + b - 2 * a * b / b := by field_simp
            _ = (a ^ 2 + b ^ 2 - 2 * a * b) / b := by field_simp
            _ = (b - a) ^ 2 / b := by field_simp
            _ ≥ 0 := by
              apply div_nonneg
              _ = (b - a) ^ 2 := by ring
              _ ≥ 0 := by exact sq_nonneg (b - a)
            _ ≥ 0 := by exact div_nonneg (sq_nonneg (b - a)) (by linarith [h₀.right.left])
        linarith [h₁]
      linarith [h_amgm]
    linarith [h_amgm]

  -- 由加法的三角不等式性
  have h2: b ^ 2 / c + c + d + a ≥ b + c + d + a := by
    have h_amgm : b ^ 2 / c + c ≥ 2 * b := by
      -- 由几何平均数小于等于算术平均数得
      have h_amgm : b ^ 2 / c + c ≥ 2 * b := by
        have h₁ : b ^ 2 / c + c - 2 * b ≥ 0 := by
          calc
            b ^ 2 / c + c - 2 * b = b ^ 2 / c + c - 2 * b * c / c := by field_simp
            _ = (b ^ 2 + c ^ 2 - 2 * b * c) / c := by field_simp
            _ = (c - b) ^ 2 / c := by field_simp
            _ ≥ 0 := by
              apply div_nonneg
              _ = (c - b) ^ 2 := by ring
              _ ≥ 0 := by exact sq_nonneg (c - b)
            _ ≥ 0 := by exact div_nonneg (sq_nonneg (c - b)) (by linarith [h₀.right.left])
        linarith [h₁]
      linarith [h_amgm]
    linarith [h_amgm]

  -- 由加法的三角不等式性
  have h3: c ^ 2 / d + d + a + b ≥ c + d + a + b := by
    have h_amgm : c ^ 2 / d + d ≥ 2 * c := by
      -- 由几何平均数小于等于算术平均数得
      have h_amgm : c ^ 2 / d + d ≥ 2 * c := by
        have h₁ : c ^ 2 / d + d - 2 * c ≥ 0 := by
          calc
            c ^ 2 / d + d - 2 * c = c ^ 2 / d + d - 2 * c * d / d := by field_simp
            _ = (c ^ 2 + d ^ 2 - 2 * c * d) / d := by field_simp
            _ = (d - c) ^ 2 / d := by field_simp
            _ ≥ 0 := by
              apply div_nonneg
              _ = (d - c) ^ 2 := by ring
              _ ≥ 0 := by exact sq_nonneg (d - c)
            _ ≥ 0 := by exact div_nonneg (sq_nonneg (d - c)) (by linarith [h₀.right.left])
        linarith [h₁]
      linarith [h_amgm]
    linarith [h_amgm]

  -- 由加法的三角不等式性
  have h4: d ^ 2 / a + a + b + c ≥ d + a + b + c := by
    have h_amgm : d ^ 2 / a + a ≥ 2 * d := by
      -- 由几何平均数小于等于算术平均数得
      have h_amgm : d ^ 2 / a + a ≥ 2 * d := by
        have h₁ : d ^ 2 / a + a - 2 * d ≥ 0 := by
          calc
            d ^ 2 / a + a - 2 * d = d ^ 2 / a + a - 2 * d * a / a := by field_simp
            _ = (d ^ 2 + a ^ 2 - 2 * d * a) / a := by field_simp
            _ = (a - d) ^ 2 / a := by field_simp
            _ ≥ 0 := by
              apply div_nonneg
              _ = (a - d) ^ 2 := by ring
              _ ≥ 0 := by exact sq_nonneg (a - d)
            _ ≥ 0 := by exact div_nonneg (sq_nonneg (a - d)) (by linarith [h₀.right.left])
        linarith [h₁]
      linarith [h_amgm]
    linarith [h_amgm]

  -- 即证得
  calc
    a ^ 2 / b + b ^ 2 / c + c ^ 2 / d + d ^ 2 / a
      = (a ^ 2 / b + b) + (b ^ 2 / c + c) + (c ^ 2 / d + d) + (d ^ 2 / a + a) - (a + b + c + d) := by ring
    _ ≥ (2 * a + 2 * b + 2 * c + 2 * d) - (a + b + c + d) := by
      -- 由以上四式得
      linarith [h1, h2, h3, h4]
    _ = a + b + c + d := by
      -- 整理
      linarith

```