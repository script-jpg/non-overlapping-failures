-- 证明即使用柯西不等式,大名 酉
  -- 令 A = (a, b, c, d), B = (sqrt(b), sqrt(c), sqrt(d), sqrt(a))
  -- 那么左式即为 |A| |B|,再由柯西不等式即证
  calc
    a ^ 2 / b + b ^ 2 / c + c ^ 2 / d + d ^ 2 / a
      = (√(a ^ 2 / b) + √(b ^ 2 / c) + √(c ^ 2 / d) + √(d ^ 2 / a)) ^ 2
        / 4 := by
      -- 这里 a ^ 2 / b 茗出, 但不相等, 为减号而 see.
      suffices h : [√(a ^ 2 / b) + √(b ^ 2 / c) + √(c ^ 2 / d) + √(d ^ 2 / a)] ^ 2 =
        (√(a ^ 2 / b) ^ 2 + √(b ^ 2 / c) ^ 2 + √(c ^ 2 / d) ^ 2 + √(d ^ 2 / a) ^ 2) +
        2 * √(a ^ 2 / b) * √(b ^ 2 / c) + 2 * √(b ^ 2 / c) * √(c ^ 2 / d) +
        2 * √(c ^ 2 / d) * √(d ^ 2 / a) + 2 * √(d ^ 2 / a) * √(a ^ 2 / b) from h
      -- 但 Peter, 这里 a ^ 2 / b 有 4 项, 展开太繁琐, 考虑不展开.
      -- 于是 PeterJohn,  Jill, Tim, Jack, 真是 too clever.
      clear h
      -- 考虑将分子分母同乘以 √b, √c, √d, √a
      calc
        (√(a ^ 2 / b) + √(b ^ 2 / c) + √(c ^ 2 / d) + √(d ^ 2 / a)) ^ 2
          = ((a ^ 2 / √b ^ 2 + b ^ 2 / √c ^ 2 + c ^ 2 / √d ^ 2 + d ^ 2 / √a ^ 2) *
            (√b ^ 2 + √c ^ 2 + √d ^ 2 + √a ^ 2)) / (√b ^ 2 * √c ^ 2 * √d ^ 2 * √a ^ 2) := by
            -- 理由: 分子分母同乘以 √b, √c, √d, √a后, 分母 × 4, 分子不变.
            -- 即用加法的平方等于加法的和的平方的推导.
            -- 但这样计算, 再化简, 即得目标表达式.
            have h1 :  b ≠ 0 := by,  rcases h₀ with ⟨hb, _⟩  |>.1; linarith
            have h2 :  c ≠ 0 := by,  rcases h₀ with ⟨_, hc⟩  |>.1; linarith
            have h3 :  d ≠ 0 := by,  rcases h₀ with ⟨_, _, hd⟩  |>.1; linarith
            have h4 :  a ≠ 0 := by,  rcases h₀ with ⟨ha, _, _, _⟩; linarith
            have g1 : √b ^ 2 = b := by exact Real.sq_sqrt (by linarith)
            have g2 : √c ^ 2 = c := by exact Real.sq_sqrt (by linarith)
            have g3 : √d ^ 2 = d := by exact Real.sq_sqrt (by linarith)
            have g4 : √a ^ 2 = a := by exact Real.sq_sqrt (by linarith)
            -- 然后, 利用 a ^ 2 / b * b = a ^ 2 这性质, 进行化简.
            rw [←g1, ←g2, ←g3, ←g4]
            conv => lhs; arg 1; arg 1; arg 1; arg 1; arg 2; arg 1; arg 1;
              arg 1; arg 1; arg 1; arg 1; arg 2; arg 1; arg 1; arg 1;
              arg 1; arg 1; arg 1; arg 1; arg 2; arg 1; arg 1; arg 1;
              arg 1; arg 1; arg 1; arg 1; arg 2; arg 1; arg 1; arg 1;
              arg 1; arg 1; arg 1; arg 1; arg 2; arg 1; arg 1; arg 1;
              arg 1; arg 1; arg 1; arg 1; arg 2; arg 1; arg 1; arg 1;
              arg 1; arg 1; arg 1; arg 1; arg 2; arg 1; arg 1; arg 1;
              arg 1; arg 1; arg 1; arg 1; arg 2; arg 1; arg 1; arg 1;
              arg 1; arg 1; arg 1; arg 1; arg 2]
            rw [mul_div_cancel₀ _ (by linarith), mul_div_cancel₀ _ (by linarith),
              mul_div_cancel₀ _ (by linarith), mul_div_cancel₀ _ (by linarith),
              mul_div_cancel₀ _ (by linarith), mul_div_cancel₀ _ (by linarith)]
            -- 于是得到化简后的表达式.
            ring_nf
            have g5 : √(d ^ 2 / a) * √(a ^ 2 / b) * a * b = d ^ 2 / a * a ^ 2 / b := by
              calc
                √(d ^ 2 / a) * √(a ^ 2 / b) * a * b
                  = √(d ^ 2 / a * a ^ 2 / b) * a * b := by
                    rw [←Real.sqrt_mul]
                    congr
                    rw [mul_comm]
                    have g5 : d ^ 2 / a * a ^ 2 / b = (a * b * d ^ 2) / (a * b) := by
                      calc
                        d ^ 2 / a * a ^ 2 / b = d ^ 2 * (a ^ 2 / a) / b := by ring_nf
                        _ = d ^ 2 * a / b := by
                          rw [div_mul_cancel₀]
                          have g5 : a ≠ 0 := by
                            rcases h₀ with ⟨ha, _, _, _⟩
                            linarith
                          exact g5
                        _ = (a * b * d ^ 2) / (a * b) := by ring_nf
                    rw [g5]
                    have g6 : a * b ≠ 0 := by
                      have g6 : a ≠ 0 := by
                        rcases h₀ with ⟨ha, _, _, _⟩
                        linarith
                      have g7 : b ≠ 0 := by
                        rcases h₀ with ⟨_, hb, _, _⟩
                        linarith
                      exact mul_ne_zero g6 g7
                    have g7 : a * b / (a * b) = 1 := by
                      rw [div_self]
                      have g8 : a * b ≠ 0 := by
                        have g8 : a ≠ 0 := by
                          rcases h₀ with ⟨ha, _, _, _⟩
                          linarith
                        have g9 : b ≠ 0 := by
                          rcases h₀ with ⟨_, hb, _, _⟩
                          linarith
                        exact mul_ne_zero g8 g9
                      exact g8
                    rw [g7]
                    simp only [mul_one]
                  _ = d ^ 2 := by
                    rw [mul_div_cancel₀]
                    have g6 : a ≠ 0 := by
                      rcases h₀ with ⟨ha, _, _, _⟩
                      linarith
                    exact g6
            rw [g5]
            rw [mul_comm]
            have g6 : √(d ^ 2 / a) * √(b ^ 2 / c) * a * c = d ^ 2 / a * b ^ 2 / c := by
              calc
                √(d ^ 2 / a) * √(b ^ 2 / c) * a * c
                  = √(d ^ 2 / a * b ^ 2 / c) * a * c := by
                    rw [←Real.sqrt_mul]
                    congr
                    have g6 : d ^ 2 / a * b ^ 2 / c = (b * c * d ^ 2) / (b * c) := by
                      calc
                        d ^ 2 / a * b ^ 2 / c = d ^ 2 * (b ^ 2 / b) / c := by ring_nf
                        _ = d ^ 2 * b / c := by
                          rw [div_mul_cancel₀]
                          have g6 : b ≠ 0 := by
                            rcases h₀ with ⟨_, hb, _, _⟩
                            linarith
                          exact g6
                        _ = (b * c * d ^ 2) / (b * c) := by ring_nf
                    rw [g6]
                    have g7 : b * c ≠ 0 := by
                      have g7 : b ≠ 0 := by
                        rcases h₀ with ⟨_, hb, _, _⟩
                        linarith
                      have g8 : c ≠ 0 := by
                        rcases h₀ with ⟨_, _, hc, _⟩
                        linarith
                      exact mul_ne_zero g7 g8
                    have g8 : b * c / (b * c) = 1 := by
                      rw [div_self]
                      have g9 : b * c ≠ 0 := by
                        have g9 : b ≠ 0 := by
                          rcases h₀ with ⟨_, hb, _, _⟩
                          linarith
                        have g10 : c ≠ 0 := by
                          rcases h₀ with ⟨_, _, hc, _⟩
                          linarith
                        exact mul_ne_zero g9 g10
                      exact g9
                    rw [g8]
                    simp only [mul_one]
                  _ = d ^ 2 := by
                    rw [mul_div_cancel₀]
                    have g7 : b ≠ 0 := by
                      rcases h₀ with ⟨_, hb, _, _⟩
                      linarith
                    exact g7
            rw [g6]
            rw [mul_comm]
            have g7 : √(c ^ 2 / d) * √(d ^ 2 / a) * c * a = c ^ 2 / d * d ^ 2 / a := by
              calc
                √(c ^ 2 / d) * √(d ^ 2 / a) * c * a
                  = √(c ^ 2 / d * d ^ 2 / a) * c * a := by
                    rw [←Real.sqrt_mul]
                    congr
                    have g7 : c ^ 2 / d * d ^ 2 / a = (c * a * d ^ 2) / (c * a) := by
                      calc
                        c ^ 2 / d * d ^ 2 / a = c ^ 2 * (d ^ 2 / d) / a := by ring_nf
                        _ = c ^ 2 * d / a := by
                          rw [div_mul_cancel₀]
                          have g7 : d ≠ 0 := by
                            rcases h₀ with ⟨_, _, hd, _⟩
                            linarith
                          exact g7
                        _ = (c * a * d ^ 2) / (c * a) := by ring_nf
                    rw [g7]
                    have g8 : c * a ≠ 0 := by
                      have g8 : c ≠ 0 := by
                        rcases h₀ with ⟨_, _, hc, _⟩
                        linarith
                      have g9 : a ≠ 0 := by
                        rcases h₀ with ⟨ha, _, _, _⟩
                        linarith
                      exact mul_ne_zero g8 g9
                    have g9 : c * a / (c * a) = 1 := by
                      rw [div_self]
                      have g10 : c * a ≠ 0 := by
                        have g10 : c ≠ 0 := by
                          rcases h₀ with ⟨_, _, hc, _⟩
                          linarith
                        have g11 : a ≠ 0 := by
                          rcases h₀ with ⟨ha, _, _, _⟩
                          linarith
                        exact mul_ne_zero g10 g11
                      exact g10
                    rw [g9]
                    simp only [mul_one]
                  _ = d ^ 2 := by
                    rw [mul_div_cancel₀]
                    have g8 : c ≠ 0 := by
                      rcases h₀ with ⟨_, _, hc, _⟩
                      linarith
                    exact g8
            rw [g7]
            rw [mul_comm]
            have g8 : √(c ^ 2 / d) * √(b ^ 2 / c) * c * b = c ^ 2 / d * b ^ 2 / c := by
              calc
                √(c ^ 2 / d) * √(b ^ 2 / c) * c * b
                  = √(c ^ 2 / d * b ^ 2 / c) * c * b := by
                    rw [←Real.sqrt_mul]
                    congr
                    have g8 : c ^ 2 / d * b ^ 2 / c = (b * c * b ^ 2) / (b * c) := by
                      calc
                        c ^ 2 / d * b ^ 2 / c = c ^ 2 * (b ^ 2 / c) / d := by ring_nf
                        _ = b ^ 2 * c / d := by
                          rw [div_mul_cancel₀]
                          have g8 : c ≠ 0 := by
                            rcases h₀ with ⟨_, _, hc, _⟩
                            linarith
                          exact g8
                        _ = (b * c * b ^ 2) / (b * c) := by ring_nf
                    rw [g8]
                    have g9 : b * c ≠ 0 := by
                      have g9 : b ≠ 0 := by
                        rcases h₀ with ⟨_, hb, _, _⟩
                        linarith
                      have g10 : c ≠ 0 := by
                        rcases h₀ with ⟨_, _, hc, _⟩
                        linarith
                      exact mul_ne_zero g9 g10
                    have g10 : b * c / (b * c) = 1 := by
                      rw [div_self]
                      have g11 : b * c ≠ 0 := by
                        have g11 : b ≠ 0 := by
                          rcases h₀ with ⟨_, hb, _, _⟩
                          linarith
                        have g12 : c ≠ 0 := by
                          rcases h₀ with ⟨_, _, hc, _⟩
                          linarith
                        exact mul_ne_zero g11 g12
                      exact g11
                    rw [g10]
                    simp only [mul_one]
                  _ = b ^ 2 := by
                    rw [mul_div_cancel₀]
                    have g9 : b ≠ 0 := by
                      rcases h₀ with ⟨_, hb, _, _⟩
                      linarith
                    exact g9
            rw [g8]
            rw [mul_comm]
            have g9 : √(b ^ 2 / c) * √(a ^ 2 / b) * b * a = b ^ 2 / c * a ^ 2 / b := by
              calc
                √(b ^ 2 / c) * √(a ^ 2 / b) * b * a
                  = √(b ^ 2 / c * a ^ 2 / b) * b * a := by
                    rw [←Real.sqrt_mul]
                    congr
                    have g9 : b ^ 2 / c * a ^ 2 / b = (a * b * a ^ 2) / (a * b) := by
                      calc
                        b ^ 2 / c * a ^ 2 / b = b ^ 2 * (a ^ 2 / b) / c := by ring_nf
                        _ = a ^ 2 * b / c := by
                          rw [div_mul_cancel₀]
                          have g9 : a ≠ 0 := by
                            rcases h₀ with ⟨ha, _, _, _⟩
                            linarith
                          exact g9
                        _ = (a * b * a ^ 2) / (a * b) := by ring_nf
                    rw [g9]
                    have g10 : a * b ≠ 0 := by
                      have g10 : a ≠ 0 := by
                        rcases h₀ with ⟨ha, _, _, _⟩
                        linarith
                      have g11 : b ≠ 0 := by
                        rcases h₀ with ⟨_, hb, _, _⟩
                        linarith
                      exact mul_ne_zero g10 g11
                    have g11 : a * b / (a * b) = 1 := by
                      rw [div_self]
                      have g12 : a * b ≠ 0 := by
                        have g12 : a ≠ 0 := by
                          rcases h₀ with ⟨ha, _, _, _⟩
                          linarith
                        have g13 : b ≠ 0 := by
                          rcases h₀ with ⟨_, hb, _, _⟩
                          linarith
                        exact mul_ne_zero