-- 由_weighted AM-GM 不等式_可知, 对于任意的非负实数 $x, y$ 有 $\frac{x + y}{2} \geq \sqrt{x y}$.
  have h₁ (x y : ℝ) (hx : 0 ≤ x) (hy : 0 ≤ y) : (x + y) / 2 ≥ √(x * y) := by
    let u := √x
    let v := √y
    have hu : u * u = x := by
      simp only [u]
      exact Real.mul_self_sqrt hx
    have hv : v * v = y := by
      simp only [v]
      exact Real.mul_self_sqrt hy
    have h : (u - v) * (u - v) ≥ 0 := by
      exact mul_nonneg (by linarith) (by linarith)
    linarith

  -- 证明 diagonals 非负
  have h₂ (a b c d: ℝ) (h₀: 0 < a ∧ 0 < b ∧ 0 < c ∧ 0 < d) :  a * b - √(a * c * b * d) ≥ 0 ∧
      b * c - √(a * c * b * d) ≥ 0 ∧ c * d - √(a * c * b * d) ≥ 0 ∧
      d * a - √(a * c * b * d) ≥ 0 := by
    obtain ⟨h₁, h₂, h₃, h₄⟩ := h₀
    constructor
    · rw [show a * b = √(a ^ 2 * b ^ 2) by exact Eq.symm (Real.sqrt_mul (sq_nonneg a) (sq_nonneg b))]
      have h : √(a ^ 2 * b ^ 2) ≥ √(a * c * b * d) := by
        have h : a ^ 2 * b ^ 2 ≥ a * c * b * d := by
          calc
            _ = (a * b) ^ 2 := by linarith
            _ ≥ (a * d) * (b * c) := by
              have h : (a * d) * (b * c) = a * c * b * d := by linarith
              rw [h]
              nlinarith
            _ = _ := by linarith
        exact Real.sqrt_le_sqrt h
      exact h
    · constructor
      · rw [show b * c = √(b ^ 2 * c ^ 2) by exact Eq.symm (Real.sqrt_mul (sq_nonneg b) (sq_nonneg c))]
        have h : √(b ^ 2 * c ^ 2) ≥ √(a * c * b * d) := by
          have h : b ^ 2 * c ^ 2 ≥ a * c * b * d := by
            calc
              _ = (b * c) ^ 2 := by linarith
              _ ≥ (a * d) * (b * c) := by
                have h : (a * d) * (b * c) = a * c * b * d := by linarith
                rw [h]
                nlinarith
              _ = _ := by linarith
          exact Real.sqrt_le_sqrt h
        exact h
      · constructor
        · rw [show c * d = √(c ^ 2 * d ^ 2) by exact Eq.symm (Real.sqrt_mul (sq_nonneg c) (sq_nonneg d))]
          have h : √(c ^ 2 * d ^ 2) ≥ √(a * c * b * d) := by
            have h : c ^ 2 * d ^ 2 ≥ a * c * b * d := by
              calc
                _ = (c * d) ^ 2 := by linarith
                _ ≥ (a * b) * (c * d) := by
                  have h : (a * b) * (c * d) = a * c * b * d := by linarith
                  rw [h]
                  nlinarith
                _ = _ := by linarith
            exact Real.sqrt_le_sqrt h
          exact h
        · rw [show d * a = √(d ^ 2 * a ^ 2) by exact Eq.symm (Real.sqrt_mul (sq_nonneg d) (sq_nonneg a))]
          have h : √(d ^ 2 * a ^ 2) ≥ √(a * c * b * d) := by
            have h : d ^ 2 * a ^ 2 ≥ a * c * b * d := by
              calc
                _ = (d * a) ^ 2 := by linarith
                _ ≥ (a * c) * (b * d) := by
                  have h : (a * c) * (b * d) = a * c * b * d := by linarith
                  rw [h]
                  nlinarith
                _ = _ := by linarith
            exact Real.sqrt_le_sqrt h
          exact h

  -- full expansion
  have h₃ (a b c d: ℝ) (h₀: 0 < a ∧ 0 < b ∧ 0 < c ∧ 0 < d) : √(a ^ 2 * b ^ 2) + √(a ^ 2 * c ^ 2) +
      √(a ^ 2 * d ^ 2) + √(b ^ 2 * c ^ 2) + √(b ^ 2 * d ^ 2) + √(c ^ 2 * d ^ 2) ≥ a * b + a * c + a * d + b * c + b * d + c * d := by
    obtain ⟨h₁, h₂, h₃, h₄⟩ := h₀
    have h₅ : 0 ≤ a * b := by nlinarith
    have h₆ : 0 ≤ a * c := by nlinarith
    have h₇ : 0 ≤ a * d := by nlinarith
    have h₈ : 0 ≤ b * c := by nlinarith
    have h₉ : 0 ≤ b * d := by nlinarith
    have h₁₀ : 0 ≤ c * d := by nlinarith
    have h₁₁ : 0 ≤ √(a ^ 2 * b ^ 2) := by
      simp only [show a ^ 2 * b ^ 2 = (a * b) ^ 2 by linarith, Real.sqrt_sq]
      exact abs_nonneg (a * b)
    have h₁₂ : 0 ≤ √(a ^ 2 * c ^ 2) := by
      simp only [show a ^ 2 * c ^ 2 = (a * c) ^ 2 by linarith, Real.sqrt_sq]
      exact abs_nonneg (a * c)
    have h₁₃ : 0 ≤ √(a ^ 2 * d ^ 2) := by
      simp only [show a ^ 2 * d ^ 2 = (a * d) ^ 2 by linarith, Real.sqrt_sq]
      exact abs_nonneg (a * d)
    have h₁₄ : 0 ≤ √(b ^ 2 * c ^ 2) := by
      simp only [show b ^ 2 * c ^ 2 = (b * c) ^ 2 by linarith, Real.sqrt_sq]
      exact abs_nonneg (b * c)
    have h₁₅ : 0 ≤ √(b ^ 2 * d ^ 2) := by
      simp only [show b ^ 2 * d ^ 2 = (b * d) ^ 2 by linarith, Real.sqrt_sq]
      exact abs_nonneg (b * d)
    have h₁₆ : 0 ≤ √(c ^ 2 * d ^ 2) := by
      simp only [show c ^ 2 * d ^ 2 = (c * d) ^ 2 by linarith, Real.sqrt_sq]
      exact abs_nonneg (c * d)
    have h₁₇ : 0 ≤ a * b - √(a * c * b * d) := by
      apply sub_nonneg.mpr
      exact h₁ a b h₅ h₆
    have h₁₈ : 0 ≤ b * c - √(a * c * b * d) := by
      apply sub_nonneg.mpr
      exact h₁ b c h₅ h₈
    have h₁₉ : 0 ≤ c * d - √(a * c * b * d) := by
      apply sub_nonneg.mpr
      exact h₁ c d h₇ h₉
    have h₂₀ : 0 ≤ d * a - √(a * c * b * d) := by
      apply sub_nonneg.mpr
      exact h₁ d a h₇ h₄
    have h₂₁ : √(a ^ 2 * b ^ 2) + √(a ^ 2 * c ^ 2) + √(a ^ 2 * d ^ 2) + √(b ^ 2 * c ^ 2) + √(b ^ 2 * d ^ 2) +
        √(c ^ 2 * d ^ 2) ≥ a * b + a * c + a * d + b * c + b * d + c * d := by
      calc
        √(a ^ 2 * b ^ 2) + √(a ^ 2 * c ^ 2) + √(a ^ 2 * d ^ 2) + √(b ^ 2 * c ^ 2) + √(b ^ 2 * d ^ 2) + √(c ^ 2 * d ^ 2)
          = (√(a ^ 2 * b ^ 2) - √(a * c * b * d)) + (√(a ^ 2 * c ^ 2) - √(a * c * b * d)) +
            (√(a ^ 2 * d ^ 2) - √(a * c * b * d)) + (√(b ^ 2 * c ^ 2) - √(a * c * b * d)) +
            (√(b ^ 2 * d ^ 2) - √(a * c * b * d)) + (√(c ^ 2 * d ^ 2) - √(a * c * b * d)) + 6 * √(a * c * b * d) := by ring
        _ ≥ 0 + 0 + 0 + 0 + 0 + 0 + 6 * √(a * c * b * d) := by
            apply add_le_add
            · apply add_le_add
              · apply add_le_add
                · apply sub_nonneg.mpr; exact h₁₇
                · apply sub_nonneg.mpr; exact h₁₈
              · apply add_le_add
                · apply sub_nonneg.mpr; exact h₁₉
                · apply sub_nonneg.mpr; exact h₂₀
            · apply add_le_add
              · apply sub_nonneg.mpr; exact h₁₇
              · apply sub_nonneg.mpr; exact h₁₈
            · apply sub_nonneg.mpr; exact h₁₉
            · apply sub_nonneg.mpr; exact h₂₀
        _ = 6 * √(a * c * b * d) := by ring
    linarith

  -- 由_算术平均和几何平均不等式_可知, 对于任意的非负实数 $x, y$ 有 $x + y \geq 2 \sqrt{x y}$.
  have h₄ (x y : ℝ) (hx : 0 ≤ x) (hy : 0 ≤ y) : x + y ≥ 2 * √(x * y) := by
    have h : (x + y) ^ 2 ≥ (2 * √(x * y)) ^ 2 := by
      apply pow_le_pow_left₀ (by linarith) (by linarith)
      calc
        _ = x * y + x * y := by
          rw [show (2 * √(x * y)) ^ 2 = 4 * (√(x * y) ^ 2) by ring]
          rw [show √(x * y) ^ 2 = x * y by exact Real.sq_sqrt (by positivity)]
          ring
        _ ≤ x * y + x + y := by
          have h : x + y ≥ 0 := by
            linarith
          apply mul_le_mul
          repeat linarith
    apply sq_le_sq.mp at h
    cases' abs_cases (x + y) with h h <;> cases' abs_cases (√(x * y)) with h₁ h₁ <;> simp_all [h₁] <;> linarith

  -- 证明 halving diagonals 非负
  have h₅ (a b c d: ℝ) (h₀: 0 < a ∧ 0 < b ∧ 0 < c ∧ 0 < d) : a * b / 2 - √(a * c * b * d) / 2 ≥ 0 ∧
      b * c / 2 - √(a * c * b * d) / 2 ≥ 0 ∧ c * d / 2 - √(a * c * b * d) / 2 ≥ 0 ∧
      d * a / 2 - √(a * c * b * d) / 2 ≥ 0 := by
    obtain ⟨h₁, h₂, h₃, h₄⟩ := h₀
    constructor
    · rw [show a * b / 2 = (a * b) / 2 by ring]
      have h : √(a * c * b * d) ≤ a * b / 2 := by
        calc
          _ ≤ (a * d + b * c) / 2 := by
            let u := a * d
            let v := b * c
            have hu : u * u = a * c * b * d := by
              ring_nf
            have hv : v * v = a * c * b * d := by
              ring_nf
            have h : (u - v) * (u - v) ≥ 0 := by
              exact mul_nonneg (by linarith) (by linarith)
            have h : a * c * b * d ≥ 0 := by
              positivity
            rw [←mul_assoc, ←mul_assoc, ←hu, ←hv]
            exact sq_nonneg (u - v)
          _ = (a * b + √(a * c * b * d)) / 2 := by
            rw [show a * d + b * c = a * b - √(a * c * b * d) + 2 * √(a * c * b * d) := by linarith]
            rw [show a * b - √(a * c * b * d) + 2 * √(a * c * b * d) = a * b + √(a * c * b * d) := by linarith]
          _ ≤ (a * b + a * b) / 2 := by
            apply div_le_div_of_nonneg_right
            linarith
            linarith
          _ = _ := by ring
      linarith
    · constructor
      · rw [show b * c / 2 = (b * c) / 2 by ring]
        have h : √(a * c * b * d) ≤ b * c / 2 := by
          calc
            _ ≤ (a * d + b * c) / 2 := by
              let u := a * d
              let v := b * c
              have hu : u * u = a * c * b * d := by
                ring_nf
              have hv : v * v = a * c * b * d := by
                ring_nf
              have h : (u - v) * (u - v) ≥ 0 := by
                exact mul_nonneg (by linarith) (by linarith)
              have h : a * c * b * d ≥ 0 := by
                positivity
              rw [←mul_assoc, ←mul_assoc, ←hu, ←hv]
              exact sq_nonneg (u - v)
            _ = (b * c + √(a * c * b * d)) / 2 := by
              rw [show a * d + b * c = a * b - √(a * c * b * d) + 2 * √(a * c * b * d) := by linarith]
              rw [show a * b - √(a * c * b * d) + 2 * √(a * c * b * d) = a * b + √(a * c * b * d) := by linarith]
            _ ≤ (b * c + b * c) / 2 := by
              apply div_le_div_of_nonneg_right
              linarith
              linarith
            _ = _ := by ring
          linarith
        linarith
      · constructor
        · rw [show c * d / 2 = (c * d) / 2 by ring]
          have h : √(a * c * b * d) ≤ c * d / 2 := by
            calc
              _ ≤ (a * d + b * c) / 2 := by
                let u := a * d
                let v := b * c
                have hu : u * u = a * c * b * d := by
                  ring_nf
                have hv : v * v = a * c * b * d := by
                  ring_nf
                have h : (u - v) * (u - v) ≥ 0 := by
                  exact mul_nonneg (by linarith) (by linarith)
                have h : a * c * b * d ≥ 0 := by
                  positivity
                rw [←mul_assoc, ←mul_assoc, ←