-- We need the following lemma to prove the inequality:
  -- For positive reals $x, y$, we have $x^2 y^2 (x^2 + y^2) \le (x^2 + xy + y^2)^3$.
  have lm (x y : ℝ) (h₀ : 0 < x) (h₁ : 0 < y) : x ^ 2 * y ^ 2 * (x ^ 2 + y ^ 2) ≤ (x ^ 2 + x * y + y ^ 2) ^ 3 := by
    -- equivalent to $(xy-1)^2 (x^2+y^2+xy)^2 \ge 0$
    nlinarith [sq_nonneg (x * y - 1), sq_nonneg (x ^ 2 + y ^ 2 + x * y)]

  -- We can assume $a \le b \le c$.
  wlog h : a ≤ b ∧ b ≤ c
  · -- Prove that the conditions are invariant under cyclic permutation.
    have h₄ : a < b + c := by linarith
    have h₅ : b < a + c := by linarith
    have h₆ : c < a + b := by linarith
    have h₇ : a + b - c > 0 := by linarith
    have h₈ : b + c - a > 0 := by linarith
    have h₉ : c + a - b > 0 := by linarith
    have h₁₀ : a * b * c > 0 := by positivity
    -- Consider instead the equivalent inequality
    -- $a^2(b+c-a) \le b^2(c+a-b) + c^2(a+b-c) + 3abc$.
    suffices a ^ 2 * (b + c - a) ≤ b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) + 3 * a * b * c by
      convert this using 1
      ring
    -- We can drop the assumption $a \le b \le c$.
    simp at h
    -- There are $6$ cases for the assumption.
    rcases h with ((h | h) | h) | ((h | h) | h) | (h | h)
    -- In the first case, $a \le b \le c$.
    · convert @im o_1964_p2 (b) c a (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the second case, $a \le c \le b$.
    · convert @im o_1964_p2 (a) c b (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the third case, $b \le a \le c$.
    · convert @im o_1964_p2 a b c (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the fourth case, $b \le c \le a$.
    · convert @im o_1964_p2 b c a (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the fifth case, $c \le a \le b$.
    · convert @im o_1964_p2 c a b (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the sixth case, $c \le b \le a$.
    · convert @im o_1964_p2 c b a (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring

  -- We can assume $0 < b \le a \le c$.
  wlog h : 0 < b ∧ b ≤ a ∧ a ≤ c
  · -- Prove that the conditions are invariant under cyclic permutation.
    have h₄ : a < b + c := by linarith
    have h₅ : b < a + c := by linarith
    have h₆ : c < a + b := by linarith
    have h₇ : a * b * c > 0 := by positivity
    -- Consider instead the equivalent inequality
    -- $a^2(b+c-a) \le b^2(c+a-b) + c^2(a+b-c) + 3abc$.
    suffices a ^ 2 * (b + c - a) ≤ b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) + 3 * a * b * c by
      convert this using 1
      ring
    -- We can drop the assumption $0 < b \le a \le c$.
    simp at h
    -- There are $6$ cases for the assumption.
    rcases h with ((h | h) | h) | ((h | h) | h) | (h | h)
    -- In the first case, $0 < b \le a \le c$.
    · convert @im o_1964_p2 b a c (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the second case, $0 < a \le b \le c$.
    · convert @im o_1964_p2 a b c (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the third case, $0 < b \le c \le a$.
    · convert @im o_1964_p2 b c a (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the fourth case, $0 < c \le a \le b$.
    · convert @im o_1964_p2 c a b (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the fifth case, $0 < c \le b \le a$.
    · convert @im o_1964_p2 c b a (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the sixth case, $0 < a \le c \le b$.
    · convert @im o_1964_p2 a c b (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring

  -- We can assume $0 < a \le b \le c$.
  wlog h : 0 < a ∧ a ≤ b ∧ b ≤ c
  · -- Prove that the conditions are invariant under cyclic permutation.
    have h₄ : a < b + c := by linarith
    have h₅ : b < a + c := by linarith
    have h₆ : c < a + b := by linarith
    have h₇ : a * b * c > 0 := by positivity
    -- Consider instead the equivalent inequality
    -- $a^2(b+c-a) \le b^2(c+a-b) + c^2(a+b-c) + 3abc$.
    suffices a ^ 2 * (b + c - a) ≤ b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) + 3 * a * b * c by
      convert this using 1
      ring
    -- We can drop the assumption $0 < a \le b \le c$.
    simp at h
    -- There are $3! = 6$ cases for the assumption.
    rcases h with ((h | h) | h) | ((h | h) | h) | (h | h)
    -- In the first case, $0 < a \le b \le c$.
    · convert @im o_1964_p2 a b c (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the second case, $0 < a \le c \le b$.
    · convert @im o_1964_p2 a c b (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring
    -- In the third case, $0 < b \le a \le c$.
    · convert @im o_1964_p2 b a c (by linarith) (by linarith) (by linarith) (by nlinarith) (by nlinarith) (by nlinarith) (by nlinarith)
      · ring
      · ring
      · ring

  -- Now we need to prove the inequality under the assumption $0 < a \le b \le c$.
  -- We divide the proof into three steps:

  -- Step 1: Use the condition $a \le b \le c$ to compare $a z - a$ and $b z - b$.
  have lm_1 {x y z : ℝ} (h₀ : 0 < x) (h₁ : x ≤ y) (h₂ : z > 0) : x * z - x ≤ y * z - y := by
    calc
      _ = y * z - y - (y * z - x * z) + x - x := by ring
      _ ≤ y * z - y - (x * z - x * z) + x - x := by linarith only [h₁]
      _ = y * z - y - (y - x) + x - x := by ring
      _ ≤ y * z - y - 0 + x - x := by linarith only [h₁]
      _ = _ := by ring

  -- Step 2: Use the condition $a \le b \le c$ to compare $(a z - a)² z²$ and $(b z - b)² z²$.
  have lm_2 {x y z : ℝ} (h₀ : 0 < x) (h₁ : x ≤ y) (h₂ : z > 0) : (x * z - x) ^ 2 * z ^ 2 ≤ (y * z - y) ^ 2 * z ^ 2 := by
    calc
      _ = (y * z - y) ^ 2 * z ^ 2 - ((y * z - x * z) ^ 2 - (y - x) ^ 2) * z ^ 2 + ((y - x) ^ 2 - (y - x) ^ 2) * z ^ 2 := by ring
      _ ≤ (y * z - y) ^ 2 * z ^ 2 - ((y * z - x * z) ^ 2 - (y - x) ^ 2) * z ^ 2 + 0 := by linarith only [h₂]
      _ = _ := by ring

  -- Step 3: Use the condition $a \le b \le c$ to compare $(a z - a)² z² (a² + b²)$ and $(b z - b)² z² (b² + c²)$.
  have lm_3 {x y z : ℝ} (h₀ : 0 < x) (h₁ : x ≤ y) (h₂ : z > 0) : (x * z - x) ^ 2 * z ^ 2 * (x ^ 2 + y ^ 2) ≤ (y * z - y) ^ 2 * z ^ 2 * (y ^ 2 + c ^ 2) := by
    calc
      _ = (y * z - y) ^ 2 * z ^ 2 * (y ^ 2 + c ^ 2) - ((y * z - x * z) ^ 2 - (y - x) ^ 2) * z ^ 2 * (x ^ 2 + y ^ 2) + ((y - x) ^ 2 - (y - x) ^ 2) * z ^ 2 * (x ^ 2 + y ^ 2) := by ring
      _ ≤ (y * z - y) ^ 2 * z ^ 2 * (y ^ 2 + c ^ 2) - ((y * z - x * z) ^ 2 - (y - x) ^ 2) * z ^ 2 * (x ^ 2 + y ^ 2) + 0 := by linarith only [h₂]
      _ = _ := by ring

  -- Now we can start the main proof.
  -- We split the expression into three terms.
  have h₀ : a ^ 2 * (b + c - a) + b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) = a ^ 2 * (b + c - a) + (b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c)) := by ring
  rw [h₀]

  -- Compare the first term with the second term.
  have h₁ : a ^ 2 * (b + c - a) ≤ b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) + 3 * a * b * c := by
    calc
      _ = a ^ 2 * (b + c - a) + (b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) + 3 * a * b * c) - (b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) + 3 * a * b * c) + (b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) + 3 * a * b * c) := by ring
      _ ≤ b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) + 3 * a * b * c := by linarith only [sq_nonneg (a - b), sq_nonneg (b - c), sq_nonneg (c - a)]

  -- Compare the second term with the third term.
  have h₂ : b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) + 3 * a * b * c ≤ b ^ 2 * (c + a - b) + c ^ 2 * (a + b - c) + 3 * a * b * c := by
    _ ≤ _ := by rfl

  -- Now the inequality is proved.
  linarith only [h₁, h₂]
```