-- prime numbers are either less or greater than 1
  have prime_lt_or_gt_one {p : ℕ} (hp : Nat.Prime p) : p < 1 ∨ p > 1 := by
    rcases hp with ⟨hp1, hp2⟩
    have : p ≠ 1 := by
      exact Nat.Prime.ne_one hp
    have : p ≤ 1 := by
      exact (Nat.Prime.two_le hp).symm
    interval_cases p
    exact Or.inr (by rfl)
    exact Or.inl (by rfl)
    exact Or.inr (by rfl)

  -- if $a$ is a ratio of integers then $f(a)$ is a ratio of $f$ of those integers.
  have f_ratio {a b : ℤ} (hb : b ≠ 0) : f (a / b) = f a / f b := by
    have h2 : f b ≠ 0 := by
      rcases b with d | d | d | d | d | d | d | d | d | d | d | d | d | d | d
      any_goals norm_num
      rw [d]; exact hp d
      any_goals norm_num
    have h3 : f (a / b) = f (a * (1 / b)) := by
      rw [div_eq_mul_inv]
    rw [h3, h₀ a (by norm_num) b (by norm_num)]
    rw [h₀ (1/b) (by norm_num) a (by norm_num)]
    rw [one_div, mul_comm, mul_div_assoc, h2, div_eq_mul_inv]
    simp only [Int.cast_div, Int.cast_one, h2, inv_mul_cancel₀]
    ring

  -- if $a$ is a positive integer then $f(a)$ is equal to the sum of $f$ of those 1's.
  have f_ofNat (a : ℕ) : f a = a * f 1 := by
    induction a with
    | zero =>
      norm_num
    | succ n ih =>
      norm_cast
      rw [h₀ (n+1) (by norm_num) 1 (by norm_num), ih, mul_add, h₀ 1 (by norm_num) 1 (by norm_num)]
      norm_num

  -- thus $f(1)=1$.
  have f_one : f 1 = 1 := by
    specialize h₁ 2 (by norm_num)
    rw [f_ofNat 2, mul_comm] at h₁
    norm_num at h₁
    exact h₁

  -- if $a$ is a positive integer then $f(a)$ is equal to $a$.
  have f_int {a : ℤ} (ha : 0 < a) : f a = a := by
    specialize f_ofNat a
    rw [f_one] at f_ofNat
    norm_cast at f_ofNat ⊢
    exact f_ofNat

  -- for a positive rational number $r$, $f(r)>0$.
  have f_pos_of_pos {r : ℚ} (hr : r > 0) : f r > 0 := by
    specialize f r
    specialize f_rational r
    rcases r with a | a | a | a | a | a | a | a | a | a | a | a | a | a | a
    any_goals norm_num
    any_goals rw [f_int, f_rational]; any_goals norm_num
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio, f_int, f_rational]; norm_num; linarith
    rw [f_ratio,