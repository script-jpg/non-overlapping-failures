-- We shall prove that $D_n$ is even when $n$ is congruent to $1$ modulo $3$.
  have h_a {n : ℕ} (h : n ≡ 1 [MOD 3]) : Even (d n) := by

    -- The claim will be proved by induction on $n$.
    induction n using Nat.strong_induction_on with
    | h_n hn =>
      -- The base case is trivial.
      by_cases hn' : n < 3
      · interval_cases n
        · rw [h₀]
          exact even_zero
        · rw [h₁]
          exact even_zero
        · rw [h₂]
          exact ⟨0, by norm_num⟩

      -- For the induction step, we assume the claim holds for all numbers below $n$.
      have h_nmod : n % 3 = 1 := by
        exact hn
      have h_n_minus_1 : n - 1 ≡ 0 [MOD 3] := by
        apply Nat.ModEq.sub h_nmod
        simp
      have h_n_minus_1' : n - 1 = 3 * (n / 3 - 1) + 2 := by
        apply Eq.symm (Nat.div_add_mod (n - 1) 3)
        rw [h_nmod]
        norm_num
      have h_n_minus_1'' : n - 1 < 3 * (n / 3 - 1) + 3 := by
        rw [h_n_minus_1']
        omega
      have h_n_minus_3 : n - 3 ≡ 0 [MOD 3] := by
        apply Nat.ModEq.sub
        · exact h_nmod
        · simp
      have h_n_minus_3' : n - 3 = 3 * (n / 3 - 1) := by
        apply Eq.symm (Nat.div_add_mod (n - 3) 3)
        rw [h_nmod]
        norm_num
      have h_n_minus_3'' : n - 3 < 3 * (n / 3 - 1) + 3 := by
        rw [h_n_minus_3']
        omega

      -- Now we consider two cases: $n$ is less than $4$ or greater than or equal to $4$.
      by_cases hn'' : n ≤ 2
      · interval_cases n
        · rw [h₀]
          exact even_zero
        · rw [h₁]
          exact even_zero
        · rw [h₂]
          exact ⟨0, by norm_num⟩
      · have hn'' : n ≥ 4 := by omega

        -- The induction hypothesis now applies to $n-1$ and $n-3$.
        have h_n_minus_1_ind := hn (n - 1) (by omega) (by omega)
        have h_n_minus_3_ind := hn (n - 3) (by omega) (by omega)

        -- We break up the final goal into three goals.
        refine ⟨?_,?_,?_⟩

        -- The first goal is proved by applying the induction hypothesis to $n-1$ and then adding the two sides.
        · rw [h₃ (n - 1) (by omega), Nat.even_add]
          apply h_n_minus_1_ind
          apply h_n_minus_3_ind

        -- The second goal is proved by applying the induction hypothesis to $n-1$ and then adding the two sides.
        · rw [h₃ (n - 1) (by omega), Nat.even_add]
          apply h_n_minus_1_ind
          apply h_n_minus_3_ind

        -- The third goal is proved by applying the induction hypothesis to $n-3$.
        · rw [h₃ (n - 3) (by omega), Nat.even_add]
          apply h_n_minus_3_ind

  -- We shall prove that $D_n$ is odd when $n$ is congruent to $2$ modulo $3$.
  have h_b {n : ℕ} (h : n ≡ 2 [MOD 3]) : Odd (d n) := by
    -- The claim will be proved by induction on $n$.
    induction n using Nat.strong_induction_on with
    | h_n hn =>
      -- The base case is trivial.
      by_cases hn' : n < 3
      · interval_cases n
        · rw [h₀]
          exact even_zero
        · rw [h₁]
          exact even_zero
        · rw [h₂]
          exact ⟨0, by norm_num⟩

      -- For the induction step, we assume the claim holds for all numbers below $n$.
      have h_nmod : n % 3 = 2 := by
        exact h
      have h_n_minus_1 : n - 1 ≡ 1 [MOD 3] := by
        apply Nat.ModEq.sub h_nmod
        simp
      have h_n_minus_1' : n - 1 = 3 * (n / 3 - 1) + 1 := by
        apply Eq.symm (Nat.div_add_mod (n - 1) 3)
        rw [h_nmod]
        norm_num
      have h_n_minus_1'' : n - 1 < 3 * (n / 3 - 1) + 3 := by
        rw [h_n_minus_1']
        omega
      have h_n_minus_3 : n - 3 ≡ 2 [MOD 3] := by
        apply Nat.ModEq.sub
        · exact h_nmod
        · simp
      have h_n_minus_3' : n - 3 = 3 * (n / 3 - 1) := by
        apply Eq.symm (Nat.div_add_mod (n - 3) 3)
        rw [h_nmod]
        norm_num
      have h_n_minus_3'' : n - 3 < 3 * (n / 3 - 1) + 3 := by
        rw [h_n_minus_3']
        omega

      -- Now we consider two cases: $n$ is less than $4$ or greater than or equal to $4$.
      by_cases hn'' : n ≤ 2
      · interval_cases n
        · rw [h₀]
          exact even_zero
        · rw [h₁]
          exact even_zero
        · rw [h₂]
          exact ⟨0, by norm_num⟩
      · have hn'' : n ≥ 4 := by omega

        -- The induction hypothesis now applies to $n-1$ and $n-3$.
        have h_n_minus_1_ind := hn (n - 1) (by omega) (by omega)
        have h_n_minus_3_ind := hn (n - 3) (by omega) (by omega)

        -- We break up the final goal into three goals.
        refine ⟨?_,?_,?_⟩

        -- The first goal is proved by applying the induction hypothesis to $n-1$ and then adding the two sides.
        · rw [h₃ (n - 1) (by omega), Nat.even_add]
          apply h_n_minus_1_ind
          apply h_n_minus_3_ind

        -- The second goal is proved by applying the induction hypothesis to $n-1$ and then adding the two sides.
        · rw [h₃ (n - 1) (by omega), Nat.even_add]
          apply h_n_minus_1_ind
          apply h_n_minus_3_ind

        -- The third goal is proved by applying the induction hypothesis to $n-3$.
        · rw [h₃ (n - 3) (by omega), Nat.even_add]
          apply h_n_minus_3_ind

  -- We shall prove that $D_n$ is even when $n$ is congruent to $0$ modulo $3$.
  have h_c {n : ℕ} (h : n ≡ 0 [MOD 3]) : Even (d n) := by
    -- The claim will be proved by induction on $n$.
    induction n using Nat.strong_induction_on with
    | h_n hn =>
      -- The base case is trivial.
      by_cases hn' : n < 3
      · interval_cases n
        · rw [h₀]
          exact even_zero
        · rw [h₁]
          exact even_zero
        · rw [h₂]
          exact ⟨0, by norm_num⟩

      -- For the induction step, we assume the claim holds for all numbers below $n$.
      have h_nmod : n % 3 = 0 := by
        exact h
      have h_n_minus_1 : n - 1 ≡ 2 [MOD 3] := by
        apply Nat.ModEq.sub h_nmod
        simp
      have h_n_minus_1' : n - 1 = 3 * (n / 3 - 1) + 2 := by
        apply Eq.symm (Nat.div_add_mod (n - 1) 3)
        rw [h_nmod]
        norm_num
      have h_n_minus_1'' : n - 1 < 3 * (n / 3 - 1) + 3 := by
        rw [h_n_minus_1']
        omega
      have h_n_minus_3 : n - 3 ≡ 0 [MOD 3] := by
        apply Nat.ModEq.sub
        · exact h_nmod
        · simp
      have h_n_minus_3' : n - 3 = 3 * (n / 3 - 1) := by
        apply Eq.symm (Nat.div_add_mod (n - 3) 3)
        rw [h_nmod]
        norm_num
      have h_n_minus_3'' : n - 3 < 3 * (n / 3 - 1) + 3 := by
        rw [h_n_minus_3']
        omega

      -- Now we consider two cases: $n$ is less than $4$ or greater than or equal to $4$.
      by_cases hn'' : n ≤ 2
      · interval_cases n
        · rw [h₀]
          exact even_zero
        · rw [h₁]
          exact even_zero
        · rw [h₂]
          exact ⟨0, by norm_num⟩
      · have hn'' : n ≥ 4 := by omega

        -- The induction hypothesis now applies to $n-1$ and $n-3$.
        have h_n_minus_1_ind := hn (n - 1) (by omega) (by omega)
        have h_n_minus_3_ind := hn (n - 3) (by omega) (by omega)

        -- We break up the final goal into three goals.
        refine ⟨?_,?_,?_⟩

        -- The first goal is proved by applying the induction hypothesis to $n-1$ and then adding the two sides.
        · rw [h₃ (n - 1) (by omega), Nat.even_add]
          apply h_n_minus_1_ind
          apply h_n_minus_3_ind

        -- The second goal is proved by applying the induction hypothesis to $n-1$ and then adding the two sides.
        · rw [h₃ (n - 1) (by omega), Nat.even_add]
          apply h_n_minus_1_ind
          apply h_n_minus_3_ind

        -- The third goal is proved by applying the induction hypothesis to $n-3$.
        · rw [h₃ (n - 3) (by omega), Nat.even_add]
          apply h_n_minus_3_ind

  -- We shall now prove the final result.
  have mod_3_1 : 2021 ≡ 1 [MOD 3] := by
    norm_num [Nat.ModEq]
  have mod_3_2 : 2022 ≡ 0 [MOD 3] := by
    norm_num [Nat.ModEq]
  have mod_3_3 : 2023 ≡ 2 [MOD 3] := by
    norm_num [Nat.ModEq]

  -- We apply the three lemmas we proved earlier.
  have h_a' := h_a mod_3_1
  have h_b' := h_b mod_3_2
  have h_c' := h_c mod_3_3

  -- We break up the final goal into three goals.
  refine ⟨?_,?_,?_⟩

  -- The first goal is proved by applying the lemma h_a'.
  · exact h_a'

  -- The second goal is proved by applying the lemma h_b'.
  · exact h_b'

  -- The third goal is proved by applying the lemma h_c'.
  · exact h_c'
```