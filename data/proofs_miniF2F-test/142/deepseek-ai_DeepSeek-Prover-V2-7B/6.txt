have step₁ : S.card = 672 := by
    have h₁ : S = Finset.filter (fun k => k > 0) (Finset.filter (fun k => (k * k : ℕ) ∣ ∏ i in Finset.Icc 1 9, i!) (Finset.range 10000)) := by
      ext k
      simp [h₀, Nat.lt_succ_iff]
      <;>
      by_cases h : k > 0 <;>
      by_cases h' : (k * k : ℕ) ∣ ∏ i in Finset.Icc 1 9, i! <;>
      simp_all [Nat.lt_succ_iff] <;>
      (try omega) <;>
      (try
        {
          have h₁ : k ≤ 9999 := by
            by_contra h₁
            have h₂ : k ≥ 10000 := by omega
            have h₃ : (k * k : ℕ) > ∏ i in Finset.Icc 1 9, i! := by
              have : ∏ i in Finset.Icc 1 9, i! > 0 := by positivity
              nlinarith
            simp_all [Nat.dvd_iff_mod_eq_zero, Nat.mod_eq_of_lt]
            <;> nlinarith
          interval_cases k <;> norm_num [Finset.prod_Icc_succ_top, Nat.factorial_succ] at * <;>
            omega }) <;>
      (try omega) <;>
      aesop
    rw [h₁]
    rfl
  
  rw [step₁]
  <;> rfl
```