have h₁ : S = Finset.filter (fun k => k * k ∣ ∏ i in Finset.Icc 1 9, i!) (Finset.Icc 1 99) := by
    ext k
    simp only [Finset.mem_filter, Finset.mem_Icc, h₀, and_assoc]
    constructor
    · intro h
      have h₁ : k ≤ 99 := by
        have h₂ : k ≤ 9 := by
          have h₃ : k * k ∣ ∏ i in Finset.Icc 1 9, i! := h.2
          have h₄ : k ≤ 9 := by
            by_contra! h₅
            have h₆ : k ≥ 10 := by linarith
            have h₇ : k * k > ∏ i in Finset.Icc 1 9, i! := by
              have : ∏ i in Finset.Icc 1 9, i! = 362880 := by decide
              have : k * k > 362880 := by nlinarith
              simp_all
            have h₈ : k * k ∣ ∏ i in Finset.Icc 1 9, i! := h.2
            have h₉ : k * k ≤ ∏ i in Finset.Icc 1 9, i! := Nat.le_of_dvd (by positivity) h₈
            nlinarith
          linarith
        nlinarith
      constructor <;> omega
    · intro h
      have h₁ : k ≤ 99 := h.2
      have h₂ : 0 < k := by
        by_contra! h₃
        have h₄ : k = 0 := by omega
        simp_all
      have h₃ : k * k ∣ ∏ i in Finset.Icc 1 9, i! := by
        have : k ≤ 9 := by omega
        interval_cases k <;> norm_num [Finset.prod_Icc_succ_top, Nat.factorial] at * <;>
          try { omega } <;> try { aesop }
      exact ⟨by omega, h₃⟩
  
  have h₂ : S.card = 672 := by
    rw [h₁]
    rfl
  
  rw [h₂]
  <;> rfl
```