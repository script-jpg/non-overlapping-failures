have step₁ : S.card = 672 := by
    have h₁ : S = Finset.filter (fun k => k * k ∣ ∏ i in Finset.Icc 1 9, i!) (Finset.Icc 1 362880) := by
      ext k
      simp only [h₀, Finset.mem_filter, Finset.mem_Icc, true_and_iff, and_true_iff]
      <;>
        constructor <;> intro h <;> simp_all [Nat.factorial_succ, Nat.mul_assoc] <;>
        norm_num at * <;>
        (try {
          have h₂ : k ≤ 362880 := by
            have h₃ : k ≤ 9 := by
              by_contra h₄
              have h₅ : k ≥ 10 := by linarith
              have h₆ : k * k > 362880 := by nlinarith
              nlinarith
            interval_cases k <;> norm_num at * <;>
              simp_all [Nat.factorial] <;>
              (try omega) <;>
              (try nlinarith) <;>
              (try omega)
          omega
        }) <;>
        (try {
          have h₂ : k ≥ 1 := by nlinarith
          nlinarith
        }) <;>
        (try {
          omega
        }) <;>
        (try {
          norm_num at *
          <;>
          aesop
        })
    rw [h₁]
    rfl
  
  exact step₁
```