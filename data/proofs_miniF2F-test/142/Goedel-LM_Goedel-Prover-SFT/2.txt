have I1 : ∀ k : ℕ, k * k ∣ ∏ i in Finset.Icc 1 9, i! ↔ k ∣ ∏ i in Finset.Icc 1 9, i! := by
    refine' fun k => (Iff.intro _ fun h₂ => _)
    · rintro ⟨a, e⟩
      rw [mul_one] at e
      rwa [e, Nat.mul_dvd_mul_iff_right (Nat.prod_pos fun _ _ => Nat.factorial_pos _)]
    · intro
      refine' ⟨k, _⟩
      simp [Nat.mul_left_comm]
  simp [h₀, I1]
  have I2 : ∀ k : ℕ, k ∈ S ↔ 0 < k ∧ k ∣ ∏ i in Finset.Icc 1 9, i! := by simp [and_congr_right_iff]
  simp [I2, Finset.card_eq_sum_ones, Finset.sum_filter, Nat.divisors]
  -- The rest of the proof is essentially just computation.
  rfl
  <;> decide
```