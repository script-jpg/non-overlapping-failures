-- We show that $2^k \equiv 2^{k \bmod 3} \pmod{7}$.
  have hmod : ∀ k, 2 ^ k % 7 = 2 ^ (k % 3) % 7 := by
    intro k
    -- This is because $2^3 \equiv 1 \pmod{7}$.
    change 2 ^ 3 ≡ 1 [MOD 7]
    exact rfl
    -- So $2^k \equiv 2^{k \bmod 3} \pmod{7}$.
    rw [Nat.modEq_iff_dvd, ←pow_mul, Nat.pow_mod]
    rw [Nat.pow_mod]
    exact ⟨0, Nat.mod_eq_of_lt (Nat.succ_pos _)⟩
  -- Sum the volumes of the cylinder and the cone.
  have eq : (∑ k in Finset.range 101, 2 ^ k) % 7 = (2 ^ 101 - 1) % 7 := by
    rw [Finset.sum_geometric, Nat geometric Series_sum_eq, Nat one_lt_pow]
    rw [Nat.pow_lt_pow_iff_right]
    exact Nat.zero_lt_one
    rw [Nat.pow_le_pow_iff_right]
    exact Nat.one_le_ofNat 101
    rw [Nat.one_lt_pow]
    exact Nat.zero_lt_one

    rw [(Finset.sum_const one : Finset.range 101).sum]
    rw [Finset.sum_const]
    simp
  rw [eq]
  -- Now we want to calculate $(2^{101} - 1) \bmod 7$.
  change _ ≡ 3 [MOD 7]
  -- We use the fact that $2^3 \equiv 1 \pmod{7}$.
  refine Nat.modEq_of_modEq?_?_
  change 2 ^ 3 ≡ 1 [MOD 7]
  exact rfl
  -- So $2^{101} \equiv 2^{2} \equiv 4 \pmod{7}$.
  change 2 ^ 101 ≡ 2 ^ 2 [MOD 7]
  -- This is because $101 \equiv 2 \pmod{3}$.
  rw [Nat.modEq_iff_dvd]
  rw [Nat.mod_eq_of_lt (Nat.succ_pos _)]
  change 2 ^ (101 % 3) ≡ 2 ^ 2 [MOD 7]
  simp
  exact rfl

```